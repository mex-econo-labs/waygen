import{j as ne,u as we,c as ip}from"./index-D_eadTmA.js";import{j as ap,P as sp,k as up,H as cp,l as lp,T as fp,r as re,m as pp,M as dp,n as hp}from"./vendor-BeRQyJBT.js";import{b as yp,i as Ei,d as Qu,g as wi,m as Pr,M as gp,e as va}from"./mapbox-C3udIXGP.js";import{n as W,s as ht,o as Xr,q as Ct,r as Qe,u as j,_ as Ot,v as Ft,w as Ai,x as ee,y as yt,z as Pt,A as ec,B as We,C as vp,D as tc,E as mp,F as rc,G as bp,H as nc,I as or,J as oc,K as ic,L as Tp,M as ac,N as Sp,O as _p,P as Ep,e as Cn,b as On,p as lt,Q as ma,m as ba,c as Ta,f as wp}from"./turf-DdeSyY1S.js";import{c as Ap}from"./utils-P9aiU5u9.js";/* empty css                           */var Ii={exports:{}};const Ip=function(e,t){const r={drag:[],click:[],mousemove:[],mousedown:[],mouseup:[],mouseout:[],keydown:[],keyup:[],touchstart:[],touchmove:[],touchend:[],tap:[]},n={on:function(i,a,c){if(r[i]===void 0)throw new Error(`Invalid event type: ${i}`);r[i].push({selector:a,fn:c})},render:function(i){t.store.featureChanged(i)}},o=function(i,a){const c=r[i];let u=c.length;for(;u--;){const y=c[u];if(y.selector(a)){y.fn.call(n,a),t.store.render(),t.ui.updateMapClasses();break}}};return e.start.call(n),{render:e.render,stop:function(){e.stop&&e.stop()},trash:function(){e.trash&&(e.trash(),t.store.render())},combineFeatures:function(){e.combineFeatures&&e.combineFeatures()},uncombineFeatures:function(){e.uncombineFeatures&&e.uncombineFeatures()},drag:function(i){o("drag",i)},click:function(i){o("click",i)},mousemove:function(i){o("mousemove",i)},mousedown:function(i){o("mousedown",i)},mouseup:function(i){o("mouseup",i)},mouseout:function(i){o("mouseout",i)},keydown:function(i){o("keydown",i)},keyup:function(i){o("keyup",i)},touchstart:function(i){o("touchstart",i)},touchmove:function(i){o("touchmove",i)},touchend:function(i){o("touchend",i)},tap:function(i){o("tap",i)}}};var $p=Ip,V={classes:{CONTROL_BASE:"mapboxgl-ctrl",CONTROL_BUTTON:"mapbox-gl-draw_ctrl-draw-btn",CONTROL_BUTTON_LINE:"mapbox-gl-draw_line",CONTROL_BUTTON_POLYGON:"mapbox-gl-draw_polygon",CONTROL_BUTTON_POINT:"mapbox-gl-draw_point",CONTROL_BUTTON_TRASH:"mapbox-gl-draw_trash",CONTROL_BUTTON_COMBINE_FEATURES:"mapbox-gl-draw_combine",CONTROL_BUTTON_UNCOMBINE_FEATURES:"mapbox-gl-draw_uncombine",CONTROL_GROUP:"mapboxgl-ctrl-group",ACTIVE_BUTTON:"active",BOX_SELECT:"mapbox-gl-draw_boxselect"},sources:{HOT:"mapbox-gl-draw-hot",COLD:"mapbox-gl-draw-cold"},cursors:{ADD:"add",MOVE:"move",DRAG:"drag",POINTER:"pointer",NONE:"none"},types:{POLYGON:"polygon",LINE:"line_string",POINT:"point"},geojsonTypes:{FEATURE:"Feature",POLYGON:"Polygon",LINE_STRING:"LineString",POINT:"Point",FEATURE_COLLECTION:"FeatureCollection",MULTI_PREFIX:"Multi",MULTI_POINT:"MultiPoint",MULTI_LINE_STRING:"MultiLineString",MULTI_POLYGON:"MultiPolygon"},modes:{DRAW_LINE_STRING:"draw_line_string",DRAW_POLYGON:"draw_polygon",DRAW_POINT:"draw_point",SIMPLE_SELECT:"simple_select",DIRECT_SELECT:"direct_select",STATIC:"static"},events:{CREATE:"draw.create",DELETE:"draw.delete",UPDATE:"draw.update",SELECTION_CHANGE:"draw.selectionchange",MODE_CHANGE:"draw.modechange",ACTIONABLE:"draw.actionable",RENDER:"draw.render",COMBINE_FEATURES:"draw.combine",UNCOMBINE_FEATURES:"draw.uncombine"},updateActions:{MOVE:"move",CHANGE_COORDINATES:"change_coordinates"},meta:{FEATURE:"feature",MIDPOINT:"midpoint",VERTEX:"vertex"},activeStates:{ACTIVE:"true",INACTIVE:"false"},interactions:["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate"],LAT_MIN:-90,LAT_RENDERED_MIN:-85,LAT_MAX:90,LAT_RENDERED_MAX:85,LNG_MIN:-270,LNG_MAX:270};const Cp=yp,ri=V,Sa={Point:0,LineString:1,Polygon:2};function Op(e,t){const r=Sa[e.geometry.type]-Sa[t.geometry.type];return r===0&&e.geometry.type===ri.geojsonTypes.POLYGON?e.area-t.area:r}function Fp(e){return e.map(t=>(t.geometry.type===ri.geojsonTypes.POLYGON&&(t.area=Cp.geometry({type:ri.geojsonTypes.FEATURE,property:{},geometry:t.geometry})),t)).sort(Op).map(t=>(delete t.area,t))}var Pp=Fp;function Mp(e,t=0){return[[e.point.x-t,e.point.y-t],[e.point.x+t,e.point.y+t]]}var Lp=Mp;function Mt(e){if(this._items={},this._nums={},this._length=e?e.length:0,!!e)for(let t=0,r=e.length;t<r;t++)this.add(e[t]),e[t]!==void 0&&(typeof e[t]=="string"?this._items[e[t]]=t:this._nums[e[t]]=t)}Mt.prototype.add=function(e){return this.has(e)?this:(this._length++,typeof e=="string"?this._items[e]=this._length:this._nums[e]=this._length,this)};Mt.prototype.delete=function(e){return this.has(e)===!1?this:(this._length--,delete this._items[e],delete this._nums[e],this)};Mt.prototype.has=function(e){return typeof e!="string"&&typeof e!="number"?!1:this._items[e]!==void 0||this._nums[e]!==void 0};Mt.prototype.values=function(){const e=[];return Object.keys(this._items).forEach(t=>{e.push({k:t,v:this._items[t]})}),Object.keys(this._nums).forEach(t=>{e.push({k:JSON.parse(t),v:this._nums[t]})}),e.sort((t,r)=>t.v-r.v).map(t=>t.k)};Mt.prototype.clear=function(){return this._length=0,this._items={},this._nums={},this};var Qr=Mt;const xp=Pp,Rp=Lp,Fn=V,Np=Qr,Bp=[Fn.meta.FEATURE,Fn.meta.MIDPOINT,Fn.meta.VERTEX];var en={click:Dp,touch:Up};function Dp(e,t,r){return sc(e,t,r,r.options.clickBuffer)}function Up(e,t,r){return sc(e,t,r,r.options.touchBuffer)}function sc(e,t,r,n){if(r.map===null)return[];const o=e?Rp(e,n):t,i={};r.options.styles&&(i.layers=r.options.styles.map(y=>y.id));const a=r.map.queryRenderedFeatures(o,i).filter(y=>Bp.indexOf(y.properties.meta)!==-1),c=new Np,u=[];return a.forEach(y=>{const h=y.properties.id;c.has(h)||(c.add(h),u.push(y))}),xp(u)}const kp=en,Yt=V;var jp=function(t,r){const n=kp.click(t,null,r),o={mouse:Yt.cursors.NONE};return n[0]&&(o.mouse=n[0].properties.active===Yt.activeStates.ACTIVE?Yt.cursors.MOVE:Yt.cursors.POINTER,o.feature=n[0].properties.meta),r.events.currentModeName().indexOf("draw")!==-1&&(o.mouse=Yt.cursors.ADD),r.ui.queueMapClasses(o),r.ui.updateMapClasses(),n[0]},uc=function(e,t){const r=e.x-t.x,n=e.y-t.y;return Math.sqrt(r*r+n*n)};const qp=uc,Gp=4,Vp=12,Wp=500;var zp=function(t,r,n={}){const o=n.fineTolerance!=null?n.fineTolerance:Gp,i=n.grossTolerance!=null?n.grossTolerance:Vp,a=n.interval!=null?n.interval:Wp;t.point=t.point||r.point,t.time=t.time||r.time;const c=qp(t.point,r.point);return c<o||c<i&&r.time-t.time<a};const Hp=uc,Kp=25,Jp=250;var Yp=function(t,r,n={}){const o=n.tolerance!=null?n.tolerance:Kp,i=n.interval!=null?n.interval:Jp;return t.point=t.point||r.point,t.time=t.time||r.time,Hp(t.point,r.point)<o&&r.time-t.time<i},cc={exports:{}},lc={exports:{}},fc={exports:{}},ni=fc.exports=function(e,t){if(t||(t=16),e===void 0&&(e=128),e<=0)return"0";for(var r=Math.log(Math.pow(2,e))/Math.log(t),n=2;r===1/0;n*=2)r=Math.log(Math.pow(2,e/n))/Math.log(t)*n;for(var o=r-Math.floor(r),i="",n=0;n<Math.floor(r);n++){var a=Math.floor(Math.random()*t).toString(t);i=a+i}if(o){var c=Math.pow(t,o),a=Math.floor(Math.random()*c).toString(t);i=a+i}var u=parseInt(i,t);return u!==1/0&&u>=Math.pow(2,e)?ni(e,t):i};ni.rack=function(e,t,r){var n=function(i){var a=0;do{if(a++>10)if(r)e+=r;else throw new Error("too many ID collisions, use more bits");var c=ni(e,t)}while(Object.hasOwnProperty.call(o,c));return o[c]=i,c},o=n.hats={};return n.get=function(i){return n.hats[i]},n.set=function(i,a){return n.hats[i]=a,n},n.bits=e||128,n.base=t||16,n};var $i=fc.exports;const Zp=$i,Mr=V,et=function(e,t){this.ctx=e,this.properties=t.properties||{},this.coordinates=t.geometry.coordinates,this.id=t.id||Zp(),this.type=t.geometry.type};et.prototype.changed=function(){this.ctx.store.featureChanged(this.id)};et.prototype.incomingCoords=function(e){this.setCoordinates(e)};et.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};et.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.coordinates))};et.prototype.setProperty=function(e,t){this.properties[e]=t};et.prototype.toGeoJSON=function(){return JSON.parse(JSON.stringify({id:this.id,type:Mr.geojsonTypes.FEATURE,properties:this.properties,geometry:{coordinates:this.getCoordinates(),type:this.type}}))};et.prototype.internal=function(e){const t={id:this.id,meta:Mr.meta.FEATURE,"meta:type":this.type,active:Mr.activeStates.INACTIVE,mode:e};if(this.ctx.options.userProperties)for(const r in this.properties)t[`user_${r}`]=this.properties[r];return{type:Mr.geojsonTypes.FEATURE,properties:t,geometry:{coordinates:this.getCoordinates(),type:this.type}}};var tn=et;const pc=tn,ir=function(e,t){pc.call(this,e,t)};ir.prototype=Object.create(pc.prototype);ir.prototype.isValid=function(){return typeof this.coordinates[0]=="number"&&typeof this.coordinates[1]=="number"};ir.prototype.updateCoordinate=function(e,t,r){arguments.length===3?this.coordinates=[t,r]:this.coordinates=[e,t],this.changed()};ir.prototype.getCoordinate=function(){return this.getCoordinates()};var Ci=ir;const dc=tn,gt=function(e,t){dc.call(this,e,t)};gt.prototype=Object.create(dc.prototype);gt.prototype.isValid=function(){return this.coordinates.length>1};gt.prototype.addCoordinate=function(e,t,r){this.changed();const n=parseInt(e,10);this.coordinates.splice(n,0,[t,r])};gt.prototype.getCoordinate=function(e){const t=parseInt(e,10);return JSON.parse(JSON.stringify(this.coordinates[t]))};gt.prototype.removeCoordinate=function(e){this.changed(),this.coordinates.splice(parseInt(e,10),1)};gt.prototype.updateCoordinate=function(e,t,r){const n=parseInt(e,10);this.coordinates[n]=[t,r],this.changed()};var Oi=gt;const hc=tn,De=function(e,t){hc.call(this,e,t),this.coordinates=this.coordinates.map(r=>r.slice(0,-1))};De.prototype=Object.create(hc.prototype);De.prototype.isValid=function(){return this.coordinates.length===0?!1:this.coordinates.every(e=>e.length>2)};De.prototype.incomingCoords=function(e){this.coordinates=e.map(t=>t.slice(0,-1)),this.changed()};De.prototype.setCoordinates=function(e){this.coordinates=e,this.changed()};De.prototype.addCoordinate=function(e,t,r){this.changed();const n=e.split(".").map(i=>parseInt(i,10));this.coordinates[n[0]].splice(n[1],0,[t,r])};De.prototype.removeCoordinate=function(e){this.changed();const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];r&&(r.splice(t[1],1),r.length<3&&this.coordinates.splice(t[0],1))};De.prototype.getCoordinate=function(e){const t=e.split(".").map(n=>parseInt(n,10)),r=this.coordinates[t[0]];return JSON.parse(JSON.stringify(r[t[1]]))};De.prototype.getCoordinates=function(){return this.coordinates.map(e=>e.concat([e[0]]))};De.prototype.updateCoordinate=function(e,t,r){this.changed();const n=e.split("."),o=parseInt(n[0],10),i=parseInt(n[1],10);this.coordinates[o]===void 0&&(this.coordinates[o]=[]),this.coordinates[o][i]=[t,r]};var Fi=De;const yc=tn,gc=V,Xp=$i,Qp={MultiPoint:Ci,MultiLineString:Oi,MultiPolygon:Fi},rn=(e,t,r,n,o)=>{const i=r.split("."),a=parseInt(i[0],10),c=i[1]?i.slice(1).join("."):null;return e[a][t](c,n,o)},Me=function(e,t){if(yc.call(this,e,t),delete this.coordinates,this.model=Qp[t.geometry.type],this.model===void 0)throw new TypeError(`${t.geometry.type} is not a valid type`);this.features=this._coordinatesToFeatures(t.geometry.coordinates)};Me.prototype=Object.create(yc.prototype);Me.prototype._coordinatesToFeatures=function(e){const t=this.model.bind(this);return e.map(r=>new t(this.ctx,{id:Xp(),type:gc.geojsonTypes.FEATURE,properties:{},geometry:{coordinates:r,type:this.type.replace("Multi","")}}))};Me.prototype.isValid=function(){return this.features.every(e=>e.isValid())};Me.prototype.setCoordinates=function(e){this.features=this._coordinatesToFeatures(e),this.changed()};Me.prototype.getCoordinate=function(e){return rn(this.features,"getCoordinate",e)};Me.prototype.getCoordinates=function(){return JSON.parse(JSON.stringify(this.features.map(e=>e.type===gc.geojsonTypes.POLYGON?e.getCoordinates():e.coordinates)))};Me.prototype.updateCoordinate=function(e,t,r){rn(this.features,"updateCoordinate",e,t,r),this.changed()};Me.prototype.addCoordinate=function(e,t,r){rn(this.features,"addCoordinate",e,t,r),this.changed()};Me.prototype.removeCoordinate=function(e){rn(this.features,"removeCoordinate",e),this.changed()};Me.prototype.getFeatures=function(){return this.features};var Lr=Me;const At=V,ed=en,vc=Ci,mc=Oi,bc=Fi,Tc=Lr,ie=lc.exports=function(e){this.map=e.map,this.drawConfig=JSON.parse(JSON.stringify(e.options||{})),this._ctx=e};ie.prototype.setSelected=function(e){return this._ctx.store.setSelected(e)};ie.prototype.setSelectedCoordinates=function(e){this._ctx.store.setSelectedCoordinates(e),e.reduce((t,r)=>(t[r.feature_id]===void 0&&(t[r.feature_id]=!0,this._ctx.store.get(r.feature_id).changed()),t),{})};ie.prototype.getSelected=function(){return this._ctx.store.getSelected()};ie.prototype.getSelectedIds=function(){return this._ctx.store.getSelectedIds()};ie.prototype.isSelected=function(e){return this._ctx.store.isSelected(e)};ie.prototype.getFeature=function(e){return this._ctx.store.get(e)};ie.prototype.select=function(e){return this._ctx.store.select(e)};ie.prototype.deselect=function(e){return this._ctx.store.deselect(e)};ie.prototype.deleteFeature=function(e,t={}){return this._ctx.store.delete(e,t)};ie.prototype.addFeature=function(e){return this._ctx.store.add(e)};ie.prototype.clearSelectedFeatures=function(){return this._ctx.store.clearSelected()};ie.prototype.clearSelectedCoordinates=function(){return this._ctx.store.clearSelectedCoordinates()};ie.prototype.setActionableState=function(e={}){const t={trash:e.trash||!1,combineFeatures:e.combineFeatures||!1,uncombineFeatures:e.uncombineFeatures||!1};return this._ctx.events.actionable(t)};ie.prototype.changeMode=function(e,t={},r={}){return this._ctx.events.changeMode(e,t,r)};ie.prototype.updateUIClasses=function(e){return this._ctx.ui.queueMapClasses(e)};ie.prototype.activateUIButton=function(e){return this._ctx.ui.setActiveButton(e)};ie.prototype.featuresAt=function(e,t,r="click"){if(r!=="click"&&r!=="touch")throw new Error("invalid buffer type");return ed[r](e,t,this._ctx)};ie.prototype.newFeature=function(e){const t=e.geometry.type;return t===At.geojsonTypes.POINT?new vc(this._ctx,e):t===At.geojsonTypes.LINE_STRING?new mc(this._ctx,e):t===At.geojsonTypes.POLYGON?new bc(this._ctx,e):new Tc(this._ctx,e)};ie.prototype.isInstanceOf=function(e,t){if(e===At.geojsonTypes.POINT)return t instanceof vc;if(e===At.geojsonTypes.LINE_STRING)return t instanceof mc;if(e===At.geojsonTypes.POLYGON)return t instanceof bc;if(e==="MultiFeature")return t instanceof Tc;throw new Error(`Unknown feature class: ${e}`)};ie.prototype.doRender=function(e){return this._ctx.store.featureChanged(e)};var td=lc.exports;const le=cc.exports=td;le.prototype.onSetup=function(){};le.prototype.onDrag=function(){};le.prototype.onClick=function(){};le.prototype.onMouseMove=function(){};le.prototype.onMouseDown=function(){};le.prototype.onMouseUp=function(){};le.prototype.onMouseOut=function(){};le.prototype.onKeyUp=function(){};le.prototype.onKeyDown=function(){};le.prototype.onTouchStart=function(){};le.prototype.onTouchMove=function(){};le.prototype.onTouchEnd=function(){};le.prototype.onTap=function(){};le.prototype.onStop=function(){};le.prototype.onTrash=function(){};le.prototype.onCombineFeature=function(){};le.prototype.onUncombineFeature=function(){};le.prototype.toDisplayFeatures=function(){throw new Error("You must overwrite toDisplayFeatures")};var rd=cc.exports;const nd=rd,Sc={drag:"onDrag",click:"onClick",mousemove:"onMouseMove",mousedown:"onMouseDown",mouseup:"onMouseUp",mouseout:"onMouseOut",keyup:"onKeyUp",keydown:"onKeyDown",touchstart:"onTouchStart",touchmove:"onTouchMove",touchend:"onTouchEnd",tap:"onTap"},od=Object.keys(Sc);var id=function(e){const t=Object.keys(e);return function(r,n={}){let o={};const i=t.reduce((c,u)=>(c[u]=e[u],c),new nd(r));function a(c){return function(u){i[c](o,u)}}return{start:function(){o=i.onSetup(n),od.forEach(c=>{const u=Sc[c];let y=()=>!1;e[u]&&(y=()=>!0),this.on(c,y,a(u))})},stop:function(){i.onStop(o)},trash:function(){i.onTrash(o)},combineFeatures:function(){i.onCombineFeatures(o)},uncombineFeatures:function(){i.onUncombineFeatures(o)},render:function(c,u){i.toDisplayFeatures(o,c,u)}}}};const _a=$p,Pn=jp,Ea=en,wa=zp,Aa=Yp,Tt=V,ad=id;var sd=function(e){const t=Object.keys(e.options.modes).reduce((l,f)=>(l[f]=ad(e.options.modes[f]),l),{});let r={},n={};const o={};let i=null,a=null;o.drag=function(l,f){f({point:l.point,time:new Date().getTime()})?(e.ui.queueMapClasses({mouse:Tt.cursors.DRAG}),a.drag(l)):l.originalEvent.stopPropagation()},o.mousedrag=function(l){o.drag(l,f=>!wa(r,f))},o.touchdrag=function(l){o.drag(l,f=>!Aa(n,f))},o.mousemove=function(l){if((l.originalEvent.buttons!==void 0?l.originalEvent.buttons:l.originalEvent.which)===1)return o.mousedrag(l);const _=Pn(l,e);l.featureTarget=_,a.mousemove(l)},o.mousedown=function(l){r={time:new Date().getTime(),point:l.point};const f=Pn(l,e);l.featureTarget=f,a.mousedown(l)},o.mouseup=function(l){const f=Pn(l,e);l.featureTarget=f,wa(r,{point:l.point,time:new Date().getTime()})?a.click(l):a.mouseup(l)},o.mouseout=function(l){a.mouseout(l)},o.touchstart=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;n={time:new Date().getTime(),point:l.point};const f=Ea.touch(l,null,e)[0];l.featureTarget=f,a.touchstart(l)},o.touchmove=function(l){if(l.originalEvent.preventDefault(),!!e.options.touchEnabled)return a.touchmove(l),o.touchdrag(l)},o.touchend=function(l){if(l.originalEvent.preventDefault(),!e.options.touchEnabled)return;const f=Ea.touch(l,null,e)[0];l.featureTarget=f,Aa(n,{time:new Date().getTime(),point:l.point})?a.tap(l):a.touchend(l)};const c=l=>!(l===8||l===46||l>=48&&l<=57);o.keydown=function(l){(l.srcElement||l.target).classList[0]==="mapboxgl-canvas"&&((l.keyCode===8||l.keyCode===46)&&e.options.controls.trash?(l.preventDefault(),a.trash()):c(l.keyCode)?a.keydown(l):l.keyCode===49&&e.options.controls.point?u(Tt.modes.DRAW_POINT):l.keyCode===50&&e.options.controls.line_string?u(Tt.modes.DRAW_LINE_STRING):l.keyCode===51&&e.options.controls.polygon&&u(Tt.modes.DRAW_POLYGON))},o.keyup=function(l){c(l.keyCode)&&a.keyup(l)},o.zoomend=function(){e.store.changeZoom()},o.data=function(l){if(l.dataType==="style"){const{setup:f,map:_,options:E,store:A}=e;E.styles.some(F=>_.getLayer(F.id))||(f.addLayers(),A.setDirty(),A.render())}};function u(l,f,_={}){a.stop();const E=t[l];if(E===void 0)throw new Error(`${l} is not valid`);i=l;const A=E(e,f);a=_a(A,e),_.silent||e.map.fire(Tt.events.MODE_CHANGE,{mode:l}),e.store.setDirty(),e.store.render()}const y={trash:!1,combineFeatures:!1,uncombineFeatures:!1};function h(l){let f=!1;Object.keys(l).forEach(_=>{if(y[_]===void 0)throw new Error("Invalid action type");y[_]!==l[_]&&(f=!0),y[_]=l[_]}),f&&e.map.fire(Tt.events.ACTIONABLE,{actions:y})}return{start:function(){i=e.options.defaultMode,a=_a(t[i](e),e)},changeMode:u,actionable:h,currentModeName:function(){return i},currentModeRender:function(l,f){return a.render(l,f)},fire:function(l,f){o[l]&&o[l](f)},addEventListeners:function(){e.map.on("mousemove",o.mousemove),e.map.on("mousedown",o.mousedown),e.map.on("mouseup",o.mouseup),e.map.on("data",o.data),e.map.on("touchmove",o.touchmove),e.map.on("touchstart",o.touchstart),e.map.on("touchend",o.touchend),e.container.addEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.addEventListener("keydown",o.keydown),e.container.addEventListener("keyup",o.keyup))},removeEventListeners:function(){e.map.off("mousemove",o.mousemove),e.map.off("mousedown",o.mousedown),e.map.off("mouseup",o.mouseup),e.map.off("data",o.data),e.map.off("touchmove",o.touchmove),e.map.off("touchstart",o.touchstart),e.map.off("touchend",o.touchend),e.container.removeEventListener("mouseout",o.mouseout),e.options.keybindings&&(e.container.removeEventListener("keydown",o.keydown),e.container.removeEventListener("keyup",o.keyup))},trash:function(l){a.trash(l)},combineFeatures:function(){a.combineFeatures()},uncombineFeatures:function(){a.uncombineFeatures()},getMode:function(){return i}}},_c={exports:{}};function ud(e,t,r){let n,o;function i(){n=!1,o&&(a.apply(r,o),o=!1)}function a(){n?o=arguments:(n=!0,e.apply(r,arguments),setTimeout(i,t))}return a}var cd=ud;function ld(e){return[].concat(e).filter(t=>t!==void 0)}var fd=ld;const xe=V;var pd=function(){const t=this;if(!(t.ctx.map&&t.ctx.map.getSource(xe.sources.HOT)!==void 0))return y();const n=t.ctx.events.currentModeName();t.ctx.ui.queueMapClasses({mode:n});let o=[],i=[];t.isDirty?i=t.getAllIds():(o=t.getChangedIds().filter(h=>t.get(h)!==void 0),i=t.sources.hot.filter(h=>h.properties.id&&o.indexOf(h.properties.id)===-1&&t.get(h.properties.id)!==void 0).map(h=>h.properties.id)),t.sources.hot=[];const a=t.sources.cold.length;t.sources.cold=t.isDirty?[]:t.sources.cold.filter(h=>{const T=h.properties.id||h.properties.parent;return o.indexOf(T)===-1});const c=a!==t.sources.cold.length||i.length>0;o.forEach(h=>u(h,"hot")),i.forEach(h=>u(h,"cold"));function u(h,T){const f=t.get(h).internal(n);t.ctx.events.currentModeRender(f,_=>{t.sources[T].push(_)})}if(c&&t.ctx.map.getSource(xe.sources.COLD).setData({type:xe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.cold}),t.ctx.map.getSource(xe.sources.HOT).setData({type:xe.geojsonTypes.FEATURE_COLLECTION,features:t.sources.hot}),t._emitSelectionChange&&(t.ctx.map.fire(xe.events.SELECTION_CHANGE,{features:t.getSelected().map(h=>h.toGeoJSON()),points:t.getSelectedCoordinates().map(h=>({type:xe.geojsonTypes.FEATURE,properties:{},geometry:{type:xe.geojsonTypes.POINT,coordinates:h.coordinates}}))}),t._emitSelectionChange=!1),t._deletedFeaturesToEmit.length){const h=t._deletedFeaturesToEmit.map(T=>T.toGeoJSON());t._deletedFeaturesToEmit=[],t.ctx.map.fire(xe.events.DELETE,{features:h})}y(),t.ctx.map.fire(xe.events.RENDER,{});function y(){t.isDirty=!1,t.clearChangedIds()}};const dd=cd,nn=fd,Mn=Qr,hd=pd,yd=V.interactions,Z=_c.exports=function(e){this._features={},this._featureIds=new Mn,this._selectedFeatureIds=new Mn,this._selectedCoordinates=[],this._changedFeatureIds=new Mn,this._deletedFeaturesToEmit=[],this._emitSelectionChange=!1,this._mapInitialConfig={},this.ctx=e,this.sources={hot:[],cold:[]},this.render=dd(hd,16,this),this.isDirty=!1};Z.prototype.createRenderBatch=function(){const e=this.render;let t=0;return this.render=function(){t++},()=>{this.render=e,t>0&&this.render()}};Z.prototype.setDirty=function(){return this.isDirty=!0,this};Z.prototype.featureChanged=function(e){return this._changedFeatureIds.add(e),this};Z.prototype.getChangedIds=function(){return this._changedFeatureIds.values()};Z.prototype.clearChangedIds=function(){return this._changedFeatureIds.clear(),this};Z.prototype.getAllIds=function(){return this._featureIds.values()};Z.prototype.add=function(e){return this.featureChanged(e.id),this._features[e.id]=e,this._featureIds.add(e.id),this};Z.prototype.delete=function(e,t={}){return nn(e).forEach(r=>{this._featureIds.has(r)&&(this._featureIds.delete(r),this._selectedFeatureIds.delete(r),t.silent||this._deletedFeaturesToEmit.indexOf(this._features[r])===-1&&this._deletedFeaturesToEmit.push(this._features[r]),delete this._features[r],this.isDirty=!0)}),Ec.call(this,t),this};Z.prototype.get=function(e){return this._features[e]};Z.prototype.getAll=function(){return Object.keys(this._features).map(e=>this._features[e])};Z.prototype.select=function(e,t={}){return nn(e).forEach(r=>{this._selectedFeatureIds.has(r)||(this._selectedFeatureIds.add(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),this};Z.prototype.deselect=function(e,t={}){return nn(e).forEach(r=>{this._selectedFeatureIds.has(r)&&(this._selectedFeatureIds.delete(r),this._changedFeatureIds.add(r),t.silent||(this._emitSelectionChange=!0))}),Ec.call(this,t),this};Z.prototype.clearSelected=function(e={}){return this.deselect(this._selectedFeatureIds.values(),{silent:e.silent}),this};Z.prototype.setSelected=function(e,t={}){return e=nn(e),this.deselect(this._selectedFeatureIds.values().filter(r=>e.indexOf(r)===-1),{silent:t.silent}),this.select(e.filter(r=>!this._selectedFeatureIds.has(r)),{silent:t.silent}),this};Z.prototype.setSelectedCoordinates=function(e){return this._selectedCoordinates=e,this._emitSelectionChange=!0,this};Z.prototype.clearSelectedCoordinates=function(){return this._selectedCoordinates=[],this._emitSelectionChange=!0,this};Z.prototype.getSelectedIds=function(){return this._selectedFeatureIds.values()};Z.prototype.getSelected=function(){return this._selectedFeatureIds.values().map(e=>this.get(e))};Z.prototype.getSelectedCoordinates=function(){return this._selectedCoordinates.map(t=>({coordinates:this.get(t.feature_id).getCoordinate(t.coord_path)}))};Z.prototype.isSelected=function(e){return this._selectedFeatureIds.has(e)};Z.prototype.setFeatureProperty=function(e,t,r){this.get(e).setProperty(t,r),this.featureChanged(e)};function Ec(e){const t=this._selectedCoordinates.filter(r=>this._selectedFeatureIds.has(r.feature_id));this._selectedCoordinates.length!==t.length&&!e.silent&&(this._emitSelectionChange=!0),this._selectedCoordinates=t}Z.prototype.storeMapConfig=function(){yd.forEach(e=>{this.ctx.map[e]&&(this._mapInitialConfig[e]=this.ctx.map[e].isEnabled())})};Z.prototype.restoreMapConfig=function(){Object.keys(this._mapInitialConfig).forEach(e=>{this._mapInitialConfig[e]?this.ctx.map[e].enable():this.ctx.map[e].disable()})};Z.prototype.getInitialConfigValue=function(e){return this._mapInitialConfig[e]!==void 0?this._mapInitialConfig[e]:!0};var gd=_c.exports;const Ia=Ei,Q=V,vd=["mode","feature","mouse"];var md=function(e){const t={};let r=null,n={mode:null,feature:null,mouse:null},o={mode:null,feature:null,mouse:null};function i(){a({mode:null,feature:null,mouse:null}),c()}function a(f){o=Ia(o,f)}function c(){if(!e.container)return;const f=[],_=[];vd.forEach(E=>{o[E]!==n[E]&&(f.push(`${E}-${n[E]}`),o[E]!==null&&_.push(`${E}-${o[E]}`))}),f.length>0&&e.container.classList.remove.apply(e.container.classList,f),_.length>0&&e.container.classList.add.apply(e.container.classList,_),n=Ia(n,o)}function u(f,_={}){const E=document.createElement("button");return E.className=`${Q.classes.CONTROL_BUTTON} ${_.className}`,E.setAttribute("title",_.title),_.container.appendChild(E),E.addEventListener("click",A=>{if(A.preventDefault(),A.stopPropagation(),A.target===r){y();return}h(f),_.onActivate()},!0),E}function y(){r&&(r.classList.remove(Q.classes.ACTIVE_BUTTON),r=null)}function h(f){y();const _=t[f];_&&_&&f!=="trash"&&(_.classList.add(Q.classes.ACTIVE_BUTTON),r=_)}function T(){const f=e.options.controls,_=document.createElement("div");return _.className=`${Q.classes.CONTROL_GROUP} ${Q.classes.CONTROL_BASE}`,f&&(f[Q.types.LINE]&&(t[Q.types.LINE]=u(Q.types.LINE,{container:_,className:Q.classes.CONTROL_BUTTON_LINE,title:`LineString tool ${e.options.keybindings?"(l)":""}`,onActivate:()=>e.events.changeMode(Q.modes.DRAW_LINE_STRING)})),f[Q.types.POLYGON]&&(t[Q.types.POLYGON]=u(Q.types.POLYGON,{container:_,className:Q.classes.CONTROL_BUTTON_POLYGON,title:`Polygon tool ${e.options.keybindings?"(p)":""}`,onActivate:()=>e.events.changeMode(Q.modes.DRAW_POLYGON)})),f[Q.types.POINT]&&(t[Q.types.POINT]=u(Q.types.POINT,{container:_,className:Q.classes.CONTROL_BUTTON_POINT,title:`Marker tool ${e.options.keybindings?"(m)":""}`,onActivate:()=>e.events.changeMode(Q.modes.DRAW_POINT)})),f.trash&&(t.trash=u("trash",{container:_,className:Q.classes.CONTROL_BUTTON_TRASH,title:"Delete",onActivate:()=>{e.events.trash()}})),f.combine_features&&(t.combine_features=u("combineFeatures",{container:_,className:Q.classes.CONTROL_BUTTON_COMBINE_FEATURES,title:"Combine",onActivate:()=>{e.events.combineFeatures()}})),f.uncombine_features&&(t.uncombine_features=u("uncombineFeatures",{container:_,className:Q.classes.CONTROL_BUTTON_UNCOMBINE_FEATURES,title:"Uncombine",onActivate:()=>{e.events.uncombineFeatures()}}))),_}function l(){Object.keys(t).forEach(f=>{const _=t[f];_.parentNode&&_.parentNode.removeChild(_),delete t[f]})}return{setActiveButton:h,queueMapClasses:a,updateMapClasses:c,clearMapClasses:i,addButtons:T,removeButtons:l}};const bd=sd,Td=gd,Sd=md,Ye=V,_d=Ei;var Ed=function(e){let t=null,r=null;const n={onRemove:function(){return e.map.off("load",n.connect),clearInterval(r),n.removeLayers(),e.store.restoreMapConfig(),e.ui.removeButtons(),e.events.removeEventListeners(),e.ui.clearMapClasses(),e.map=null,e.container=null,e.store=null,t&&t.parentNode&&t.parentNode.removeChild(t),t=null,this},connect:function(){e.map.off("load",n.connect),clearInterval(r),n.addLayers(),e.store.storeMapConfig(),e.events.addEventListeners()},onAdd:function(o){{const i=o.fire;o.fire=function(a,c){let u=arguments;return i.length===1&&arguments.length!==1&&(u=[_d({},{type:a},c)]),i.apply(o,u)}}return e.map=o,e.events=bd(e),e.ui=Sd(e),e.container=o.getContainer(),e.store=new Td(e),t=e.ui.addButtons(),e.options.boxSelect&&(o.boxZoom.disable(),o.dragPan.disable(),o.dragPan.enable()),o.loaded()?n.connect():(o.on("load",n.connect),r=setInterval(()=>{o.loaded()&&n.connect()},16)),e.events.start(),t},addLayers:function(){e.map.addSource(Ye.sources.COLD,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.map.addSource(Ye.sources.HOT,{data:{type:Ye.geojsonTypes.FEATURE_COLLECTION,features:[]},type:"geojson"}),e.options.styles.forEach(o=>{e.map.addLayer(o)}),e.store.setDirty(!0),e.store.render()},removeLayers:function(){e.options.styles.forEach(o=>{e.map.getLayer(o.id)&&e.map.removeLayer(o.id)}),e.map.getSource(Ye.sources.COLD)&&e.map.removeSource(Ye.sources.COLD),e.map.getSource(Ye.sources.HOT)&&e.map.removeSource(Ye.sources.HOT)}};return e.setup=n,n},wd=[{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3bb2d0","fill-outline-color":"#3bb2d0","fill-opacity":.1}},{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#fbb03b","fill-outline-color":"#fbb03b","fill-opacity":.1}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","midpoint"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-line-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3bb2d0","line-width":2}},{id:"gl-draw-line-active",type:"line",filter:["all",["==","$type","LineString"],["==","active","true"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#fbb03b","line-dasharray":[.2,2],"line-width":2}},{id:"gl-draw-polygon-and-line-vertex-stroke-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-color":"#fff"}},{id:"gl-draw-polygon-and-line-vertex-inactive",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#fbb03b"}},{id:"gl-draw-point-point-stroke-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":5,"circle-opacity":1,"circle-color":"#fff"}},{id:"gl-draw-point-inactive",type:"circle",filter:["all",["==","active","false"],["==","$type","Point"],["==","meta","feature"],["!=","mode","static"]],paint:{"circle-radius":3,"circle-color":"#3bb2d0"}},{id:"gl-draw-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["==","active","true"],["!=","meta","midpoint"]],paint:{"circle-radius":7,"circle-color":"#fff"}},{id:"gl-draw-point-active",type:"circle",filter:["all",["==","$type","Point"],["!=","meta","midpoint"],["==","active","true"]],paint:{"circle-radius":5,"circle-color":"#fbb03b"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","mode","static"],["==","$type","Polygon"]],paint:{"fill-color":"#404040","fill-outline-color":"#404040","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","mode","static"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-line-static",type:"line",filter:["all",["==","mode","static"],["==","$type","LineString"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#404040","line-width":2}},{id:"gl-draw-point-static",type:"circle",filter:["all",["==","mode","static"],["==","$type","Point"]],paint:{"circle-radius":5,"circle-color":"#404040"}}];const St=V;var Lt={isOfMetaType:function(e){return function(t){const r=t.featureTarget;return!r||!r.properties?!1:r.properties.meta===e}},isShiftMousedown:function(e){return!e.originalEvent||!e.originalEvent.shiftKey?!1:e.originalEvent.button===0},isActiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===St.activeStates.ACTIVE&&e.featureTarget.properties.meta===St.meta.FEATURE},isInactiveFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.active===St.activeStates.INACTIVE&&e.featureTarget.properties.meta===St.meta.FEATURE},noTarget:function(e){return e.featureTarget===void 0},isFeature:function(e){return!e.featureTarget||!e.featureTarget.properties?!1:e.featureTarget.properties.meta===St.meta.FEATURE},isVertex:function(e){const t=e.featureTarget;return!t||!t.properties?!1:t.properties.meta===St.meta.VERTEX},isShiftDown:function(e){return e.originalEvent?e.originalEvent.shiftKey===!0:!1},isEscapeKey:function(e){return e.keyCode===27},isEnterKey:function(e){return e.keyCode===13},true:function(){return!0}},Ad=It;function It(e,t){this.x=e,this.y=t}It.prototype={clone:function(){return new It(this.x,this.y)},add:function(e){return this.clone()._add(e)},sub:function(e){return this.clone()._sub(e)},multByPoint:function(e){return this.clone()._multByPoint(e)},divByPoint:function(e){return this.clone()._divByPoint(e)},mult:function(e){return this.clone()._mult(e)},div:function(e){return this.clone()._div(e)},rotate:function(e){return this.clone()._rotate(e)},rotateAround:function(e,t){return this.clone()._rotateAround(e,t)},matMult:function(e){return this.clone()._matMult(e)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(e){return this.x===e.x&&this.y===e.y},dist:function(e){return Math.sqrt(this.distSqr(e))},distSqr:function(e){var t=e.x-this.x,r=e.y-this.y;return t*t+r*r},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(e){return Math.atan2(this.y-e.y,this.x-e.x)},angleWith:function(e){return this.angleWithSep(e.x,e.y)},angleWithSep:function(e,t){return Math.atan2(this.x*t-this.y*e,this.x*e+this.y*t)},_matMult:function(e){var t=e[0]*this.x+e[1]*this.y,r=e[2]*this.x+e[3]*this.y;return this.x=t,this.y=r,this},_add:function(e){return this.x+=e.x,this.y+=e.y,this},_sub:function(e){return this.x-=e.x,this.y-=e.y,this},_mult:function(e){return this.x*=e,this.y*=e,this},_div:function(e){return this.x/=e,this.y/=e,this},_multByPoint:function(e){return this.x*=e.x,this.y*=e.y,this},_divByPoint:function(e){return this.x/=e.x,this.y/=e.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var e=this.y;return this.y=this.x,this.x=-e,this},_rotate:function(e){var t=Math.cos(e),r=Math.sin(e),n=t*this.x-r*this.y,o=r*this.x+t*this.y;return this.x=n,this.y=o,this},_rotateAround:function(e,t){var r=Math.cos(e),n=Math.sin(e),o=t.x+r*(this.x-t.x)-n*(this.y-t.y),i=t.y+n*(this.x-t.x)+r*(this.y-t.y);return this.x=o,this.y=i,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}};It.convert=function(e){return e instanceof It?e:Array.isArray(e)?new It(e[0],e[1]):e};const Id=Ad;function $d(e,t){const r=t.getBoundingClientRect();return new Id(e.clientX-r.left-(t.clientLeft||0),e.clientY-r.top-(t.clientTop||0))}var Cd=$d;const Zt=V;var on=function(e,t,r,n){return{type:Zt.geojsonTypes.FEATURE,properties:{meta:Zt.meta.VERTEX,parent:e,coord_path:r,active:n?Zt.activeStates.ACTIVE:Zt.activeStates.INACTIVE},geometry:{type:Zt.geojsonTypes.POINT,coordinates:t}}};const ft=V;var Od=function(e,t,r,n){const o=t.geometry.coordinates,i=r.geometry.coordinates;if(o[1]>ft.LAT_RENDERED_MAX||o[1]<ft.LAT_RENDERED_MIN||i[1]>ft.LAT_RENDERED_MAX||i[1]<ft.LAT_RENDERED_MIN)return null;const a=n.project([o[0],o[1]]),c=n.project([i[0],i[1]]),u=n.unproject([(a.x+c.x)/2,(a.y+c.y)/2]);return{type:ft.geojsonTypes.FEATURE,properties:{meta:ft.meta.MIDPOINT,parent:e,lng:u.lng,lat:u.lat,coord_path:r.properties.coord_path},geometry:{type:ft.geojsonTypes.POINT,coordinates:[u.lng,u.lat]}}};const $a=on,Fd=Od,_t=V;function wc(e,t={},r=null){const{type:n,coordinates:o}=e.geometry,i=e.properties&&e.properties.id;let a=[];n===_t.geojsonTypes.POINT?a.push($a(i,o,r,u(r))):n===_t.geojsonTypes.POLYGON?o.forEach((h,T)=>{c(h,r!==null?`${r}.${T}`:String(T))}):n===_t.geojsonTypes.LINE_STRING?c(o,r):n.indexOf(_t.geojsonTypes.MULTI_PREFIX)===0&&y();function c(h,T){let l="",f=null;h.forEach((_,E)=>{const A=T!=null?`${T}.${E}`:String(E),N=$a(i,_,A,u(A));if(t.midpoints&&f){const b=Fd(i,f,N,t.map);b&&a.push(b)}f=N;const F=JSON.stringify(_);l!==F&&a.push(N),E===0&&(l=F)})}function u(h){return t.selectedPaths?t.selectedPaths.indexOf(h)!==-1:!1}function y(){const h=n.replace(_t.geojsonTypes.MULTI_PREFIX,"");o.forEach((T,l)=>{const f={type:_t.geojsonTypes.FEATURE,properties:e.properties,geometry:{type:h,coordinates:T}};a=a.concat(wc(f,t,l))})}return a}var an=wc,xt={enable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("doubleClickZoom")&&e.map.doubleClickZoom.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.doubleClickZoom.disable()},0)}},sn={exports:{}},Pd=function e(t){switch(t&&t.type||null){case"FeatureCollection":return t.features=t.features.reduce(function(r,n){return r.concat(e(n))},[]),t;case"Feature":return t.geometry?e(t.geometry).map(function(r){var n={type:"Feature",properties:JSON.parse(JSON.stringify(t.properties)),geometry:r};return t.id!==void 0&&(n.id=t.id),n}):t;case"MultiPoint":return t.coordinates.map(function(r){return{type:"Point",coordinates:r}});case"MultiPolygon":return t.coordinates.map(function(r){return{type:"Polygon",coordinates:r}});case"MultiLineString":return t.coordinates.map(function(r){return{type:"LineString",coordinates:r}});case"GeometryCollection":return t.geometries.map(e).reduce(function(r,n){return r.concat(n)},[]);case"Point":case"Polygon":case"LineString":return[t]}},Md=function(t){return r(t);function r(n){return Array.isArray(n)&&n.length&&typeof n[0]=="number"?[n]:n.reduce(function(o,i){return Array.isArray(i)&&Array.isArray(i[0])?o.concat(r(i)):(o.push(i),o)},[])}},Ld=Qu,xd=Pd,Rd=Md,Nd=function(e){if(!e)return[];var t=xd(Ld(e)),r=[];return t.features.forEach(function(n){n.geometry&&(r=r.concat(Rd(n.geometry.coordinates)))}),r},Ac=Function.prototype.toString,wt=typeof Reflect=="object"&&Reflect!==null&&Reflect.apply,oi,xr;if(typeof wt=="function"&&typeof Object.defineProperty=="function")try{oi=Object.defineProperty({},"length",{get:function(){throw xr}}),xr={},wt(function(){throw 42},null,oi)}catch(e){e!==xr&&(wt=null)}else wt=null;var Bd=/^\s*class\b/,ii=function(t){try{var r=Ac.call(t);return Bd.test(r)}catch{return!1}},Ln=function(t){try{return ii(t)?!1:(Ac.call(t),!0)}catch{return!1}},Rr=Object.prototype.toString,Dd="[object Object]",Ud="[object Function]",kd="[object GeneratorFunction]",jd="[object HTMLAllCollection]",qd="[object HTML document.all class]",Gd="[object HTMLCollection]",Vd=typeof Symbol=="function"&&!!Symbol.toStringTag,Wd=!(0 in[,]),ai=function(){return!1};if(typeof document=="object"){var zd=document.all;Rr.call(zd)===Rr.call(document.all)&&(ai=function(t){if((Wd||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Rr.call(t);return(r===jd||r===qd||r===Gd||r===Dd)&&t("")==null}catch{}return!1})}var un=wt?function(t){if(ai(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;try{wt(t,null,oi)}catch(r){if(r!==xr)return!1}return!ii(t)&&Ln(t)}:function(t){if(ai(t))return!0;if(!t||typeof t!="function"&&typeof t!="object")return!1;if(Vd)return Ln(t);if(ii(t))return!1;var r=Rr.call(t);return r!==Ud&&r!==kd&&!/^\[object HTML/.test(r)?!1:Ln(t)},Hd=un,Kd=Object.prototype.toString,Ic=Object.prototype.hasOwnProperty,Jd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)Ic.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))},Yd=function(t,r,n){for(var o=0,i=t.length;o<i;o++)n==null?r(t.charAt(o),o,t):r.call(n,t.charAt(o),o,t)},Zd=function(t,r,n){for(var o in t)Ic.call(t,o)&&(n==null?r(t[o],o,t):r.call(n,t[o],o,t))};function Xd(e){return Kd.call(e)==="[object Array]"}var Pi=function(t,r,n){if(!Hd(r))throw new TypeError("iterator must be a function");var o;arguments.length>=3&&(o=n),Xd(t)?Jd(t,r,o):typeof t=="string"?Yd(t,r,o):Zd(t,r,o)},$c=["Float16Array","Float32Array","Float64Array","Int8Array","Int16Array","Int32Array","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","BigInt64Array","BigUint64Array"],xn=$c,Qd=typeof globalThis>"u"?window:globalThis,ar=function(){for(var t=[],r=0;r<xn.length;r++)typeof Qd[xn[r]]=="function"&&(t[t.length]=xn[r]);return t},Dr=Pi,eh=ar,Ca=Qe,Mi=W,Nr=Xr,mr=Ct,th=Mi("Object.prototype.toString"),Cc=ht(),Oa=typeof globalThis>"u"?window:globalThis,si=eh(),Li=Mi("String.prototype.slice"),rh=Mi("Array.prototype.indexOf",!0)||function(t,r){for(var n=0;n<t.length;n+=1)if(t[n]===r)return n;return-1},Ur={__proto__:null};Cc&&Nr&&mr?Dr(si,function(e){var t=new Oa[e];if(Symbol.toStringTag in t&&mr){var r=mr(t),n=Nr(r,Symbol.toStringTag);if(!n&&r){var o=mr(r);n=Nr(o,Symbol.toStringTag)}Ur["$"+e]=Ca(n.get)}}):Dr(si,function(e){var t=new Oa[e],r=t.slice||t.set;r&&(Ur["$"+e]=Ca(r))});var nh=function(t){var r=!1;return Dr(Ur,function(n,o){if(!r)try{"$"+n(t)===o&&(r=Li(o,1))}catch{}}),r},oh=function(t){var r=!1;return Dr(Ur,function(n,o){if(!r)try{n(t),r=Li(o,1)}catch{}}),r},Rt=function(t){if(!t||typeof t!="object")return!1;if(!Cc){var r=Li(th(t),8,-1);return rh(si,r)>-1?r:r!=="Object"?!1:oh(t)}return Nr?nh(t):null};const ih={},ah=Object.freeze(Object.defineProperty({__proto__:null,default:ih},Symbol.toStringTag,{value:"Module"})),ui=wi(ah);var xi=typeof Map=="function"&&Map.prototype,Rn=Object.getOwnPropertyDescriptor&&xi?Object.getOwnPropertyDescriptor(Map.prototype,"size"):null,kr=xi&&Rn&&typeof Rn.get=="function"?Rn.get:null,Fa=xi&&Map.prototype.forEach,Ri=typeof Set=="function"&&Set.prototype,Nn=Object.getOwnPropertyDescriptor&&Ri?Object.getOwnPropertyDescriptor(Set.prototype,"size"):null,jr=Ri&&Nn&&typeof Nn.get=="function"?Nn.get:null,Pa=Ri&&Set.prototype.forEach,sh=typeof WeakMap=="function"&&WeakMap.prototype,tr=sh?WeakMap.prototype.has:null,uh=typeof WeakSet=="function"&&WeakSet.prototype,rr=uh?WeakSet.prototype.has:null,ch=typeof WeakRef=="function"&&WeakRef.prototype,Ma=ch?WeakRef.prototype.deref:null,lh=Boolean.prototype.valueOf,fh=Object.prototype.toString,ph=Function.prototype.toString,dh=String.prototype.match,Ni=String.prototype.slice,Xe=String.prototype.replace,hh=String.prototype.toUpperCase,La=String.prototype.toLowerCase,Oc=RegExp.prototype.test,xa=Array.prototype.concat,Re=Array.prototype.join,yh=Array.prototype.slice,Ra=Math.floor,ci=typeof BigInt=="function"?BigInt.prototype.valueOf:null,Bn=Object.getOwnPropertySymbols,li=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Symbol.prototype.toString:null,$t=typeof Symbol=="function"&&typeof Symbol.iterator=="object",nr=typeof Symbol=="function"&&Symbol.toStringTag&&(typeof Symbol.toStringTag===$t||!0)?Symbol.toStringTag:null,Fc=Object.prototype.propertyIsEnumerable,Na=(typeof Reflect=="function"?Reflect.getPrototypeOf:Object.getPrototypeOf)||([].__proto__===Array.prototype?function(e){return e.__proto__}:null);function Ba(e,t){if(e===1/0||e===-1/0||e!==e||e&&e>-1e3&&e<1e3||Oc.call(/e/,t))return t;var r=/[0-9](?=(?:[0-9]{3})+(?![0-9]))/g;if(typeof e=="number"){var n=e<0?-Ra(-e):Ra(e);if(n!==e){var o=String(n),i=Ni.call(t,o.length+1);return Xe.call(o,r,"$&_")+"."+Xe.call(Xe.call(i,/([0-9]{3})/g,"$&_"),/_$/,"")}}return Xe.call(t,r,"$&_")}var fi=ui,Da=fi.custom,Ua=Lc(Da)?Da:null,Pc={__proto__:null,double:'"',single:"'"},gh={__proto__:null,double:/(["\\])/g,single:/(['\\])/g},vh=function e(t,r,n,o){var i=r||{};if(Ve(i,"quoteStyle")&&!Ve(Pc,i.quoteStyle))throw new TypeError('option "quoteStyle" must be "single" or "double"');if(Ve(i,"maxStringLength")&&(typeof i.maxStringLength=="number"?i.maxStringLength<0&&i.maxStringLength!==1/0:i.maxStringLength!==null))throw new TypeError('option "maxStringLength", if provided, must be a positive integer, Infinity, or `null`');var a=Ve(i,"customInspect")?i.customInspect:!0;if(typeof a!="boolean"&&a!=="symbol")throw new TypeError("option \"customInspect\", if provided, must be `true`, `false`, or `'symbol'`");if(Ve(i,"indent")&&i.indent!==null&&i.indent!=="	"&&!(parseInt(i.indent,10)===i.indent&&i.indent>0))throw new TypeError('option "indent" must be "\\t", an integer > 0, or `null`');if(Ve(i,"numericSeparator")&&typeof i.numericSeparator!="boolean")throw new TypeError('option "numericSeparator", if provided, must be `true` or `false`');var c=i.numericSeparator;if(typeof t>"u")return"undefined";if(t===null)return"null";if(typeof t=="boolean")return t?"true":"false";if(typeof t=="string")return Rc(t,i);if(typeof t=="number"){if(t===0)return 1/0/t>0?"0":"-0";var u=String(t);return c?Ba(t,u):u}if(typeof t=="bigint"){var y=String(t)+"n";return c?Ba(t,y):y}var h=typeof i.depth>"u"?5:i.depth;if(typeof n>"u"&&(n=0),n>=h&&h>0&&typeof t=="object")return pi(t)?"[Array]":"[Object]";var T=Rh(i,n);if(typeof o>"u")o=[];else if(xc(o,t)>=0)return"[Circular]";function l(m,P,B){if(P&&(o=yh.call(o),o.push(P)),B){var H={depth:i.depth};return Ve(i,"quoteStyle")&&(H.quoteStyle=i.quoteStyle),e(m,H,n+1,o)}return e(m,i,n+1,o)}if(typeof t=="function"&&!ka(t)){var f=Ih(t),_=br(t,l);return"[Function"+(f?": "+f:" (anonymous)")+"]"+(_.length>0?" { "+Re.call(_,", ")+" }":"")}if(Lc(t)){var E=$t?Xe.call(String(t),/^(Symbol\(.*\))_[^)]*$/,"$1"):li.call(t);return typeof t=="object"&&!$t?Xt(E):E}if(Mh(t)){for(var A="<"+La.call(String(t.nodeName)),N=t.attributes||[],F=0;F<N.length;F++)A+=" "+N[F].name+"="+Mc(mh(N[F].value),"double",i);return A+=">",t.childNodes&&t.childNodes.length&&(A+="..."),A+="</"+La.call(String(t.nodeName))+">",A}if(pi(t)){if(t.length===0)return"[]";var b=br(t,l);return T&&!xh(b)?"["+di(b,T)+"]":"[ "+Re.call(b,", ")+" ]"}if(Th(t)){var w=br(t,l);return!("cause"in Error.prototype)&&"cause"in t&&!Fc.call(t,"cause")?"{ ["+String(t)+"] "+Re.call(xa.call("[cause]: "+l(t.cause),w),", ")+" }":w.length===0?"["+String(t)+"]":"{ ["+String(t)+"] "+Re.call(w,", ")+" }"}if(typeof t=="object"&&a){if(Ua&&typeof t[Ua]=="function"&&fi)return fi(t,{depth:h-n});if(a!=="symbol"&&typeof t.inspect=="function")return t.inspect()}if($h(t)){var $=[];return Fa&&Fa.call(t,function(m,P){$.push(l(P,t,!0)+" => "+l(m,t))}),ja("Map",kr.call(t),$,T)}if(Fh(t)){var L=[];return Pa&&Pa.call(t,function(m){L.push(l(m,t))}),ja("Set",jr.call(t),L,T)}if(Ch(t))return Dn("WeakMap");if(Ph(t))return Dn("WeakSet");if(Oh(t))return Dn("WeakRef");if(_h(t))return Xt(l(Number(t)));if(wh(t))return Xt(l(ci.call(t)));if(Eh(t))return Xt(lh.call(t));if(Sh(t))return Xt(l(String(t)));if(typeof window<"u"&&t===window)return"{ [object Window] }";if(typeof globalThis<"u"&&t===globalThis||typeof window<"u"&&t===window)return"{ [object globalThis] }";if(!bh(t)&&!ka(t)){var C=br(t,l),D=Na?Na(t)===Object.prototype:t instanceof Object||t.constructor===Object,d=t instanceof Object?"":"null prototype",I=!D&&nr&&Object(t)===t&&nr in t?Ni.call(tt(t),8,-1):d?"Object":"",g=D||typeof t.constructor!="function"?"":t.constructor.name?t.constructor.name+" ":"",v=g+(I||d?"["+Re.call(xa.call([],I||[],d||[]),": ")+"] ":"");return C.length===0?v+"{}":T?v+"{"+di(C,T)+"}":v+"{ "+Re.call(C,", ")+" }"}return String(t)};function Mc(e,t,r){var n=r.quoteStyle||t,o=Pc[n];return o+e+o}function mh(e){return Xe.call(String(e),/"/g,"&quot;")}function vt(e){return!nr||!(typeof e=="object"&&(nr in e||typeof e[nr]<"u"))}function pi(e){return tt(e)==="[object Array]"&&vt(e)}function bh(e){return tt(e)==="[object Date]"&&vt(e)}function ka(e){return tt(e)==="[object RegExp]"&&vt(e)}function Th(e){return tt(e)==="[object Error]"&&vt(e)}function Sh(e){return tt(e)==="[object String]"&&vt(e)}function _h(e){return tt(e)==="[object Number]"&&vt(e)}function Eh(e){return tt(e)==="[object Boolean]"&&vt(e)}function Lc(e){if($t)return e&&typeof e=="object"&&e instanceof Symbol;if(typeof e=="symbol")return!0;if(!e||typeof e!="object"||!li)return!1;try{return li.call(e),!0}catch{}return!1}function wh(e){if(!e||typeof e!="object"||!ci)return!1;try{return ci.call(e),!0}catch{}return!1}var Ah=Object.prototype.hasOwnProperty||function(e){return e in this};function Ve(e,t){return Ah.call(e,t)}function tt(e){return fh.call(e)}function Ih(e){if(e.name)return e.name;var t=dh.call(ph.call(e),/^function\s*([\w$]+)/);return t?t[1]:null}function xc(e,t){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}function $h(e){if(!kr||!e||typeof e!="object")return!1;try{kr.call(e);try{jr.call(e)}catch{return!0}return e instanceof Map}catch{}return!1}function Ch(e){if(!tr||!e||typeof e!="object")return!1;try{tr.call(e,tr);try{rr.call(e,rr)}catch{return!0}return e instanceof WeakMap}catch{}return!1}function Oh(e){if(!Ma||!e||typeof e!="object")return!1;try{return Ma.call(e),!0}catch{}return!1}function Fh(e){if(!jr||!e||typeof e!="object")return!1;try{jr.call(e);try{kr.call(e)}catch{return!0}return e instanceof Set}catch{}return!1}function Ph(e){if(!rr||!e||typeof e!="object")return!1;try{rr.call(e,rr);try{tr.call(e,tr)}catch{return!0}return e instanceof WeakSet}catch{}return!1}function Mh(e){return!e||typeof e!="object"?!1:typeof HTMLElement<"u"&&e instanceof HTMLElement?!0:typeof e.nodeName=="string"&&typeof e.getAttribute=="function"}function Rc(e,t){if(e.length>t.maxStringLength){var r=e.length-t.maxStringLength,n="... "+r+" more character"+(r>1?"s":"");return Rc(Ni.call(e,0,t.maxStringLength),t)+n}var o=gh[t.quoteStyle||"single"];o.lastIndex=0;var i=Xe.call(Xe.call(e,o,"\\$1"),/[\x00-\x1f]/g,Lh);return Mc(i,"single",t)}function Lh(e){var t=e.charCodeAt(0),r={8:"b",9:"t",10:"n",12:"f",13:"r"}[t];return r?"\\"+r:"\\x"+(t<16?"0":"")+hh.call(t.toString(16))}function Xt(e){return"Object("+e+")"}function Dn(e){return e+" { ? }"}function ja(e,t,r,n){var o=n?di(r,n):Re.call(r,", ");return e+" ("+t+") {"+o+"}"}function xh(e){for(var t=0;t<e.length;t++)if(xc(e[t],`
`)>=0)return!1;return!0}function Rh(e,t){var r;if(e.indent==="	")r="	";else if(typeof e.indent=="number"&&e.indent>0)r=Re.call(Array(e.indent+1)," ");else return null;return{base:r,prev:Re.call(Array(t+1),r)}}function di(e,t){if(e.length===0)return"";var r=`
`+t.prev+t.base;return r+Re.call(e,","+r)+`
`+t.prev}function br(e,t){var r=pi(e),n=[];if(r){n.length=e.length;for(var o=0;o<e.length;o++)n[o]=Ve(e,o)?t(e[o],e):""}var i=typeof Bn=="function"?Bn(e):[],a;if($t){a={};for(var c=0;c<i.length;c++)a["$"+i[c]]=i[c]}for(var u in e)Ve(e,u)&&(r&&String(Number(u))===u&&u<e.length||$t&&a["$"+u]instanceof Symbol||(Oc.call(/[^\w$]/,u)?n.push(t(u,e)+": "+t(e[u],e)):n.push(u+": "+t(e[u],e))));if(typeof Bn=="function")for(var y=0;y<i.length;y++)Fc.call(e,i[y])&&n.push("["+t(i[y])+"]: "+t(e[i[y]],e));return n}var cn=function(t){return typeof t=="string"||typeof t=="symbol"},rt=function(t){return!!t&&(typeof t=="function"||typeof t=="object")},qa=j,Nh=vh,Bh=cn,Dh=rt,Uh=function(t,r){if(!Dh(t))throw new qa("Assertion failed: Type(O) is not Object");if(!Bh(r))throw new qa("Assertion failed: P is not a Property Key, got "+Nh(r));return t[r]},kh=Ot,ze=function(t){return(typeof t=="number"||typeof t=="bigint")&&!kh(t)&&t!==1/0&&t!==-1/0},jh=Ai,qh=Ft,Gh=Ot,Vh=ze,ln=function(t){if(typeof t!="number"||Gh(t)||!Vh(t))return!1;var r=jh(t);return qh(r)===r},Wh=Qe,Nc=W,zh=ee,hi=zh("%ArrayBuffer%",!0),Br=Nc("ArrayBuffer.prototype.byteLength",!0),Hh=Nc("Object.prototype.toString"),Ga=!!hi&&!Br&&new hi(0).slice,Va=!!Ga&&Wh(Ga),Nt=Br||Va?function(t){if(!t||typeof t!="object")return!1;try{return Br?Br(t):Va(t,0),!0}catch{return!1}}:hi?function(t){return Hh(t)==="[object ArrayBuffer]"}:function(t){return!1},Kh=W,Wa=Kh("ArrayBuffer.prototype.byteLength",!0),Jh=Nt,Bc=function(t){return Jh(t)?Wa?Wa(t):t.byteLength:NaN},Yh=W,za=Yh("SharedArrayBuffer.prototype.byteLength",!0),sr=za?function(t){if(!t||typeof t!="object")return!1;try{return za(t),!0}catch{return!1}}:function(t){return!1},Zh=j,Xh=Bc,Qh=ar(),ey=W,ty=Nt,ry=sr,ny=ey("SharedArrayBuffer.prototype.byteLength",!0),Bt=function(t){var r=ry(t);if(!ty(t)&&!r)throw new Zh("Assertion failed: `arrayBuffer` must be an Object with an [[ArrayBufferData]] internal slot");if((r?ny:Xh)(t)===0)try{new window[Qh[0]](t)}catch(n){return!!n&&n.name==="TypeError"}return!1},Un,Ha;function Dc(){if(Ha)return Un;Ha=1;var e=j,t=yt,r=rt,n=cn;return Un=function(i,a){if(!r(i))throw new e("Assertion failed: `O` must be an Object");if(!n(a))throw new e("Assertion failed: `P` must be a Property Key");return t(i,a)},Un}var oy=ee,Uc=oy("%Array%"),iy=!Uc.isArray&&W("Object.prototype.toString"),kc=Uc.isArray||function(t){return iy(t)==="[object Array]"},Bi=kc,kn,Ka;function jc(){return Ka||(Ka=1,kn=function(t){return t==="BIGUINT64"||t==="BIGINT64"}),kn}var jn,Ja;function ay(){return Ja||(Ja=1,jn=function(t){return t==="UINT8"||t==="UINT8C"||t==="UINT16"||t==="UINT32"||t==="BIGUINT64"}),jn}var qn,Ya;function sy(){if(Ya)return qn;Ya=1;var e=Pt;return qn=function(r){var n=r[3]&128?-1:1,o=(r[3]&127)<<1|r[2]>>7,i=(r[2]&127)<<16|r[1]<<8|r[0];return o===0&&i===0?n===1?0:-0:o===255&&i===0?n===1?1/0:-1/0:o===255&&i!==0?NaN:(o-=127,o===-127?n*i*e(2,-149):n*(1+i*e(2,-23))*e(2,o))},qn}var Gn,Za;function uy(){if(Za)return Gn;Za=1;var e=Pt;return Gn=function(r){var n=r[7]&128?-1:1,o=(r[7]&127)<<4|(r[6]&240)>>4,i=(r[6]&15)*281474976710656+r[5]*1099511627776+r[4]*4294967296+r[3]*16777216+r[2]*65536+r[1]*256+r[0];return o===0&&i===0?n*0:o===2047&&i!==0?NaN:o===2047&&i===0?n*(1/0):(o-=1023,o===-1023?n*i*5e-324:n*(1+i/4503599627370496)*e(2,o))},Gn}var Vn,Xa;function cy(){if(Xa)return Vn;Xa=1;var e=ee,t=Pt,r=e("%Number%"),n=e("%BigInt%",!0);return Vn=function(i,a,c,u){for(var y=u?n:r,h=y(0),T=0;T<i.length;T++)h+=y(i[T]*t(2,8*T));if(!c){var l=a*8;i[a-1]&128&&(h-=y(t(2,l)))}return h},Vn}var Wn,Qa;function ly(){return Qa||(Qa=1,Wn=function(t,r){for(var n=0;n<t.length;n+=1)if(!r(t[n],n,t))return!1;return!0}),Wn}var zn,es;function fy(){return es||(es=1,zn=function(t){return typeof t=="number"&&t>=0&&t<=255&&(t|0)===t}),zn}var Dt={__proto__:null,name:{__proto__:null,$Int8Array:"INT8",$Uint8Array:"UINT8",$Uint8ClampedArray:"UINT8C",$Int16Array:"INT16",$Uint16Array:"UINT16",$Int32Array:"INT32",$Uint32Array:"UINT32",$BigInt64Array:"BIGINT64",$BigUint64Array:"BIGUINT64",$Float32Array:"FLOAT32",$Float64Array:"FLOAT64"},size:{__proto__:null,$INT8:1,$UINT8:1,$UINT8C:1,$INT16:2,$UINT16:2,$INT32:4,$UINT32:4,$BIGINT64:8,$BIGUINT64:8,$FLOAT32:4,$FLOAT64:8},choices:'"INT8", "UINT8", "UINT8C", "INT16", "UINT16", "INT32", "UINT32", "BIGINT64", "BIGUINT64", "FLOAT32", or "FLOAT64"'},Hn,ts;function py(){if(ts)return Hn;ts=1;var e=ee,t=W,r=ec,n=We,o=j,i=e("%BigInt%",!0),a=Dc(),c=Bi,u=jc(),y=ay(),h=sy(),T=uy(),l=cy(),f=ly(),_=fy(),E=t("Array.prototype.reverse"),A=t("Array.prototype.slice"),N=Dt;return Hn=function(b,w,$){if(!a(N.size,"$"+b))throw new o("Assertion failed: `type` must be a TypedArray element type");if(!c(w)||!f(w,_))throw new o("Assertion failed: `rawBytes` must be an Array of bytes");if(typeof $!="boolean")throw new o("Assertion failed: `isLittleEndian` must be a Boolean");var L=N.size["$"+b];if(w.length!==L)throw new r("Assertion failed: `rawBytes` must have a length of "+L+" for type "+b);var C=u(b);if(C&&!i)throw new n("this environment does not support BigInts");return w=A(w,0,L),$||E(w),b==="FLOAT32"?h(w):b==="FLOAT64"?T(w):l(w,L,y(b),C)},Hn}var Kn,rs;function dy(){if(rs)return Kn;rs=1;var e={}.toString;return Kn=Array.isArray||function(t){return e.call(t)=="[object Array]"},Kn}var Jn,ns;function hy(){if(ns)return Jn;ns=1;var e=ee,t=e("%Array.prototype.concat%"),r=Qe,n=W,o=n("Array.prototype.slice"),i=vp(),a=i&&Symbol.isConcatSpreadable,c=[],u=a?r.apply(t,c):null,y=a?dy():null;return Jn=a?function(T){for(var l=0;l<arguments.length;l+=1){var f=arguments[l];if(f&&typeof f=="object"&&typeof f[a]=="boolean"){c[a]||(c[a]=!0);var _=y(f)?o(f):[f];_[a]=!0,arguments[l]=_}}return u(arguments)}:r(t,c),Jn}var yy=Rt,Ut=function(t){return!!yy(t)},gy=j,vy=W,my=vy("TypedArray.prototype.buffer",!0),by=Ut,ur=my||function(t){if(!by(t))throw new gy("Not a Typed Array");return t.buffer},Yn,os;function qc(){if(os)return Yn;os=1;var e=ee,t=e("%Uint8Array%",!0),r=e("%Uint32Array%",!0),n=ur,o=r&&new r([305419896]),i=o&&new t(n(o));return Yn=i?i[0]===120?"little":i[0]===18?"big":i[0]===52?"mixed":"unknown":"indeterminate",Yn}var Ty=ee,Sy=We,qe=j,_y=W,Ey=ln,wy=Ty("%Uint8Array%",!0),Zn=_y("Array.prototype.slice"),Ay=Bt,Iy=py(),$y=Nt,Cy=sr,is=hy(),Tr=Dt,Oy=qc(),Fy=function(t,r,n,o,i){var a=Cy(t);if(!$y(t)&&!a)throw new qe("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!Ey(r))throw new qe("Assertion failed: `byteIndex` must be an integer");if(typeof n!="string"||typeof Tr.size["$"+n]!="number")throw new qe("Assertion failed: `type` must be one of "+Tr.choices);if(typeof o!="boolean")throw new qe("Assertion failed: `isTypedArray` must be a boolean");if(i!=="SEQ-CST"&&i!=="UNORDERED")throw new qe("Assertion failed: `order` must be either `SEQ-CST` or `UNORDERED`");if(arguments.length>5&&typeof arguments[5]!="boolean")throw new qe("Assertion failed: `isLittleEndian` must be a boolean, if present");if(Ay(t))throw new qe("Assertion failed: `arrayBuffer` is detached");if(r<0)throw new qe("Assertion failed: `byteIndex` must be non-negative");var c=Tr.size["$"+n];if(!c)throw new qe("Assertion failed: `type` must be one of "+Tr.choices);var u;if(a)throw new Sy("SharedArrayBuffer is not supported by this implementation");u=Zn(new wy(t,r),0,c);var y=arguments.length>5?arguments[5]:Oy==="little",h=y?Zn(is([0,0,0,0,0,0,0,0],u),-c):Zn(is(u,[0,0,0,0,0,0,0,0]),0,c);return Iy(n,h,y)},as=Ot,Gc=function(t,r){return t===r?t===0?1/t===1/r:!0:as(t)&&as(r)},Sr=j,Py=rt,My=cn,ss=Gc,us=function(){try{return delete[].length,!0}catch{return!1}}(),Ly=function(t,r,n,o){if(!Py(t))throw new Sr("Assertion failed: `O` must be an Object");if(!My(r))throw new Sr("Assertion failed: `P` must be a Property Key");if(typeof o!="boolean")throw new Sr("Assertion failed: `Throw` must be a Boolean");if(o){if(t[r]=n,us&&!ss(t[r],n))throw new Sr("Attempted to assign to readonly property.");return!0}try{return t[r]=n,us?ss(t[r],n):!0}catch{return!1}},Xn,cs;function xy(){if(cs)return Xn;cs=1;var e=ee,t=e("%BigInt%",!0),r=j,n=We;return Xn=function(i){if(typeof i!="string")throw new r("`argument` must be a string");if(!t)throw new n("BigInts are not supported in this environment");try{return t(i)}catch{return}},Xn}var Qn,ls;function Ry(){return ls||(ls=1,Qn=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),Qn}var _r={exports:{}},eo,fs;function fn(){if(fs)return eo;fs=1;var e=W,t=tc,r=e("RegExp.prototype.exec"),n=j;return eo=function(i){if(!t(i))throw new n("`regex` must be a RegExp");return function(c){return r(i,c)!==null}},eo}var ps;function Vc(){if(ps)return _r.exports;ps=1;var e=W,t=e("Object.prototype.toString"),r=mp()(),n=fn();if(r){var o=e("Symbol.prototype.toString"),i=n(/^Symbol\(.*\)$/),a=function(u){return typeof u.valueOf()!="symbol"?!1:i(o(u))};_r.exports=function(u){if(typeof u=="symbol")return!0;if(!u||typeof u!="object"||t(u)!=="[object Symbol]")return!1;try{return a(u)}catch{return!1}}}else _r.exports=function(u){return!1};return _r.exports}var to,ds;function Ny(){if(ds)return to;ds=1;var e=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",t=Ry(),r=un,n=rc,o=Vc(),i=function(u,y){if(typeof u>"u"||u===null)throw new TypeError("Cannot call method on "+u);if(typeof y!="string"||y!=="number"&&y!=="string")throw new TypeError('hint must be "string" or "number"');var h=y==="string"?["toString","valueOf"]:["valueOf","toString"],T,l,f;for(f=0;f<h.length;++f)if(T=u[h[f]],r(T)&&(l=T.call(u),t(l)))return l;throw new TypeError("No default value")},a=function(u,y){var h=u[y];if(h!==null&&typeof h<"u"){if(!r(h))throw new TypeError(h+" returned for property "+String(y)+" of object "+u+" is not a function");return h}};return to=function(u){if(t(u))return u;var y="default";arguments.length>1&&(arguments[1]===String?y="string":arguments[1]===Number&&(y="number"));var h;if(e&&(Symbol.toPrimitive?h=a(u,Symbol.toPrimitive):o(u)&&(h=Symbol.prototype.valueOf)),typeof h<"u"){var T=h.call(u,y);if(t(T))return T;throw new TypeError("unable to convert exotic object to primitive")}return y==="default"&&(n(u)||o(u))&&(y="string"),i(u,y==="default"?"number":y)},to}var ro,hs;function Wc(){if(hs)return ro;hs=1;var e=Ny();return ro=function(r){return arguments.length>1?e(r,arguments[1]):e(r)},ro}var no,ys;function zc(){if(ys)return no;ys=1;var e=ee,t=e("%BigInt%",!0),r=e("%Number%"),n=j,o=We,i=xy(),a=Wc();return no=function(u){if(!t)throw new o("BigInts are not supported in this environment");var y=a(u,r);if(y==null)throw new n("Cannot convert null or undefined to a BigInt");if(typeof y=="boolean")return t(y?1:0);if(typeof y=="number")throw new n("Cannot convert a Number value to a BigInt");if(typeof y=="string"){var h=i(y);if(typeof h>"u")throw new n("Failed to parse String to BigInt");return h}if(typeof y=="symbol")throw new n("Cannot convert a Symbol value to a BigInt");if(typeof y!="bigint")throw new o("Assertion failed: unknown primitive type");return y},no}var oo,gs;function Hc(){if(gs)return oo;gs=1;var e=ee,t=e("%BigInt%",!0),r=ec,n=j,o=t&&t(0);return oo=function(a,c){if(typeof a!="bigint"||typeof c!="bigint")throw new n("Assertion failed: `n` and `d` arguments must be BigInts");if(c===o)throw new r("Division by zero");return a===o?o:a%c},oo}var io,vs;function Kc(){return vs||(vs=1,io=function(t,r,n){var o=t(r,n);return o>=0?o:o+n}),io}var ao,ms;function By(){if(ms)return ao;ms=1;var e=ee,t=e("%BigInt%",!0),r=Pt,n=zc(),o=Hc(),i=Kc(),a=t&&BigInt(r(2,32))*BigInt(r(2,31)),c=t&&BigInt(r(2,32))*BigInt(r(2,32));return ao=function(y){var h=n(y),T=i(o,h,c);return T>=a?T-c:T},ao}var so,bs;function Dy(){if(bs)return so;bs=1;var e=ee,t=e("%BigInt%",!0),r=Pt,n=zc(),o=Hc(),i=Kc(),a=t&&BigInt(r(2,32))*BigInt(r(2,32));return so=function(u){var y=n(u),h=i(o,y,a);return h},so}var uo,Ts;function Uy(){if(Ts)return uo;Ts=1;var e=Ft;return uo=function(r,n){var o=r%n;return e(o>=0?o:o+n)},uo}var co,Ss;function ky(){return Ss||(Ss=1,co=Uy()),co}var lo,_s;function kt(){if(_s)return lo;_s=1;var e=ky();return lo=function(r,n){return e(r,n)},lo}var fo,Es;function jy(){return Es||(Es=1,fo=function(t){return t===null||typeof t!="function"&&typeof t!="object"}),fo}var po,ws;function Jc(){if(ws)return po;ws=1;var e=j;return po=function(r){if(r==null)throw new e(arguments.length>0&&arguments[1]||"Cannot call method on "+r);return r},po}var qy=ee,Gy=qy("%String%"),Vy=j,Yc=function(t){if(typeof t=="symbol")throw new Vy("Cannot convert a Symbol value to a string");return Gy(t)},ho,As;function Zc(){if(As)return ho;As=1;var e=Jc(),t=Yc,r=W,n=r("String.prototype.replace"),o=/^\s$/.test(""),i=o?/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/:/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,a=o?/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/:/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;return ho=function(){var u=t(e(this));return n(n(u,i,""),a,"")},ho}var yo,Is;function Xc(){if(Is)return yo;Is=1;var e=Zc(),t="",r="";return yo=function(){return String.prototype.trim&&t.trim()===t&&r.trim()===r&&("_"+r).trim()==="_"+r&&(r+"_").trim()===r+"_"?String.prototype.trim:e},yo}var go,$s;function Wy(){if($s)return go;$s=1;var e=nc(),t=bp,r=Xc();return go=function(){var o=r();return String.prototype.trim!==o&&(e?t(String.prototype,"trim",o,!0):t(String.prototype,"trim",o)),o},go}var vo,Cs;function zy(){if(Cs)return vo;Cs=1;var e=Qe,t=or,r=Jc(),n=Zc(),o=Xc(),i=Wy(),a=e(o()),c=function(y){return r(y),a(y)};return t(c,{getPolyfill:o,implementation:n,shim:i}),vo=c,vo}var mo,Os;function Hy(){if(Os)return mo;Os=1;var e=ee,t=e("%RegExp%"),r=j,n=e("%parseInt%"),o=W,i=fn(),a=o("String.prototype.slice"),c=i(/^0b[01]+$/i),u=i(/^0o[0-7]+$/i),y=i(/^[-+]0x[0-9a-f]+$/i),h=["","",""].join(""),T=new t("["+h+"]","g"),l=i(T),f=zy();return mo=function _(E){if(typeof E!="string")throw new r("Assertion failed: `argument` is not a String");if(c(E))return+n(a(E,2),2);if(u(E))return+n(a(E,2),8);if(l(E)||y(E))return NaN;var A=f(E);return A!==E?_(A):+E},mo}var Ky=ee,Fs=j,Jy=Ky("%Number%"),Yy=jy(),Zy=Wc(),Xy=Hy(),nt=function(t){var r=Yy(t)?t:Zy(t,Jy);if(typeof r=="symbol")throw new Fs("Cannot convert a Symbol value to a number");if(typeof r=="bigint")throw new Fs("Conversion from 'BigInt' to 'number' is not allowed.");return typeof r=="string"?Xy(r):+r},Qy=Ft,Di=function(t){return typeof t=="bigint"?t:Qy(t)},Ps=Di,eg=j,mt=function(t){if(typeof t!="number"&&typeof t!="bigint")throw new eg("argument must be a Number or a BigInt");var r=t<0?-Ps(-t):Ps(t);return r===0?0:r},bo,Ms;function tg(){if(Ms)return bo;Ms=1;var e=kt(),t=nt,r=mt,n=ze,o=65536;return bo=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y>=32768?y-o:y},bo}var To,Ls;function rg(){if(Ls)return To;Ls=1;var e=kt(),t=nt,r=mt,n=ze,o=2147483648,i=4294967296;return To=function(c){var u=t(c);if(!n(u)||u===0)return 0;var y=r(u),h=e(y,i),T=h>=o?h-i:h;return T===0?0:T},To}var So,xs;function ng(){if(xs)return So;xs=1;var e=kt(),t=nt,r=mt,n=ze;return So=function(i){var a=t(i);if(!n(a)||a===0)return 0;var c=r(a),u=e(c,256);return u>=128?u-256:u},So}var _o,Rs;function og(){if(Rs)return _o;Rs=1;var e=kt(),t=nt,r=mt,n=ze,o=65536;return _o=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y===0?0:y},_o}var Eo,Ns;function ig(){if(Ns)return Eo;Ns=1;var e=kt(),t=nt,r=mt,n=ze,o=4294967296;return Eo=function(a){var c=t(a);if(!n(c)||c===0)return 0;var u=r(c),y=e(u,o);return y===0?0:y},Eo}var wo,Bs;function ag(){if(Bs)return wo;Bs=1;var e=ze,t=kt(),r=nt,n=mt;return wo=function(i){var a=r(i);if(!e(a)||a===0)return 0;var c=n(a),u=t(c,256);return u},wo}var Ao,Ds;function sg(){if(Ds)return Ao;Ds=1;var e=j,t=ic,r=oc;return Ao=function(o,i,a){if(typeof o!="number"||typeof i!="number"||typeof a!="number"||!(i<=a))throw new e("Assertion failed: all three arguments must be MVs, and `lower` must be `<= upper`");return r(t(i,o),a)},Ao}var Io,Us;function ug(){if(Us)return Io;Us=1;var e=sg(),t=nt,r=Di,n=Ot;return Io=function(i){var a=t(i);if(n(a))return 0;var c=e(a,0,255),u=r(c);return c<u+.5?u:c>u+.5?u+1:u%2===0?u:u+1},Io}var $o,ks;function Qc(){return ks||(ks=1,$o=function(t){return t===0&&1/t===-1/0}),$o}var Co,js;function cg(){if(js)return Co;js=1;var e=Ai,t=Ft,r=Pt,n=ze,o=Ot,i=Qc(),a=34028234663852886e22;return Co=function(u,y){if(o(u))return y?[0,0,192,127]:[127,192,0,0];var h;if(u===0)return h=i(u)?128:0,y?[0,0,0,h]:[h,0,0,0];if(e(u)>a||!n(u))return h=u<0?255:127,y?[0,0,128,h]:[h,128,0,0];var T=u<0?1:0;u=e(u);for(var l=0;u>=2;)l+=1,u/=2;for(;u<1;)l-=1,u*=2;var f=u-1;f*=r(2,23)+.5,f=t(f),l+=127,l<<=23;var _=T<<31|l|f,E=_&255;_>>=8;var A=_&255;_>>=8;var N=_&255;_>>=8;var F=_&255;return y?[E,A,N,F]:[F,N,A,E]},Co}var Oo,qs;function lg(){if(qs)return Oo;qs=1;var e=1075,t=54;return Oo=function(n){var o="";if(n===0)return o;for(var i=e,a,c=0;c<e;c+=1)if(a=n*2,a>=1?(n=a-1,o+="1",i===e&&(i=c)):(n=a,o+="0"),a===1||c-i>t)return o;return o},Oo}var Fo,Gs;function fg(){if(Gs)return Fo;Gs=1;var e=Ft;return Fo=function(r){for(var n="",o;r>0;)o=r/2,r=e(o),o===r?n="0"+n:n="1"+n;return n},Fo}var Po,Vs;function pg(){if(Vs)return Po;Vs=1;var e=ee,t=e("%parseInt%"),r=Ai,n=Ft,o=Qc(),i=W,a=i("String.prototype.indexOf"),c=i("String.prototype.slice"),u=lg(),y=fg(),h=1023,T="11111111111",l="00000000000",f=l+l+l+l+"0000000";return Po=function(E,A){var N=E<0||o(E)?"1":"0",F,b;if(isNaN(E))F=T,b="1"+f;else if(!isFinite(E))F=T,b="0"+f;else if(E===0)F=l,b="0"+f;else{E=r(E);var w=n(E),$=y(w),L=u(E-w),C;if($)F=$.length-1;else{var D=a(L,"1");D>-1&&(C=D+1),F=-C}b=$+L,F<0?(F<=-h&&(C=h-1),b=c(b,C)):b=c(b,1),F=c(l+y(F+h),-11),b=c(b+f+"0",0,52)}for(var d=N+F+b,I=[],g=0;g<8;g++){var v=A?8-g-1:g;I[v]=t(c(d,g*8,(g+1)*8),2)}return I},Po}var Mo,Ws;function dg(){if(Ws)return Mo;Ws=1;var e=ee,t=e("%Number%"),r=e("%BigInt%",!0);return Mo=function(o,i,a){var c=typeof o=="bigint"?r:t;o<0&&(o>>>=0);for(var u=[],y=0;y<i;y++)u[a?y:i-1-y]=t(o&c(255)),o>>=c(8);return u},Mo}var Lo,zs;function hg(){if(zs)return Lo;zs=1;var e=j,t=Dc(),r=By(),n=Dy(),o=tg(),i=rg(),a=ng(),c=og(),u=ig(),y=ag(),h=ug(),T=cg(),l=pg(),f=dg(),_=Dt,E={__proto__:null,$INT8:a,$UINT8:y,$UINT8C:h,$INT16:o,$UINT16:c,$INT32:i,$UINT32:u,$BIGINT64:r,$BIGUINT64:n};return Lo=function(N,F,b){if(typeof N!="string"||!t(_.size,"$"+N))throw new e("Assertion failed: `type` must be a TypedArray element type");if(typeof F!="number"&&typeof F!="bigint")throw new e("Assertion failed: `value` must be a Number or a BigInt");if(typeof b!="boolean")throw new e("Assertion failed: `isLittleEndian` must be a Boolean");if(N==="FLOAT32")return T(F,b);if(N==="FLOAT64")return l(F,b);var w=_.size["$"+N],$=E["$"+N],L=$(F);return f(L,w,b)},Lo}var xo,Hs;function yg(){return Hs||(Hs=1,xo=function(t,r){for(var n=0;n<t.length;n+=1)r(t[n],n,t)}),xo}var gg=ee,vg=We,Ge=j,mg=ln,bg=gg("%Uint8Array%",!0),Tg=jc(),Sg=Bt,_g=hg(),Eg=Nt,wg=sr,Ag=yt,Ro=Dt,Ig=qc(),$g=yg(),Cg=function(t,r,n,o,i,a){var c=wg(t);if(!Eg(t)&&!c)throw new Ge("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(!mg(r)||r<0)throw new Ge("Assertion failed: `byteIndex` must be a non-negative integer");if(typeof n!="string"||!Ag(Ro.size,"$"+n))throw new Ge("Assertion failed: `type` must be one of "+Ro.choices);if(typeof o!="number"&&typeof o!="bigint")throw new Ge("Assertion failed: `value` must be a Number or a BigInt");if(typeof i!="boolean")throw new Ge("Assertion failed: `isTypedArray` must be a boolean");if(a!=="SEQ-CST"&&a!=="UNORDERED"&&a!=="INIT")throw new Ge('Assertion failed: `order` must be `"SEQ-CST"`, `"UNORDERED"`, or `"INIT"`');if(arguments.length>6&&typeof arguments[6]!="boolean")throw new Ge("Assertion failed: `isLittleEndian` must be a boolean, if present");if(Sg(t))throw new Ge("Assertion failed: ArrayBuffer is detached");if(Tg(n)?typeof o!="bigint":typeof o!="number")throw new Ge("Assertion failed: `value` must be a BigInt if type is ~BIGINT64~ or ~BIGUINT64~, otherwise a Number");var u=Ro.size["$"+n],y=arguments.length>6?arguments[6]:Ig==="little",h=_g(n,o,y);if(c)throw new vg("SharedArrayBuffer is not supported by this implementation");var T=new bg(t,r,u);$g(h,function(l,f){T[f]=l})},Og=nt,Fg=mt,Pg=Ot,Mg=ze,Lg=function(t){var r=Og(t);return Pg(r)||r===0?0:Mg(r)?Fg(r):r},xg=We,Rg=j,Ng=ln,Bg=Rt,Ks=Dt,Ui=function(t){var r=Bg(t);if(!r)throw new Rg("Assertion failed: `O` must be a TypedArray");var n=Ks.size["$"+Ks.name["$"+r]];if(!Ng(n)||n<0)throw new xg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},Dg=We,Ug=j,kg=Rt,jg=Dt,qg=function(t){var r=kg(t);if(!r)throw new Ug("Assertion failed: `O` must be a TypedArray");var n=jg.name["$"+r];if(typeof n!="string")throw new Dg("Assertion failed: Unknown TypedArray type `"+r+"`");return n},yi={exports:{}},Gg=ee,No,Js;function ki(){if(Js)return No;Js=1;var e=j,t=yt,r={__proto__:null,"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};return No=function(o){if(!o||typeof o!="object")return!1;for(var i in o)if(t(o,i)&&!r[i])return!1;var a=t(o,"[[Value]]")||t(o,"[[Writable]]"),c=t(o,"[[Get]]")||t(o,"[[Set]]");if(a&&c)throw new e("Property Descriptors may not be both accessor and data descriptors");return!0},No}var Bo,Ys;function Vg(){if(Ys)return Bo;Ys=1;var e=nc,t=Tp,r=e.hasArrayLengthDefineBug(),n=r&&kc,o=W,i=o("Object.prototype.propertyIsEnumerable");return Bo=function(c,u,y,h,T,l){if(!t){if(!c(l)||!l["[[Configurable]]"]||!l["[[Writable]]"]||T in h&&i(h,T)!==!!l["[[Enumerable]]"])return!1;var f=l["[[Value]]"];return h[T]=f,u(h[T],f)}return r&&T==="length"&&"[[Value]]"in l&&n(h)&&h.length!==l["[[Value]]"]?(h.length=l["[[Value]]"],h.length===l["[[Value]]"]):(t(h,T,y(l)),!0)},Bo}var Do,Zs;function Wg(){return Zs||(Zs=1,Do=function(t){if(typeof t>"u")return t;var r={};return"[[Value]]"in t&&(r.value=t["[[Value]]"]),"[[Writable]]"in t&&(r.writable=!!t["[[Writable]]"]),"[[Get]]"in t&&(r.get=t["[[Get]]"]),"[[Set]]"in t&&(r.set=t["[[Set]]"]),"[[Enumerable]]"in t&&(r.enumerable=!!t["[[Enumerable]]"]),"[[Configurable]]"in t&&(r.configurable=!!t["[[Configurable]]"]),r}),Do}var Uo,Xs;function zg(){if(Xs)return Uo;Xs=1;var e=j,t=ki(),r=Wg();return Uo=function(o){if(typeof o<"u"&&!t(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return r(o)},Uo}var ko,Qs;function Hg(){if(Qs)return ko;Qs=1;var e=j,t=yt,r=ki();return ko=function(o){if(typeof o>"u")return!1;if(!r(o))throw new e("Assertion failed: `Desc` must be a Property Descriptor");return!(!t(o,"[[Value]]")&&!t(o,"[[Writable]]"))},ko}var el=un,jo,eu;function Kg(){return eu||(eu=1,jo=function(t){return!!t}),jo}var qo,tu;function Jg(){if(tu)return qo;tu=1;var e=yt,t=j,r=rt,n=el,o=Kg();return qo=function(a){if(!r(a))throw new t("ToPropertyDescriptor requires an object");var c={};if(e(a,"enumerable")&&(c["[[Enumerable]]"]=o(a.enumerable)),e(a,"configurable")&&(c["[[Configurable]]"]=o(a.configurable)),e(a,"value")&&(c["[[Value]]"]=a.value),e(a,"writable")&&(c["[[Writable]]"]=o(a.writable)),e(a,"get")){var u=a.get;if(typeof u<"u"&&!n(u))throw new t("getter must be a function");c["[[Get]]"]=u}if(e(a,"set")){var y=a.set;if(typeof y<"u"&&!n(y))throw new t("setter must be a function");c["[[Set]]"]=y}if((e(c,"[[Get]]")||e(c,"[[Set]]"))&&(e(c,"[[Value]]")||e(c,"[[Writable]]")))throw new t("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return c},qo}var Go,ru;function Yg(){if(ru)return Go;ru=1;var e=j,t=rt,r=ki(),n=Vg(),o=zg(),i=Hg(),a=cn,c=Gc,u=Jg();return Go=function(h,T,l){if(!t(h))throw new e("Assertion failed: Type(O) is not Object");if(!a(T))throw new e("Assertion failed: P is not a Property Key");var f=r(l)?l:u(l);if(!r(f))throw new e("Assertion failed: Desc is not a valid Property Descriptor");return n(i,c,o,h,T,f)},Go}var Zg=Gg,nu=Zg("%Reflect.construct%",!0),qr=Yg();try{qr({},"",{"[[Get]]":function(){}})}catch{qr=null}if(qr&&nu){var ou={},iu={};qr(iu,"length",{"[[Get]]":function(){throw ou},"[[Enumerable]]":!0}),yi.exports=function(t){try{nu(t,iu)}catch(r){return r===ou}}}else yi.exports=function(t){return typeof t=="function"&&!!t.prototype};var tl=yi.exports,Xg=ee,au=Xg("%Symbol.species%",!0),Vo=j,su=rt,Qg=tl,ev=function(t,r){if(!su(t))throw new Vo("Assertion failed: Type(O) is not Object");var n=t.constructor;if(typeof n>"u")return r;if(!su(n))throw new Vo("O.constructor is not an Object");var o=au?n[au]:void 0;if(o==null)return r;if(Qg(o))return o;throw new Vo("no constructor found")},tv=j,rl=W,uu=rl("%ArrayBuffer.prototype.resizable%",!0),cu=rl("%SharedArrayBuffer.prototype.growable%",!0),rv=Nt,nv=sr,nl=function(t){var r=rv(t),n=nv(t);if(!r&&!n)throw new tv("Assertion failed: `arrayBuffer` must be an ArrayBuffer or SharedArrayBuffer");return r&&uu?!uu(t):n&&cu?!cu(t):!0},ov=ln,lu=yt,iv=Ut,av=ov,ol=function(t){return!!t&&typeof t=="object"&&lu(t,"[[Object]]")&&lu(t,"[[CachedBufferByteLength]]")&&(av(t["[[CachedBufferByteLength]]"])&&t["[[CachedBufferByteLength]]"]>=0||t["[[CachedBufferByteLength]]"]==="DETACHED")&&iv(t["[[Object]]"])},sv=rt,il=W,uv=il("String.prototype.valueOf"),cv=function(t){try{return uv(t),!0}catch{return!1}},lv=il("Object.prototype.toString"),fv="[object String]",pv=ht(),dv=function(t){return typeof t=="string"?!0:!t||typeof t!="object"?!1:pv?cv(t):lv(t)===fv},al=W,hv=al("Number.prototype.toString"),yv=function(t){try{return hv(t),!0}catch{return!1}},gv=al("Object.prototype.toString"),vv="[object Number]",mv=ht(),bv=function(t){return typeof t=="number"?!0:!t||typeof t!="object"?!1:mv?yv(t):gv(t)===vv},sl=W,Tv=sl("Boolean.prototype.toString"),Sv=sl("Object.prototype.toString"),_v=function(t){try{return Tv(t),!0}catch{return!1}},Ev="[object Boolean]",wv=ht(),Av=function(t){return typeof t=="boolean"?!0:t===null||typeof t!="object"?!1:wv?_v(t):Sv(t)===Ev},gi={exports:{}},fu=typeof BigInt<"u"&&BigInt,Iv=function(){return typeof fu=="function"&&typeof BigInt=="function"&&typeof fu(42)=="bigint"&&typeof BigInt(42)=="bigint"},$v=Iv();if($v){var Cv=BigInt.prototype.valueOf,Ov=function(t){try{return Cv.call(t),!0}catch{}return!1};gi.exports=function(t){return t===null||typeof t>"u"||typeof t=="boolean"||typeof t=="string"||typeof t=="number"||typeof t=="symbol"||typeof t=="function"?!1:typeof t=="bigint"?!0:Ov(t)}}else gi.exports=function(t){return!1};var Fv=gi.exports,Pv=dv,Mv=bv,Lv=Av,xv=Vc(),Rv=Fv,Nv=function(t){if(t==null||typeof t!="object"&&typeof t!="function")return null;if(Pv(t))return"String";if(Mv(t))return"Number";if(Lv(t))return"Boolean";if(xv(t))return"Symbol";if(Rv(t))return"BigInt"},ji=typeof Map=="function"&&Map.prototype?Map:null,Bv=typeof Set=="function"&&Set.prototype?Set:null,Gr;ji||(Gr=function(t){return!1});var ul=ji?Map.prototype.has:null,pu=Bv?Set.prototype.has:null;!Gr&&!ul&&(Gr=function(t){return!1});var Dv=Gr||function(t){if(!t||typeof t!="object")return!1;try{if(ul.call(t),pu)try{pu.call(t)}catch{return!0}return t instanceof ji}catch{}return!1},Uv=typeof Map=="function"&&Map.prototype?Map:null,qi=typeof Set=="function"&&Set.prototype?Set:null,Vr;qi||(Vr=function(t){return!1});var du=Uv?Map.prototype.has:null,cl=qi?Set.prototype.has:null;!Vr&&!cl&&(Vr=function(t){return!1});var kv=Vr||function(t){if(!t||typeof t!="object")return!1;try{if(cl.call(t),du)try{du.call(t)}catch{return!0}return t instanceof qi}catch{}return!1},Wr=typeof WeakMap=="function"&&WeakMap.prototype?WeakMap:null,hu=typeof WeakSet=="function"&&WeakSet.prototype?WeakSet:null,zr;Wr||(zr=function(t){return!1});var vi=Wr?Wr.prototype.has:null,Wo=hu?hu.prototype.has:null;!zr&&!vi&&(zr=function(t){return!1});var jv=zr||function(t){if(!t||typeof t!="object")return!1;try{if(vi.call(t,vi),Wo)try{Wo.call(t,Wo)}catch{return!0}return t instanceof Wr}catch{}return!1},mi={exports:{}},qv=ee,ll=W,Gv=qv("%WeakSet%",!0),zo=ll("WeakSet.prototype.has",!0);if(zo){var Ho=ll("WeakMap.prototype.has",!0);mi.exports=function(t){if(!t||typeof t!="object")return!1;try{if(zo(t,zo),Ho)try{Ho(t,Ho)}catch{return!0}return t instanceof Gv}catch{}return!1}}else mi.exports=function(t){return!1};var Vv=mi.exports,Wv=Dv,zv=kv,Hv=jv,Kv=Vv,Jv=function(t){if(t&&typeof t=="object"){if(Wv(t))return"Map";if(zv(t))return"Set";if(Hv(t))return"WeakMap";if(Kv(t))return"WeakSet"}return!1},Yv={}.toString,Zv=Array.isArray||function(e){return Yv.call(e)=="[object Array]"},Xv=W,Qv=Xv("WeakRef.prototype.deref",!0),em=typeof WeakRef>"u"?function(t){return!1}:function(t){if(!t||typeof t!="object")return!1;try{return Qv(t),!0}catch{return!1}},tm=W,yu=tm("FinalizationRegistry.prototype.register",!0),rm=yu?function(t){if(!t||typeof t!="object")return!1;try{return yu(t,{},null),!0}catch{return!1}}:function(t){return!1},fl=un,nm=yt,om=ac(),Gi=W,pl=Gi("Function.prototype.toString"),dl=Gi("String.prototype.match"),Ko=Gi("Object.prototype.toString"),im=/^class /,am=function(t){if(fl(t)||typeof t!="function")return!1;try{var r=dl(pl(t),im);return!!r}catch{}return!1},sm=/\s*function\s+([^(\s]*)\s*/,um=!(0 in[,]),cm="[object Object]",lm="[object HTMLAllCollection]",fm=Function.prototype,hl=function(){return!1};if(typeof document=="object"){var pm=document.all;Ko(pm)===Ko(document.all)&&(hl=function(t){if((um||!t)&&(typeof t>"u"||typeof t=="object"))try{var r=Ko(t);return(r===lm||r===cm)&&t("")==null}catch{}return!1})}var yl=function(){if(hl(this)||!am(this)&&!fl(this))throw new TypeError("Function.prototype.name sham getter called on non-function");if(om&&nm(this,"name"))return this.name;if(this===fm)return"";var t=pl(this),r=dl(t,sm),n=r&&r[1];return n},dm=yl,gl=function(){return dm},hm=or.supportsDescriptors,ym=ac(),gm=gl,gu=Object.defineProperty,vm=TypeError,mm=function(){var t=gm();if(ym)return t;if(!hm)throw new vm("Shimming Function.prototype.name support requires ES5 property descriptor support.");var r=Function.prototype;return gu(r,"name",{configurable:!0,enumerable:!1,get:function(){var n=t.call(this);return this!==r&&gu(this,"name",{configurable:!0,enumerable:!1,value:n,writable:!1}),n}}),t},bm=or,Tm=Qe,vl=yl,Sm=gl,_m=mm,ml=Tm(vl);bm(ml,{getPolyfill:Sm,implementation:vl,shim:_m});var Em=ml,Jo,vu;function wm(){if(vu)return Jo;vu=1;const e=(function*(){}).constructor;return Jo=()=>e,Jo}var bl=W,Am=fn(),Im=Am(/^\s*(?:function)?\*/),$m=ht(),mu=Ct,Cm=bl("Object.prototype.toString"),Om=bl("Function.prototype.toString"),Fm=wm(),Pm=function(t){if(typeof t!="function")return!1;if(Im(Om(t)))return!0;if(!$m){var r=Cm(t);return r==="[object GeneratorFunction]"}if(!mu)return!1;var n=Fm();return n&&mu(t)===n.prototype},Yo,bu;function Mm(){if(bu)return Yo;bu=1;const e=(async function(){}).constructor;return Yo=()=>e,Yo}var Tl=W,Lm=fn(),xm=Tl("Object.prototype.toString"),Rm=Tl("Function.prototype.toString"),Nm=Lm(/^\s*async(?:\s+function(?:\s+|\()|\s*\()/),Bm=ht(),Tu=Ct,Dm=Mm(),Um=function(t){if(typeof t!="function")return!1;if(Nm(Rm(t)))return!0;if(!Bm){var r=xm(t);return r==="[object AsyncFunction]"}if(!Tu)return!1;var n=Dm();return n&&n.prototype===Tu(t)},km=Nv,jm=Jv,qm=Rt,Gm=Zv,Vm=rc,Wm=tc,zm=em,Hm=rm,Km=Em,Jm=Pm,Ym=Um,Zm=W,Xm=ht(),Zo=Xm&&Symbol.toStringTag,Qm=Object,Su=Zm("Promise.prototype.then",!0),eb=function(t){if(!t||typeof t!="object"||!Su)return!1;try{return Su(t,null,function(){}),!0}catch{}return!1},_u=function(t){return!!t&&t!=="BigInt"&&t!=="Boolean"&&t!=="Null"&&t!=="Number"&&t!=="String"&&t!=="Symbol"&&t!=="Undefined"&&t!=="Math"&&t!=="JSON"&&t!=="Reflect"&&t!=="Atomics"&&t!=="Map"&&t!=="Set"&&t!=="WeakMap"&&t!=="WeakSet"&&t!=="BigInt64Array"&&t!=="BigUint64Array"&&t!=="Float32Array"&&t!=="Float64Array"&&t!=="Int16Array"&&t!=="Int32Array"&&t!=="Int8Array"&&t!=="Uint16Array"&&t!=="Uint32Array"&&t!=="Uint8Array"&&t!=="Uint8ClampedArray"&&t!=="Array"&&t!=="Date"&&t!=="FinalizationRegistry"&&t!=="Promise"&&t!=="RegExp"&&t!=="WeakRef"&&t!=="Function"&&t!=="GeneratorFunction"&&t!=="AsyncFunction"},tb=function(t){if(t==null)return t;var r=km(Qm(t))||jm(t)||qm(t);if(r)return r;if(Gm(t))return"Array";if(Vm(t))return"Date";if(Wm(t))return"RegExp";if(zm(t))return"WeakRef";if(Hm(t))return"FinalizationRegistry";if(typeof t=="function")return Jm(t)?"GeneratorFunction":Ym(t)?"AsyncFunction":"Function";if(eb(t))return"Promise";if(Zo&&Zo in t){var n=t[Zo];if(_u(n))return n}if(typeof t.constructor=="function"){var o=Km(t.constructor);if(_u(o))return o}return"Object"},rb=ee,nb=el,ob=sv,ib=tb,ab=j,Eu=Ct,sb=Sp,ub=function(t){if(!ob(t))throw new ab("Reflect.getPrototypeOf called on non-object");if(Eu)return Eu(t);var r=ib(t);if(r){var n=rb("%"+r+".prototype%",!0);if(n)return n}return nb(t.constructor)?t.constructor.prototype:t instanceof Object?sb.prototype:null},cb=ub,wu=Ct,Sl=function(){return typeof Reflect=="object"&&Reflect&&Reflect.getPrototypeOf?Reflect.getPrototypeOf:wu?function(r){return wu(r)}:cb},_l=Pi,lb=Qe,fb=Sl(),pb=ar(),bi={__proto__:null},Er=Xr,Au=Object.defineProperty;if(Er){var db=function(e){return e.byteOffset};_l(pb,function(e){if(typeof window[e]=="function"||typeof window[e]=="object"){var t=window[e].prototype,r=Er(t,"byteOffset");if(!r){var n=fb(t);r=Er(n,"byteOffset")}if(r&&r.get)bi[e]=lb(r.get);else if(Au){var o=new window[e](2);r=Er(o,"byteOffset"),r&&r.configurable&&Au(o,"length",{value:3}),o.length===2&&(bi[e]=db)}}})}var hb=function(t){var r;return _l(bi,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},yb=Ut,Vi=function(t){return yb(t)?hb(t):!1},gb=Qe,El=Pi,wr=Xr,vb=Ut,mb=$c,bb=Sl(),Ti={__proto__:null},Iu=Object.defineProperty;if(wr){var Tb=function(e){return e.length};El(mb,function(e){var t=window[e];if(typeof t=="function"||typeof t=="object"){var r=t.prototype,n=wr(r,"length");if(!n){var o=bb(r);n=wr(o,"length")}if(n&&n.get)Ti["$"+e]=gb(n.get);else if(Iu){var i=new window[e](2);n=wr(i,"length"),n&&n.configurable&&Iu(i,"length",{value:3}),i.length===2&&(Ti["$"+e]=Tb)}}})}var Sb=function(t){var r;return El(Ti,function(n){if(typeof r!="number")try{var o=n(t);typeof o=="number"&&(r=o)}catch{}}),r},wl=function(t){return vb(t)?Sb(t):!1},$u=j,_b=Bt,Eb=nl,wb=Ui,Ab=ol,Cu=ur,Ib=Vi,$b=wl,Wi=function(t){if(!Ab(t))throw new $u("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");var r=t["[[Object]]"],n=t["[[CachedBufferByteLength]]"];if(_b(Cu(r))&&n!=="DETACHED")throw new $u("Assertion failed: typed array is detached only if the byte length is ~DETACHED~");if(n==="DETACHED")return!0;var o=Ib(r),i=Eb(Cu(r)),a,c=i?$b(r):"AUTO";if(c==="AUTO")a=n;else{var u=wb(r);a=o+c*u}return o>n||a>n},Ar=j,Cb=Di,Ob=nl,Fb=Wi,Pb=Ui,Mb=ol,Lb=ur,xb=Vi,Rb=wl,Nb=function(t){if(!Mb(t))throw new Ar("Assertion failed: `taRecord` must be a TypedArray With Buffer Witness Record");if(Fb(t))throw new Ar("Assertion failed: `taRecord` is out of bounds");var r=t["[[Object]]"],n=Ob(Lb(r)),o=n?Rb(r):"AUTO";if(o!=="AUTO")return o;if(n)throw new Ar("Assertion failed: array buffer is not fixed length");var i=xb(r),a=Pb(r),c=t["[[CachedBufferByteLength]]"];if(c==="DETACHED")throw new Ar("Assertion failed: typed array is detached");return Cb((c-i)/a)},Xo=j,Bb=Bt,Db=Nt,Ub=sr,kb=Bc,jb=W,qb=jb("SharedArrayBuffer.prototype.byteLength",!0),Gb=function(t,r){var n=Ub(t);if(!Db(t)&&!n)throw new Xo("Assertion failed: `arrayBuffer` must be an ArrayBuffer or a SharedArrayBuffer");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Xo("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(Bb(t))throw new Xo("Assertion failed: `arrayBuffer` must not be detached");return n?qb(t):kb(t)},Ou=j,Vb=Gb,Wb=Bt,zb=Ut,Hb=ur,Kb=function(t,r){if(!zb(t))throw new Ou("Assertion failed: `obj` must be a Typed Array");if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Ou("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");var n=Hb(t),o=Wb(n)?"DETACHED":Vb(n,r);return{"[[Object]]":t,"[[CachedBufferByteLength]]":o}},Ir=j,Jb=rt,Yb=Wi,Zb=Kb,Xb=Ut,Al=function(t,r){if(r!=="SEQ-CST"&&r!=="UNORDERED")throw new Ir("Assertion failed: `order` must be ~SEQ-CST~ or ~UNORDERED~");if(!Jb(t))throw new Ir("Assertion failed: `O` must be an Object");if(!Xb(t))throw new Ir("Assertion failed: `O` must be a Typed Array");var n=Zb(t,r);if(Yb(n))throw new Ir("`O` must be in-bounds and backed by a non-detached buffer");return n},Qb=We,$r=j,e0=Bi,t0=tl,r0=Wi,n0=Nb,o0=Al,i0=ar(),a0=function(t,r){if(!t0(t))throw new $r("Assertion failed: `constructor` must be a constructor");if(!e0(r))throw new $r("Assertion failed: `argumentList` must be a List");if(i0.length===0)throw new Qb("Assertion failed: Typed Arrays are not supported in this environment");var n;r.length===0?n=new t:r.length===1?n=new t(r[0]):r.length===2?n=new t(r[0],r[1]):n=new t(r[0],r[1],r[2]);var o=o0(n,"SEQ-CST");if(r.length===1&&typeof r[0]=="number"){if(r0(o))throw new $r("new Typed Array is out of bounds");var i=n0(o);if(i<r[0])throw new $r("`argumentList[0]` must be <= `newTypedArray.length`")}return n},Ae=ee,s0={__proto__:null,$Int8Array:Ae("%Int8Array%",!0),$Uint8Array:Ae("%Uint8Array%",!0),$Uint8ClampedArray:Ae("%Uint8ClampedArray%",!0),$Int16Array:Ae("%Int16Array%",!0),$Uint16Array:Ae("%Uint16Array%",!0),$Int32Array:Ae("%Int32Array%",!0),$Uint32Array:Ae("%Uint32Array%",!0),$BigInt64Array:Ae("%BigInt64Array%",!0),$BigUint64Array:Ae("%BigUint64Array%",!0),$Float16Array:Ae("%Float16Array%",!0),$Float32Array:Ae("%Float32Array%",!0),$Float64Array:Ae("%Float64Array%",!0)},u0=function(t){return s0["$"+t]},Fu=We,Pu=j,c0=Rt,l0=ar(),f0=Bi,p0=ev,d0=a0,h0=u0,y0=function(t,r){if(l0.length===0)throw new Fu("Assertion failed: Typed Arrays are not supported in this environment");var n=c0(t);if(!n)throw new Pu("Assertion failed: exemplar must be a TypedArray");if(!f0(r))throw new Pu("Assertion failed: `argumentList` must be a List");var o=h0(n);if(typeof o!="function")throw new Fu("Assertion failed: `constructor` of `exemplar` ("+n+") must exist. Please report this!");var i=p0(t,o);return d0(i,r)},g0=j,v0=Uh,m0=Fy,b0=Bt,Qo=ic,Mu=oc,T0=Ly,S0=Cg,Lu=Lg,xu=Yc,_0=Ui,Ru=qg,E0=y0,w0=Al,ei=ur,Nu=Vi,Il=function(t,r){var n=this;w0(n,"SEQ-CST");var o=n.length,i=Lu(t),a;i===-1/0?a=0:i<0?a=Qo(o+i,0):a=Mu(i,o);var c=typeof r>"u"?o:Lu(r),u;c===-1/0?u=0:c<0?u=Qo(o+c,0):u=Mu(c,o);var y=Qo(u-a,0),h=E0(n,[y]);if(y>0){if(b0(ei(n)))throw new g0("Cannot use a Typed Array with an underlying ArrayBuffer that is detached");var T=Ru(n),l=Ru(h);if(T===l)for(var f=ei(n),_=ei(h),E=_0(n),A=Nu(n),N=a*E+A,F=Nu(h),b=F+y*E;F<b;){var w=m0(f,N,"UINT8",!0,"UNORDERED");S0(_,F,"UINT8",w,!0,"UNORDERED"),N+=1,F+=1}else for(var $=0;a<u;){var L=xu(a),C=v0(n,L);T0(h,xu($),C,!0),a+=1,$+=1}}return h},A0=Il,$l=function(){return typeof Uint8Array=="function"&&Uint8Array.prototype.slice||A0},I0=or,$0=Ct,C0=$l,O0=function(){if(typeof Uint8Array=="function"){var t=C0(),r=$0(Uint8Array.prototype);I0(r,{slice:t},{slice:function(){return r.slice!==t}})}return t},F0=or,P0=Qe,M0=Il,Cl=$l,L0=O0,Ol=P0(Cl());F0(Ol,{getPolyfill:Cl,implementation:M0,shim:L0});var x0=Ol,Fl=Rt,Pl=x0,Bu=Xr;function jt(e){return Object.prototype.toString.call(e)}function R0(e){return jt(e)==="[object Date]"}function N0(e){return jt(e)==="[object RegExp]"}function B0(e){return jt(e)==="[object Error]"}function D0(e){return jt(e)==="[object Boolean]"}function U0(e){return jt(e)==="[object Number]"}function k0(e){return jt(e)==="[object String]"}var Ml=Array.isArray||function(t){return Object.prototype.toString.call(t)==="[object Array]"};function pn(e,t){if(e.forEach)return e.forEach(t);for(var r=0;r<e.length;r++)t(e[r],r,e)}var dn=Object.keys||function(t){var r=[];for(var n in t)r[r.length]=n;return r},j0=Object.prototype.propertyIsEnumerable,Du=Object.getOwnPropertySymbols;function hn(e){var t=dn(e);if(Du)for(var r=Du(e),n=0;n<r.length;n++)j0.call(e,r[n])&&(t[t.length]=r[n]);return t}var yn=Object.prototype.hasOwnProperty||function(e,t){return t in e};function q0(e,t){if(typeof Bu!="function")return!0;var r=Bu(e,t);return!r||!r.writable}function Ll(e,t){if(typeof e=="object"&&e!==null){var r;if(Ml(e))r=[];else if(R0(e))r=new Date(e.getTime?e.getTime():e);else if(N0(e))r=new RegExp(e);else if(B0(e))r={message:e.message};else if(D0(e)||U0(e)||k0(e))r=Object(e);else{var n=Fl(e);if(n)return Pl(e);if(Object.create&&Object.getPrototypeOf)r=Object.create(Object.getPrototypeOf(e));else if(e.constructor===Object)r={};else{var o=e.constructor&&e.constructor.prototype||e.__proto__||{},i=function(){};i.prototype=o,r=new i}}var a=t.includeSymbols?hn:dn;return pn(a(e),function(c){r[c]=e[c]}),r}return e}var zi={__proto__:null};function xl(e,t){var r=[],n=[],o=!0,i=arguments.length>2?arguments[2]:zi,a=i.includeSymbols?hn:dn,c=!!i.immutable;return function u(y){var h=c?Ll(y,i):y,T={__proto__:null},l=!0,f={node:h,node_:y,path:[].concat(r),parent:n[n.length-1],parents:n,key:r[r.length-1],removedKeys:{__proto__:null},isRoot:r.length===0,level:r.length,circular:null,update:function(A,N){f.isRoot||(f.parent.node[f.key]=A),f.node=A,N&&(l=!1)},delete:function(A){delete f.parent.node[f.key],f.parent.removedKeys[f.key]=!0,A&&(l=!1)},remove:function(A){Ml(f.parent.node)?(f.parent.node.splice(f.key,1),f.parent.removedKeys[f.key]=!0,A&&(l=!1)):f.delete(A)},keys:null,before:function(A){T.before=A},after:function(A){T.after=A},pre:function(A){T.pre=A},post:function(A){T.post=A},stop:function(){o=!1},block:function(){l=!1}};if(!o)return f;function _(){if(typeof f.node=="object"&&f.node!==null){(!f.keys||f.node_!==f.node)&&(f.keys=a(f.node)),f.isLeaf=f.keys.length===0;for(var A=0;A<n.length;A++)if(n[A].node_===y){f.circular=n[A];break}}else f.isLeaf=!0,f.keys=null;f.notLeaf=!f.isLeaf,f.notRoot=!f.isRoot}_();var E=t.call(f,f.node);return E!==void 0&&f.update&&f.update(E),T.before&&T.before.call(f,f.node),l&&(typeof f.node=="object"&&f.node!==null&&!f.circular&&(n[n.length]=f,_(),pn(f.keys,function(A,N){var F=N-1 in f.removedKeys;F&&(A=f.keys[N-1]),r[r.length]=A,T.pre&&T.pre.call(f,f.node[A],A);var b=u(f.node[A]);c&&yn.call(f.node,A)&&!q0(f.node,A)&&!F&&(f.node[A]=b.node),b.isLast=N===f.keys.length-1,b.isFirst=N===0,T.post&&T.post.call(f,b),r.pop()}),n.pop()),T.after&&T.after.call(f,f.node)),f}(e).node}function Ie(e){this.options=arguments.length>1?arguments[1]:zi,this.value=e}Ie.prototype.get=function(e){for(var t=this.value,r=0;t&&r<e.length;r++){var n=e[r];if(!yn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return;t=t[n]}return t};Ie.prototype.has=function(e){var t=this.value;if(!t&&e.length>0)return!1;for(var r=0;t&&r<e.length;r++){var n=e[r];if(!yn.call(t,n)||!this.options.includeSymbols&&typeof n=="symbol")return!1;t=t[n]}return!0};Ie.prototype.set=function(e,t){for(var r=this.value,n=0;n<e.length-1;n++){var o=e[n];yn.call(r,o)||(r[o]={}),r=r[o]}return r[e[n]]=t,t};Ie.prototype.map=function(e){return xl(this.value,e,{__proto__:null,immutable:!0,includeSymbols:!!this.options.includeSymbols})};Ie.prototype.forEach=function(e){return this.value=xl(this.value,e,this.options),this.value};Ie.prototype.reduce=function(e,t){var r=arguments.length===1,n=r?this.value:t;return this.forEach(function(o){(!this.isRoot||!r)&&(n=e.call(this,n,o))}),n};Ie.prototype.paths=function(){var e=[];return this.forEach(function(){e[e.length]=this.path}),e};Ie.prototype.nodes=function(){var e=[];return this.forEach(function(){e[e.length]=this.node}),e};Ie.prototype.clone=function(){var e=[],t=[],r=this.options;return Fl(this.value)?Pl(this.value):function n(o){for(var i=0;i<e.length;i++)if(e[i]===o)return t[i];if(typeof o=="object"&&o!==null){var a=Ll(o,r);e[e.length]=o,t[t.length]=a;var c=r.includeSymbols?hn:dn;return pn(c(o),function(u){a[u]=n(o[u])}),e.pop(),t.pop(),a}return o}(this.value)};function Rl(e){var t=arguments.length>1?arguments[1]:zi;return new Ie(e,t)}pn(hn(Ie.prototype),function(e){Rl[e]=function(t){var r=[].slice.call(arguments,1),n=new Ie(t);return n[e].apply(n,r)}});var G0=Rl,V0=me;function me(e){if(!(this instanceof me))return new me(e);this._bbox=e||[1/0,1/0,-1/0,-1/0],this._valid=!!e}me.prototype.include=function(e){return this._valid=!0,this._bbox[0]=Math.min(this._bbox[0],e[0]),this._bbox[1]=Math.min(this._bbox[1],e[1]),this._bbox[2]=Math.max(this._bbox[2],e[0]),this._bbox[3]=Math.max(this._bbox[3],e[1]),this};me.prototype.equals=function(e){var t;return e instanceof me?t=e.bbox():t=e,this._bbox[0]==t[0]&&this._bbox[1]==t[1]&&this._bbox[2]==t[2]&&this._bbox[3]==t[3]};me.prototype.center=function(e){return this._valid?[(this._bbox[0]+this._bbox[2])/2,(this._bbox[1]+this._bbox[3])/2]:null};me.prototype.union=function(e){this._valid=!0;var t;return e instanceof me?t=e.bbox():t=e,this._bbox[0]=Math.min(this._bbox[0],t[0]),this._bbox[1]=Math.min(this._bbox[1],t[1]),this._bbox[2]=Math.max(this._bbox[2],t[2]),this._bbox[3]=Math.max(this._bbox[3],t[3]),this};me.prototype.bbox=function(){return this._valid?this._bbox:null};me.prototype.contains=function(e){if(!e)return this._fastContains();if(!this._valid)return null;var t=e[0],r=e[1];return this._bbox[0]<=t&&this._bbox[1]<=r&&this._bbox[2]>=t&&this._bbox[3]>=r};me.prototype.intersect=function(e){if(!this._valid)return null;var t;return e instanceof me?t=e.bbox():t=e,!(this._bbox[0]>t[2]||this._bbox[2]<t[0]||this._bbox[3]<t[1]||this._bbox[1]>t[3])};me.prototype._fastContains=function(){if(!this._valid)return new Function("return null;");var e="return "+this._bbox[0]+"<= ll[0] &&"+this._bbox[1]+"<= ll[1] &&"+this._bbox[2]+">= ll[0] &&"+this._bbox[3]+">= ll[1]";return new Function("ll",e)};me.prototype.polygon=function(){return this._valid?{type:"Polygon",coordinates:[[[this._bbox[0],this._bbox[1]],[this._bbox[2],this._bbox[1]],[this._bbox[2],this._bbox[3]],[this._bbox[0],this._bbox[3]],[this._bbox[0],this._bbox[1]]]]}:null};var W0=Nd,z0=G0,H0=V0,Nl={features:["FeatureCollection"],coordinates:["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],geometry:["Feature"],geometries:["GeometryCollection"]},K0=Object.keys(Nl);sn.exports=function(e){return Hi(e).bbox()};sn.exports.polygon=function(e){return Hi(e).polygon()};sn.exports.bboxify=function(e){return z0(e).map(function(t){if(t){var r=K0.some(function(n){return t[n]?Nl[n].indexOf(t.type)!==-1:!1});r&&(t.bbox=Hi(t).bbox(),this.update(t))}})};function Hi(e){for(var t=H0(),r=W0(e),n=0;n<r.length;n++)t.include(r[n]);return t}var J0=sn.exports;const Y0=J0,Z0=V,{LAT_MIN:Cr,LAT_MAX:Or,LAT_RENDERED_MIN:Uu,LAT_RENDERED_MAX:ku,LNG_MIN:ju,LNG_MAX:qu}=Z0;var Ki=function(e,t){let r=Cr,n=Or,o=Cr,i=Or,a=qu,c=ju;e.forEach(y=>{const h=Y0(y),T=h[1],l=h[3],f=h[0],_=h[2];T>r&&(r=T),l<n&&(n=l),l>o&&(o=l),T<i&&(i=T),f<a&&(a=f),_>c&&(c=_)});const u=t;return r+u.lat>ku&&(u.lat=ku-r),o+u.lat>Or&&(u.lat=Or-o),n+u.lat<Uu&&(u.lat=Uu-n),i+u.lat<Cr&&(u.lat=Cr-i),a+u.lng<=ju&&(u.lng+=Math.ceil(Math.abs(u.lng)/360)*360),c+u.lng>=qu&&(u.lng-=Math.ceil(Math.abs(u.lng)/360)*360),u};const X0=Ki,Et=V;var gn=function(e,t){const r=X0(e.map(n=>n.toGeoJSON()),t);e.forEach(n=>{const o=n.getCoordinates(),i=y=>{const h={lng:y[0]+r.lng,lat:y[1]+r.lat};return[h.lng,h.lat]},a=y=>y.map(h=>i(h)),c=y=>y.map(h=>a(h));let u;n.type===Et.geojsonTypes.POINT?u=i(o):n.type===Et.geojsonTypes.LINE_STRING||n.type===Et.geojsonTypes.MULTI_POINT?u=o.map(i):n.type===Et.geojsonTypes.POLYGON||n.type===Et.geojsonTypes.MULTI_LINE_STRING?u=o.map(a):n.type===Et.geojsonTypes.MULTI_POLYGON&&(u=o.map(c)),n.incomingCoords(u)})};const dt=Lt,Ji=Cd,Q0=an,eT=Qr,Hr=xt,tT=gn,oe=V,J={};J.onSetup=function(e){const t={dragMoveLocation:null,boxSelectStartLocation:null,boxSelectElement:void 0,boxSelecting:!1,canBoxSelect:!1,dragMoveing:!1,canDragMove:!1,initiallySelectedFeatureIds:e.featureIds||[]};return this.setSelected(t.initiallySelectedFeatureIds.filter(r=>this.getFeature(r)!==void 0)),this.fireActionable(),this.setActionableState({combineFeatures:!0,uncombineFeatures:!0,trash:!0}),t};J.fireUpdate=function(){this.map.fire(oe.events.UPDATE,{action:oe.updateActions.MOVE,features:this.getSelected().map(e=>e.toGeoJSON())})};J.fireActionable=function(){const e=this.getSelected(),t=e.filter(i=>this.isInstanceOf("MultiFeature",i));let r=!1;if(e.length>1){r=!0;const i=e[0].type.replace("Multi","");e.forEach(a=>{a.type.replace("Multi","")!==i&&(r=!1)})}const n=t.length>0,o=e.length>0;this.setActionableState({combineFeatures:r,uncombineFeatures:n,trash:o})};J.getUniqueIds=function(e){return e.length?e.map(r=>r.properties.id).filter(r=>r!==void 0).reduce((r,n)=>(r.add(n),r),new eT).values():[]};J.stopExtendedInteractions=function(e){e.boxSelectElement&&(e.boxSelectElement.parentNode&&e.boxSelectElement.parentNode.removeChild(e.boxSelectElement),e.boxSelectElement=null),this.map.dragPan.enable(),e.boxSelecting=!1,e.canBoxSelect=!1,e.dragMoving=!1,e.canDragMove=!1};J.onStop=function(){Hr.enable(this)};J.onMouseMove=function(e){return this.stopExtendedInteractions(e)};J.onMouseOut=function(e){if(e.dragMoving)return this.fireUpdate()};J.onTap=J.onClick=function(e,t){if(dt.noTarget(t))return this.clickAnywhere(e,t);if(dt.isOfMetaType(oe.meta.VERTEX)(t))return this.clickOnVertex(e,t);if(dt.isFeature(t))return this.clickOnFeature(e,t)};J.clickAnywhere=function(e){const t=this.getSelectedIds();t.length&&(this.clearSelectedFeatures(),t.forEach(r=>this.doRender(r))),Hr.enable(this),this.stopExtendedInteractions(e)};J.clickOnVertex=function(e,t){this.changeMode(oe.modes.DIRECT_SELECT,{featureId:t.featureTarget.properties.parent,coordPath:t.featureTarget.properties.coord_path,startPos:t.lngLat}),this.updateUIClasses({mouse:oe.cursors.MOVE})};J.startOnActiveFeature=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),this.doRender(t.featureTarget.properties.id),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};J.clickOnFeature=function(e,t){Hr.disable(this),this.stopExtendedInteractions(e);const r=dt.isShiftDown(t),n=this.getSelectedIds(),o=t.featureTarget.properties.id,i=this.isSelected(o);if(!r&&i&&this.getFeature(o).type!==oe.geojsonTypes.POINT)return this.changeMode(oe.modes.DIRECT_SELECT,{featureId:o});i&&r?(this.deselect(o),this.updateUIClasses({mouse:oe.cursors.POINTER}),n.length===1&&Hr.enable(this)):!i&&r?(this.select(o),this.updateUIClasses({mouse:oe.cursors.MOVE})):!i&&!r&&(n.forEach(a=>this.doRender(a)),this.setSelected(o),this.updateUIClasses({mouse:oe.cursors.MOVE})),this.doRender(o)};J.onMouseDown=function(e,t){if(dt.isActiveFeature(t))return this.startOnActiveFeature(e,t);if(this.drawConfig.boxSelect&&dt.isShiftMousedown(t))return this.startBoxSelect(e,t)};J.startBoxSelect=function(e,t){this.stopExtendedInteractions(e),this.map.dragPan.disable(),e.boxSelectStartLocation=Ji(t.originalEvent,this.map.getContainer()),e.canBoxSelect=!0};J.onTouchStart=function(e,t){if(dt.isActiveFeature(t))return this.startOnActiveFeature(e,t)};J.onDrag=function(e,t){if(e.canDragMove)return this.dragMove(e,t);if(this.drawConfig.boxSelect&&e.canBoxSelect)return this.whileBoxSelect(e,t)};J.whileBoxSelect=function(e,t){e.boxSelecting=!0,this.updateUIClasses({mouse:oe.cursors.ADD}),e.boxSelectElement||(e.boxSelectElement=document.createElement("div"),e.boxSelectElement.classList.add(oe.classes.BOX_SELECT),this.map.getContainer().appendChild(e.boxSelectElement));const r=Ji(t.originalEvent,this.map.getContainer()),n=Math.min(e.boxSelectStartLocation.x,r.x),o=Math.max(e.boxSelectStartLocation.x,r.x),i=Math.min(e.boxSelectStartLocation.y,r.y),a=Math.max(e.boxSelectStartLocation.y,r.y),c=`translate(${n}px, ${i}px)`;e.boxSelectElement.style.transform=c,e.boxSelectElement.style.WebkitTransform=c,e.boxSelectElement.style.width=`${o-n}px`,e.boxSelectElement.style.height=`${a-i}px`};J.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};tT(this.getSelected(),r),e.dragMoveLocation=t.lngLat};J.onMouseUp=function(e,t){if(e.dragMoving)this.fireUpdate();else if(e.boxSelecting){const r=[e.boxSelectStartLocation,Ji(t.originalEvent,this.map.getContainer())],n=this.featuresAt(null,r,"click"),o=this.getUniqueIds(n).filter(i=>!this.isSelected(i));o.length&&(this.select(o),o.forEach(i=>this.doRender(i)),this.updateUIClasses({mouse:oe.cursors.MOVE}))}this.stopExtendedInteractions(e)};J.toDisplayFeatures=function(e,t,r){t.properties.active=this.isSelected(t.properties.id)?oe.activeStates.ACTIVE:oe.activeStates.INACTIVE,r(t),this.fireActionable(),!(t.properties.active!==oe.activeStates.ACTIVE||t.geometry.type===oe.geojsonTypes.POINT)&&Q0(t).forEach(r)};J.onTrash=function(){this.deleteFeature(this.getSelectedIds()),this.fireActionable()};J.onCombineFeatures=function(){const e=this.getSelected();if(e.length===0||e.length<2)return;const t=[],r=[],n=e[0].type.replace("Multi","");for(let o=0;o<e.length;o++){const i=e[o];if(i.type.replace("Multi","")!==n)return;i.type.includes("Multi")?i.getCoordinates().forEach(a=>{t.push(a)}):t.push(i.getCoordinates()),r.push(i.toGeoJSON())}if(r.length>1){const o=this.newFeature({type:oe.geojsonTypes.FEATURE,properties:r[0].properties,geometry:{type:`Multi${n}`,coordinates:t}});this.addFeature(o),this.deleteFeature(this.getSelectedIds(),{silent:!0}),this.setSelected([o.id]),this.map.fire(oe.events.COMBINE_FEATURES,{createdFeatures:[o.toGeoJSON()],deletedFeatures:r})}this.fireActionable()};J.onUncombineFeatures=function(){const e=this.getSelected();if(e.length===0)return;const t=[],r=[];for(let n=0;n<e.length;n++){const o=e[n];this.isInstanceOf("MultiFeature",o)&&(o.getFeatures().forEach(i=>{this.addFeature(i),i.properties=o.properties,t.push(i.toGeoJSON()),this.select([i.id])}),this.deleteFeature(o.id,{silent:!0}),r.push(o.toGeoJSON()))}t.length>1&&this.map.fire(oe.events.UNCOMBINE_FEATURES,{createdFeatures:t,deletedFeatures:r}),this.fireActionable()};var rT=J;const{noTarget:Bl,isOfMetaType:Dl,isInactiveFeature:Ul,isShiftDown:Gu}=Lt,nT=an,oT=Ki,kl=xt,ve=V,vn=Lt,iT=gn,jl=Dl(ve.meta.VERTEX),aT=Dl(ve.meta.MIDPOINT),z={};z.fireUpdate=function(){this.map.fire(ve.events.UPDATE,{action:ve.updateActions.CHANGE_COORDINATES,features:this.getSelected().map(e=>e.toGeoJSON())})};z.fireActionable=function(e){this.setActionableState({combineFeatures:!1,uncombineFeatures:!1,trash:e.selectedCoordPaths.length>0})};z.startDragging=function(e,t){this.map.dragPan.disable(),e.canDragMove=!0,e.dragMoveLocation=t.lngLat};z.stopDragging=function(e){this.map.dragPan.enable(),e.dragMoving=!1,e.canDragMove=!1,e.dragMoveLocation=null};z.onVertex=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties,n=e.selectedCoordPaths.indexOf(r.coord_path);!Gu(t)&&n===-1?e.selectedCoordPaths=[r.coord_path]:Gu(t)&&n===-1&&e.selectedCoordPaths.push(r.coord_path);const o=this.pathsToCoordinates(e.featureId,e.selectedCoordPaths);this.setSelectedCoordinates(o)};z.onMidpoint=function(e,t){this.startDragging(e,t);const r=t.featureTarget.properties;e.feature.addCoordinate(r.coord_path,r.lng,r.lat),this.fireUpdate(),e.selectedCoordPaths=[r.coord_path]};z.pathsToCoordinates=function(e,t){return t.map(r=>({feature_id:e,coord_path:r}))};z.onFeature=function(e,t){e.selectedCoordPaths.length===0?this.startDragging(e,t):this.stopDragging(e)};z.dragFeature=function(e,t,r){iT(this.getSelected(),r),e.dragMoveLocation=t.lngLat};z.dragVertex=function(e,t,r){const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:ve.geojsonTypes.FEATURE,properties:{},geometry:{type:ve.geojsonTypes.POINT,coordinates:a}})),i=oT(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}};z.clickNoTarget=function(){this.changeMode(ve.modes.SIMPLE_SELECT)};z.clickInactive=function(){this.changeMode(ve.modes.SIMPLE_SELECT)};z.clickActiveFeature=function(e){e.selectedCoordPaths=[],this.clearSelectedCoordinates(),e.feature.changed()};z.onSetup=function(e){const t=e.featureId,r=this.getFeature(t);if(!r)throw new Error("You must provide a featureId to enter direct_select mode");if(r.type===ve.geojsonTypes.POINT)throw new TypeError("direct_select mode doesn't handle point features");const n={featureId:t,feature:r,dragMoveLocation:e.startPos||null,dragMoving:!1,canDragMove:!1,selectedCoordPaths:e.coordPath?[e.coordPath]:[]};return this.setSelectedCoordinates(this.pathsToCoordinates(t,n.selectedCoordPaths)),this.setSelected(t),kl.disable(this),this.setActionableState({trash:!0}),n};z.onStop=function(){kl.enable(this),this.clearSelectedCoordinates()};z.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=ve.activeStates.ACTIVE,r(t),nT(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths}).forEach(r)):(t.properties.active=ve.activeStates.INACTIVE,r(t)),this.fireActionable(e)};z.onTrash=function(e){e.selectedCoordPaths.sort().reverse().forEach(t=>e.feature.removeCoordinate(t)),this.fireUpdate(),e.selectedCoordPaths=[],this.clearSelectedCoordinates(),this.fireActionable(e),e.feature.isValid()===!1&&(this.deleteFeature([e.featureId]),this.changeMode(ve.modes.SIMPLE_SELECT,{}))};z.onMouseMove=function(e,t){const r=vn.isActiveFeature(t),n=jl(t),o=e.selectedCoordPaths.length===0;r&&o?this.updateUIClasses({mouse:ve.cursors.MOVE}):n&&!o?this.updateUIClasses({mouse:ve.cursors.MOVE}):this.updateUIClasses({mouse:ve.cursors.NONE}),this.stopDragging(e)};z.onMouseOut=function(e){e.dragMoving&&this.fireUpdate()};z.onTouchStart=z.onMouseDown=function(e,t){if(jl(t))return this.onVertex(e,t);if(vn.isActiveFeature(t))return this.onFeature(e,t);if(aT(t))return this.onMidpoint(e,t)};z.onDrag=function(e,t){if(e.canDragMove!==!0)return;e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,r):this.dragFeature(e,t,r),e.dragMoveLocation=t.lngLat};z.onClick=function(e,t){if(Bl(t))return this.clickNoTarget(e,t);if(vn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ul(t))return this.clickInactive(e,t);this.stopDragging(e)};z.onTap=function(e,t){if(Bl(t))return this.clickNoTarget(e,t);if(vn.isActiveFeature(t))return this.clickActiveFeature(e,t);if(Ul(t))return this.clickInactive(e,t)};z.onTouchEnd=z.onMouseUp=function(e){e.dragMoving&&this.fireUpdate(),this.stopDragging(e)};var sT=z;const Vu=Lt,Ne=V,Be={};Be.onSetup=function(){const e=this.newFeature({type:Ne.geojsonTypes.FEATURE,properties:{},geometry:{type:Ne.geojsonTypes.POINT,coordinates:[]}});return this.addFeature(e),this.clearSelectedFeatures(),this.updateUIClasses({mouse:Ne.cursors.ADD}),this.activateUIButton(Ne.types.POINT),this.setActionableState({trash:!0}),{point:e}};Be.stopDrawingAndRemove=function(e){this.deleteFeature([e.point.id],{silent:!0}),this.changeMode(Ne.modes.SIMPLE_SELECT)};Be.onTap=Be.onClick=function(e,t){this.updateUIClasses({mouse:Ne.cursors.MOVE}),e.point.updateCoordinate("",t.lngLat.lng,t.lngLat.lat),this.map.fire(Ne.events.CREATE,{features:[e.point.toGeoJSON()]}),this.changeMode(Ne.modes.SIMPLE_SELECT,{featureIds:[e.point.id]})};Be.onStop=function(e){this.activateUIButton(),e.point.getCoordinate().length||this.deleteFeature([e.point.id],{silent:!0})};Be.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.point.id;if(t.properties.active=n?Ne.activeStates.ACTIVE:Ne.activeStates.INACTIVE,!n)return r(t)};Be.onTrash=Be.stopDrawingAndRemove;Be.onKeyUp=function(e,t){if(Vu.isEscapeKey(t)||Vu.isEnterKey(t))return this.stopDrawingAndRemove(e,t)};var uT=Be;function cT(e,t){return e.lngLat?e.lngLat.lng===t[0]&&e.lngLat.lat===t[1]:!1}var ql=cT;const Kr=Lt,Gl=xt,se=V,lT=ql,Wu=on,Oe={};Oe.onSetup=function(){const e=this.newFeature({type:se.geojsonTypes.FEATURE,properties:{},geometry:{type:se.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(e),this.clearSelectedFeatures(),Gl.disable(this),this.updateUIClasses({mouse:se.cursors.ADD}),this.activateUIButton(se.types.POLYGON),this.setActionableState({trash:!0}),{polygon:e,currentVertexPosition:0}};Oe.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&lT(t,e.polygon.coordinates[0][e.currentVertexPosition-1]))return this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]});this.updateUIClasses({mouse:se.cursors.ADD}),e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),e.currentVertexPosition++,e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat)};Oe.clickOnVertex=function(e){return this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Oe.onMouseMove=function(e,t){e.polygon.updateCoordinate(`0.${e.currentVertexPosition}`,t.lngLat.lng,t.lngLat.lat),Kr.isVertex(t)&&this.updateUIClasses({mouse:se.cursors.POINTER})};Oe.onTap=Oe.onClick=function(e,t){return Kr.isVertex(t)?this.clickOnVertex(e,t):this.clickAnywhere(e,t)};Oe.onKeyUp=function(e,t){Kr.isEscapeKey(t)?(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT)):Kr.isEnterKey(t)&&this.changeMode(se.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Oe.onStop=function(e){this.updateUIClasses({mouse:se.cursors.NONE}),Gl.enable(this),this.activateUIButton(),this.getFeature(e.polygon.id)!==void 0&&(e.polygon.removeCoordinate(`0.${e.currentVertexPosition}`),e.polygon.isValid()?this.map.fire(se.events.CREATE,{features:[e.polygon.toGeoJSON()]}):(this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT,{},{silent:!0})))};Oe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?se.activeStates.ACTIVE:se.activeStates.INACTIVE,!n)return r(t);if(t.geometry.coordinates.length===0)return;const o=t.geometry.coordinates[0].length;if(!(o<3)){if(t.properties.meta=se.meta.FEATURE,r(Wu(e.polygon.id,t.geometry.coordinates[0][0],"0.0",!1)),o>3){const i=t.geometry.coordinates[0].length-3;r(Wu(e.polygon.id,t.geometry.coordinates[0][i],`0.${i}`,!1))}if(o<=4){const i=[[t.geometry.coordinates[0][0][0],t.geometry.coordinates[0][0][1]],[t.geometry.coordinates[0][1][0],t.geometry.coordinates[0][1][1]]];if(r({type:se.geojsonTypes.FEATURE,properties:t.properties,geometry:{coordinates:i,type:se.geojsonTypes.LINE_STRING}}),o===3)return}return r(t)}};Oe.onTrash=function(e){this.deleteFeature([e.polygon.id],{silent:!0}),this.changeMode(se.modes.SIMPLE_SELECT)};var fT=Oe;const Jr=Lt,zu=ql,Vl=xt,he=V,pT=on,Fe={};Fe.onSetup=function(e){e=e||{};const t=e.featureId;let r,n,o="forward";if(t){if(r=this.getFeature(t),!r)throw new Error("Could not find a feature with the provided featureId");let i=e.from;if(i&&i.type==="Feature"&&i.geometry&&i.geometry.type==="Point"&&(i=i.geometry),i&&i.type==="Point"&&i.coordinates&&i.coordinates.length===2&&(i=i.coordinates),!i||!Array.isArray(i))throw new Error("Please use the `from` property to indicate which point to continue the line from");const a=r.coordinates.length-1;if(r.coordinates[a][0]===i[0]&&r.coordinates[a][1]===i[1])n=a+1,r.addCoordinate(n,...r.coordinates[a]);else if(r.coordinates[0][0]===i[0]&&r.coordinates[0][1]===i[1])o="backwards",n=0,r.addCoordinate(n,...r.coordinates[0]);else throw new Error("`from` should match the point at either the start or the end of the provided LineString")}else r=this.newFeature({type:he.geojsonTypes.FEATURE,properties:{},geometry:{type:he.geojsonTypes.LINE_STRING,coordinates:[]}}),n=0,this.addFeature(r);return this.clearSelectedFeatures(),Vl.disable(this),this.updateUIClasses({mouse:he.cursors.ADD}),this.activateUIButton(he.types.LINE),this.setActionableState({trash:!0}),{line:r,currentVertexPosition:n,direction:o}};Fe.clickAnywhere=function(e,t){if(e.currentVertexPosition>0&&zu(t,e.line.coordinates[e.currentVertexPosition-1])||e.direction==="backwards"&&zu(t,e.line.coordinates[e.currentVertexPosition+1]))return this.changeMode(he.modes.SIMPLE_SELECT,{featureIds:[e.line.id]});this.updateUIClasses({mouse:he.cursors.ADD}),e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),e.direction==="forward"?(e.currentVertexPosition++,e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat)):e.line.addCoordinate(0,t.lngLat.lng,t.lngLat.lat)};Fe.clickOnVertex=function(e){return this.changeMode(he.modes.SIMPLE_SELECT,{featureIds:[e.line.id]})};Fe.onMouseMove=function(e,t){e.line.updateCoordinate(e.currentVertexPosition,t.lngLat.lng,t.lngLat.lat),Jr.isVertex(t)&&this.updateUIClasses({mouse:he.cursors.POINTER})};Fe.onTap=Fe.onClick=function(e,t){if(Jr.isVertex(t))return this.clickOnVertex(e,t);this.clickAnywhere(e,t)};Fe.onKeyUp=function(e,t){Jr.isEnterKey(t)?this.changeMode(he.modes.SIMPLE_SELECT,{featureIds:[e.line.id]}):Jr.isEscapeKey(t)&&(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(he.modes.SIMPLE_SELECT))};Fe.onStop=function(e){Vl.enable(this),this.activateUIButton(),this.getFeature(e.line.id)!==void 0&&(e.line.removeCoordinate(`${e.currentVertexPosition}`),e.line.isValid()?this.map.fire(he.events.CREATE,{features:[e.line.toGeoJSON()]}):(this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(he.modes.SIMPLE_SELECT,{},{silent:!0})))};Fe.onTrash=function(e){this.deleteFeature([e.line.id],{silent:!0}),this.changeMode(he.modes.SIMPLE_SELECT)};Fe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.line.id;if(t.properties.active=n?he.activeStates.ACTIVE:he.activeStates.INACTIVE,!n)return r(t);t.geometry.coordinates.length<2||(t.properties.meta=he.meta.FEATURE,r(pT(e.line.id,t.geometry.coordinates[e.direction==="forward"?t.geometry.coordinates.length-2:1],`${e.direction==="forward"?t.geometry.coordinates.length-2:1}`,!1)),r(t))};var dT=Fe,Wl={simple_select:rT,direct_select:sT,draw_point:uT,draw_polygon:fT,draw_line_string:dT};const Qt=Ei,Si=V,hT={defaultMode:Si.modes.SIMPLE_SELECT,keybindings:!0,touchEnabled:!0,clickBuffer:2,touchBuffer:25,boxSelect:!0,displayControlsDefault:!0,styles:wd,modes:Wl,controls:{},userProperties:!1},yT={point:!0,line_string:!0,polygon:!0,trash:!0,combine_features:!0,uncombine_features:!0},gT={point:!1,line_string:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1};function Hu(e,t){return e.map(r=>r.source?r:Qt(r,{id:`${r.id}.${t}`,source:t==="hot"?Si.sources.HOT:Si.sources.COLD}))}var vT=function(e={}){let t=Qt(e);return e.controls||(t.controls={}),e.displayControlsDefault===!1?t.controls=Qt(gT,e.controls):t.controls=Qt(yT,e.controls),t=Qt(hT,t),t.styles=Hu(t.styles,"cold").concat(Hu(t.styles,"hot")),t},Yr={exports:{}};Yr.exports;(function(e,t){var r=200,n="__lodash_hash_undefined__",o=1,i=2,a=9007199254740991,c="[object Arguments]",u="[object Array]",y="[object AsyncFunction]",h="[object Boolean]",T="[object Date]",l="[object Error]",f="[object Function]",_="[object GeneratorFunction]",E="[object Map]",A="[object Number]",N="[object Null]",F="[object Object]",b="[object Promise]",w="[object Proxy]",$="[object RegExp]",L="[object Set]",C="[object String]",D="[object Symbol]",d="[object Undefined]",I="[object WeakMap]",g="[object ArrayBuffer]",v="[object DataView]",m="[object Float32Array]",P="[object Float64Array]",B="[object Int8Array]",H="[object Int16Array]",pe="[object Int32Array]",Se="[object Uint8Array]",Ue="[object Uint8ClampedArray]",qt="[object Uint16Array]",ae="[object Uint32Array]",x=/[\\^$.*+?()[\]{}|]/g,M=/^\[object .+?Constructor\]$/,G=/^(?:0|[1-9]\d*)$/,R={};R[m]=R[P]=R[B]=R[H]=R[pe]=R[Se]=R[Ue]=R[qt]=R[ae]=!0,R[c]=R[u]=R[g]=R[h]=R[v]=R[T]=R[l]=R[f]=R[E]=R[A]=R[F]=R[$]=R[L]=R[C]=R[I]=!1;var K=typeof window=="object"&&window&&window.Object===Object&&window,k=typeof self=="object"&&self&&self.Object===Object&&self,q=K||k||Function("return this")(),ye=t&&!t.nodeType&&t,ue=ye&&!0&&e&&!e.nodeType&&e,be=ue&&ue.exports===ye,ot=be&&K.process,Gt=function(){try{return ot&&ot.binding&&ot.binding("util")}catch{}}(),$e=Gt&&Gt.isTypedArray;function Vt(s,p){for(var S=-1,O=s==null?0:s.length,Y=0,U=[];++S<O;){var te=s[S];p(te,S,s)&&(U[Y++]=te)}return U}function Wt(s,p){for(var S=-1,O=p.length,Y=s.length;++S<O;)s[Y+S]=p[S];return s}function cr(s,p){for(var S=-1,O=s==null?0:s.length;++S<O;)if(p(s[S],S,s))return!0;return!1}function Tn(s,p){for(var S=-1,O=Array(s);++S<s;)O[S]=p(S);return O}function Xl(s){return function(p){return s(p)}}function Ql(s,p){return s.has(p)}function ef(s,p){return s==null?void 0:s[p]}function tf(s){var p=-1,S=Array(s.size);return s.forEach(function(O,Y){S[++p]=[Y,O]}),S}function rf(s,p){return function(S){return s(p(S))}}function nf(s){var p=-1,S=Array(s.size);return s.forEach(function(O){S[++p]=O}),S}var of=Array.prototype,af=Function.prototype,lr=Object.prototype,Sn=q["__core-js_shared__"],Qi=af.toString,Le=lr.hasOwnProperty,ea=function(){var s=/[^.]+$/.exec(Sn&&Sn.keys&&Sn.keys.IE_PROTO||"");return s?"Symbol(src)_1."+s:""}(),ta=lr.toString,sf=RegExp("^"+Qi.call(Le).replace(x,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ra=be?q.Buffer:void 0,fr=q.Symbol,na=q.Uint8Array,oa=lr.propertyIsEnumerable,uf=of.splice,it=fr?fr.toStringTag:void 0,ia=Object.getOwnPropertySymbols,cf=ra?ra.isBuffer:void 0,lf=rf(Object.keys,Object),_n=bt(q,"DataView"),zt=bt(q,"Map"),En=bt(q,"Promise"),wn=bt(q,"Set"),An=bt(q,"WeakMap"),Ht=bt(Object,"create"),ff=ut(_n),pf=ut(zt),df=ut(En),hf=ut(wn),yf=ut(An),aa=fr?fr.prototype:void 0,In=aa?aa.valueOf:void 0;function at(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function gf(){this.__data__=Ht?Ht(null):{},this.size=0}function vf(s){var p=this.has(s)&&delete this.__data__[s];return this.size-=p?1:0,p}function mf(s){var p=this.__data__;if(Ht){var S=p[s];return S===n?void 0:S}return Le.call(p,s)?p[s]:void 0}function bf(s){var p=this.__data__;return Ht?p[s]!==void 0:Le.call(p,s)}function Tf(s,p){var S=this.__data__;return this.size+=this.has(s)?0:1,S[s]=Ht&&p===void 0?n:p,this}at.prototype.clear=gf,at.prototype.delete=vf,at.prototype.get=mf,at.prototype.has=bf,at.prototype.set=Tf;function ke(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function Sf(){this.__data__=[],this.size=0}function _f(s){var p=this.__data__,S=dr(p,s);if(S<0)return!1;var O=p.length-1;return S==O?p.pop():uf.call(p,S,1),--this.size,!0}function Ef(s){var p=this.__data__,S=dr(p,s);return S<0?void 0:p[S][1]}function wf(s){return dr(this.__data__,s)>-1}function Af(s,p){var S=this.__data__,O=dr(S,s);return O<0?(++this.size,S.push([s,p])):S[O][1]=p,this}ke.prototype.clear=Sf,ke.prototype.delete=_f,ke.prototype.get=Ef,ke.prototype.has=wf,ke.prototype.set=Af;function st(s){var p=-1,S=s==null?0:s.length;for(this.clear();++p<S;){var O=s[p];this.set(O[0],O[1])}}function If(){this.size=0,this.__data__={hash:new at,map:new(zt||ke),string:new at}}function $f(s){var p=hr(this,s).delete(s);return this.size-=p?1:0,p}function Cf(s){return hr(this,s).get(s)}function Of(s){return hr(this,s).has(s)}function Ff(s,p){var S=hr(this,s),O=S.size;return S.set(s,p),this.size+=S.size==O?0:1,this}st.prototype.clear=If,st.prototype.delete=$f,st.prototype.get=Cf,st.prototype.has=Of,st.prototype.set=Ff;function pr(s){var p=-1,S=s==null?0:s.length;for(this.__data__=new st;++p<S;)this.add(s[p])}function Pf(s){return this.__data__.set(s,n),this}function Mf(s){return this.__data__.has(s)}pr.prototype.add=pr.prototype.push=Pf,pr.prototype.has=Mf;function He(s){var p=this.__data__=new ke(s);this.size=p.size}function Lf(){this.__data__=new ke,this.size=0}function xf(s){var p=this.__data__,S=p.delete(s);return this.size=p.size,S}function Rf(s){return this.__data__.get(s)}function Nf(s){return this.__data__.has(s)}function Bf(s,p){var S=this.__data__;if(S instanceof ke){var O=S.__data__;if(!zt||O.length<r-1)return O.push([s,p]),this.size=++S.size,this;S=this.__data__=new st(O)}return S.set(s,p),this.size=S.size,this}He.prototype.clear=Lf,He.prototype.delete=xf,He.prototype.get=Rf,He.prototype.has=Nf,He.prototype.set=Bf;function Df(s,p){var S=yr(s),O=!S&&Qf(s),Y=!S&&!O&&$n(s),U=!S&&!O&&!Y&&ya(s),te=S||O||Y||U,ce=te?Tn(s.length,String):[],fe=ce.length;for(var X in s)Le.call(s,X)&&!(te&&(X=="length"||Y&&(X=="offset"||X=="parent")||U&&(X=="buffer"||X=="byteLength"||X=="byteOffset")||Kf(X,fe)))&&ce.push(X);return ce}function dr(s,p){for(var S=s.length;S--;)if(fa(s[S][0],p))return S;return-1}function Uf(s,p,S){var O=p(s);return yr(s)?O:Wt(O,S(s))}function Kt(s){return s==null?s===void 0?d:N:it&&it in Object(s)?zf(s):Xf(s)}function sa(s){return Jt(s)&&Kt(s)==c}function ua(s,p,S,O,Y){return s===p?!0:s==null||p==null||!Jt(s)&&!Jt(p)?s!==s&&p!==p:kf(s,p,S,O,ua,Y)}function kf(s,p,S,O,Y,U){var te=yr(s),ce=yr(p),fe=te?u:Ke(s),X=ce?u:Ke(p);fe=fe==c?F:fe,X=X==c?F:X;var Te=fe==F,Ce=X==F,de=fe==X;if(de&&$n(s)){if(!$n(p))return!1;te=!0,Te=!1}if(de&&!Te)return U||(U=new He),te||ya(s)?ca(s,p,S,O,Y,U):Vf(s,p,fe,S,O,Y,U);if(!(S&o)){var _e=Te&&Le.call(s,"__wrapped__"),Ee=Ce&&Le.call(p,"__wrapped__");if(_e||Ee){var Je=_e?s.value():s,je=Ee?p.value():p;return U||(U=new He),Y(Je,je,S,O,U)}}return de?(U||(U=new He),Wf(s,p,S,O,Y,U)):!1}function jf(s){if(!ha(s)||Yf(s))return!1;var p=pa(s)?sf:M;return p.test(ut(s))}function qf(s){return Jt(s)&&da(s.length)&&!!R[Kt(s)]}function Gf(s){if(!Zf(s))return lf(s);var p=[];for(var S in Object(s))Le.call(s,S)&&S!="constructor"&&p.push(S);return p}function ca(s,p,S,O,Y,U){var te=S&o,ce=s.length,fe=p.length;if(ce!=fe&&!(te&&fe>ce))return!1;var X=U.get(s);if(X&&U.get(p))return X==p;var Te=-1,Ce=!0,de=S&i?new pr:void 0;for(U.set(s,p),U.set(p,s);++Te<ce;){var _e=s[Te],Ee=p[Te];if(O)var Je=te?O(Ee,_e,Te,p,s,U):O(_e,Ee,Te,s,p,U);if(Je!==void 0){if(Je)continue;Ce=!1;break}if(de){if(!cr(p,function(je,ct){if(!Ql(de,ct)&&(_e===je||Y(_e,je,S,O,U)))return de.push(ct)})){Ce=!1;break}}else if(!(_e===Ee||Y(_e,Ee,S,O,U))){Ce=!1;break}}return U.delete(s),U.delete(p),Ce}function Vf(s,p,S,O,Y,U,te){switch(S){case v:if(s.byteLength!=p.byteLength||s.byteOffset!=p.byteOffset)return!1;s=s.buffer,p=p.buffer;case g:return!(s.byteLength!=p.byteLength||!U(new na(s),new na(p)));case h:case T:case A:return fa(+s,+p);case l:return s.name==p.name&&s.message==p.message;case $:case C:return s==p+"";case E:var ce=tf;case L:var fe=O&o;if(ce||(ce=nf),s.size!=p.size&&!fe)return!1;var X=te.get(s);if(X)return X==p;O|=i,te.set(s,p);var Te=ca(ce(s),ce(p),O,Y,U,te);return te.delete(s),Te;case D:if(In)return In.call(s)==In.call(p)}return!1}function Wf(s,p,S,O,Y,U){var te=S&o,ce=la(s),fe=ce.length,X=la(p),Te=X.length;if(fe!=Te&&!te)return!1;for(var Ce=fe;Ce--;){var de=ce[Ce];if(!(te?de in p:Le.call(p,de)))return!1}var _e=U.get(s);if(_e&&U.get(p))return _e==p;var Ee=!0;U.set(s,p),U.set(p,s);for(var Je=te;++Ce<fe;){de=ce[Ce];var je=s[de],ct=p[de];if(O)var ga=te?O(ct,je,de,p,s,U):O(je,ct,de,s,p,U);if(!(ga===void 0?je===ct||Y(je,ct,S,O,U):ga)){Ee=!1;break}Je||(Je=de=="constructor")}if(Ee&&!Je){var gr=s.constructor,vr=p.constructor;gr!=vr&&"constructor"in s&&"constructor"in p&&!(typeof gr=="function"&&gr instanceof gr&&typeof vr=="function"&&vr instanceof vr)&&(Ee=!1)}return U.delete(s),U.delete(p),Ee}function la(s){return Uf(s,rp,Hf)}function hr(s,p){var S=s.__data__;return Jf(p)?S[typeof p=="string"?"string":"hash"]:S.map}function bt(s,p){var S=ef(s,p);return jf(S)?S:void 0}function zf(s){var p=Le.call(s,it),S=s[it];try{s[it]=void 0;var O=!0}catch{}var Y=ta.call(s);return O&&(p?s[it]=S:delete s[it]),Y}var Hf=ia?function(s){return s==null?[]:(s=Object(s),Vt(ia(s),function(p){return oa.call(s,p)}))}:np,Ke=Kt;(_n&&Ke(new _n(new ArrayBuffer(1)))!=v||zt&&Ke(new zt)!=E||En&&Ke(En.resolve())!=b||wn&&Ke(new wn)!=L||An&&Ke(new An)!=I)&&(Ke=function(s){var p=Kt(s),S=p==F?s.constructor:void 0,O=S?ut(S):"";if(O)switch(O){case ff:return v;case pf:return E;case df:return b;case hf:return L;case yf:return I}return p});function Kf(s,p){return p=p??a,!!p&&(typeof s=="number"||G.test(s))&&s>-1&&s%1==0&&s<p}function Jf(s){var p=typeof s;return p=="string"||p=="number"||p=="symbol"||p=="boolean"?s!=="__proto__":s===null}function Yf(s){return!!ea&&ea in s}function Zf(s){var p=s&&s.constructor,S=typeof p=="function"&&p.prototype||lr;return s===S}function Xf(s){return ta.call(s)}function ut(s){if(s!=null){try{return Qi.call(s)}catch{}try{return s+""}catch{}}return""}function fa(s,p){return s===p||s!==s&&p!==p}var Qf=sa(function(){return arguments}())?sa:function(s){return Jt(s)&&Le.call(s,"callee")&&!oa.call(s,"callee")},yr=Array.isArray;function ep(s){return s!=null&&da(s.length)&&!pa(s)}var $n=cf||op;function tp(s,p){return ua(s,p)}function pa(s){if(!ha(s))return!1;var p=Kt(s);return p==f||p==_||p==y||p==w}function da(s){return typeof s=="number"&&s>-1&&s%1==0&&s<=a}function ha(s){var p=typeof s;return s!=null&&(p=="object"||p=="function")}function Jt(s){return s!=null&&typeof s=="object"}var ya=$e?Xl($e):qf;function rp(s){return ep(s)?Df(s):Gf(s)}function np(){return[]}function op(){return!1}e.exports=tp})(Yr,Yr.exports);var mT=Yr.exports,bT=function(e,t){return e.length!==t.length?!1:JSON.stringify(e.map(r=>r).sort())===JSON.stringify(t.map(r=>r).sort())},zl={},_i={exports:{}};(function(e,t){var r={env:{},argv:[]},n=function(){var o=function(F,b,w,$){for(w=w||{},$=F.length;$--;w[F[$]]=b);return w},i=[1,12],a=[1,13],c=[1,9],u=[1,10],y=[1,11],h=[1,14],T=[1,15],l=[14,18,22,24],f=[18,22],_=[22,24],E={trace:function(){},yy:{},symbols_:{error:2,JSONString:3,STRING:4,JSONNumber:5,NUMBER:6,JSONNullLiteral:7,NULL:8,JSONBooleanLiteral:9,TRUE:10,FALSE:11,JSONText:12,JSONValue:13,EOF:14,JSONObject:15,JSONArray:16,"{":17,"}":18,JSONMemberList:19,JSONMember:20,":":21,",":22,"[":23,"]":24,JSONElementList:25,$accept:0,$end:1},terminals_:{2:"error",4:"STRING",6:"NUMBER",8:"NULL",10:"TRUE",11:"FALSE",14:"EOF",17:"{",18:"}",21:":",22:",",23:"[",24:"]"},productions_:[0,[3,1],[5,1],[7,1],[9,1],[9,1],[12,2],[13,1],[13,1],[13,1],[13,1],[13,1],[13,1],[15,2],[15,3],[20,3],[19,1],[19,3],[16,2],[16,3],[25,1],[25,3]],performAction:function(b,w,$,L,C,D,d){var I=D.length-1;switch(C){case 1:this.$=b.replace(/\\(\\|")/g,"$1").replace(/\\n/g,`
`).replace(/\\r/g,"\r").replace(/\\t/g,"	").replace(/\\v/g,"\v").replace(/\\f/g,"\f").replace(/\\b/g,"\b");break;case 2:this.$=Number(b);break;case 3:this.$=null;break;case 4:this.$=!0;break;case 5:this.$=!1;break;case 6:return this.$=D[I-1];case 13:this.$={},Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 14:case 19:this.$=D[I-1],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 15:this.$=[D[I-2],D[I]];break;case 16:this.$={},this.$[D[I][0]]=D[I][1];break;case 17:this.$=D[I-2],D[I-2][D[I][0]]!==void 0&&(this.$.__duplicateProperties__||Object.defineProperty(this.$,"__duplicateProperties__",{value:[],enumerable:!1}),this.$.__duplicateProperties__.push(D[I][0])),D[I-2][D[I][0]]=D[I][1];break;case 18:this.$=[],Object.defineProperty(this.$,"__line__",{value:this._$.first_line,enumerable:!1});break;case 20:this.$=[D[I]];break;case 21:this.$=D[I-2],D[I-2].push(D[I]);break}},table:[{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,12:1,13:2,15:7,16:8,17:h,23:T},{1:[3]},{14:[1,16]},o(l,[2,7]),o(l,[2,8]),o(l,[2,9]),o(l,[2,10]),o(l,[2,11]),o(l,[2,12]),o(l,[2,3]),o(l,[2,4]),o(l,[2,5]),o([14,18,21,22,24],[2,1]),o(l,[2,2]),{3:20,4:i,18:[1,17],19:18,20:19},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:23,15:7,16:8,17:h,23:T,24:[1,21],25:22},{1:[2,6]},o(l,[2,13]),{18:[1,24],22:[1,25]},o(f,[2,16]),{21:[1,26]},o(l,[2,18]),{22:[1,28],24:[1,27]},o(_,[2,20]),o(l,[2,14]),{3:20,4:i,20:29},{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:30,15:7,16:8,17:h,23:T},o(l,[2,19]),{3:5,4:i,5:6,6:a,7:3,8:c,9:4,10:u,11:y,13:31,15:7,16:8,17:h,23:T},o(f,[2,17]),o(f,[2,15]),o(_,[2,21])],defaultActions:{16:[2,6]},parseError:function(b,w){if(w.recoverable)this.trace(b);else{let $=function(L,C){this.message=L,this.hash=C};throw $.prototype=Error,new $(b,w)}},parse:function(b){var w=this,$=[0],L=[null],C=[],D=this.table,d="",I=0,g=0,v=2,m=1,P=C.slice.call(arguments,1),B=Object.create(this.lexer),H={yy:{}};for(var pe in this.yy)Object.prototype.hasOwnProperty.call(this.yy,pe)&&(H.yy[pe]=this.yy[pe]);B.setInput(b,H.yy),H.yy.lexer=B,H.yy.parser=this,typeof B.yylloc>"u"&&(B.yylloc={});var Se=B.yylloc;C.push(Se);var Ue=B.options&&B.options.ranges;typeof H.yy.parseError=="function"?this.parseError=H.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var qt=function(){var be;return be=B.lex()||m,typeof be!="number"&&(be=w.symbols_[be]||be),be},ae,x,M,G,R={},K,k,q,ye;;){if(x=$[$.length-1],this.defaultActions[x]?M=this.defaultActions[x]:((ae===null||typeof ae>"u")&&(ae=qt()),M=D[x]&&D[x][ae]),typeof M>"u"||!M.length||!M[0]){var ue="";ye=[];for(K in D[x])this.terminals_[K]&&K>v&&ye.push("'"+this.terminals_[K]+"'");B.showPosition?ue="Parse error on line "+(I+1)+`:
`+B.showPosition()+`
Expecting `+ye.join(", ")+", got '"+(this.terminals_[ae]||ae)+"'":ue="Parse error on line "+(I+1)+": Unexpected "+(ae==m?"end of input":"'"+(this.terminals_[ae]||ae)+"'"),this.parseError(ue,{text:B.match,token:this.terminals_[ae]||ae,line:B.yylineno,loc:Se,expected:ye})}if(M[0]instanceof Array&&M.length>1)throw new Error("Parse Error: multiple actions possible at state: "+x+", token: "+ae);switch(M[0]){case 1:$.push(ae),L.push(B.yytext),C.push(B.yylloc),$.push(M[1]),ae=null,g=B.yyleng,d=B.yytext,I=B.yylineno,Se=B.yylloc;break;case 2:if(k=this.productions_[M[1]][1],R.$=L[L.length-k],R._$={first_line:C[C.length-(k||1)].first_line,last_line:C[C.length-1].last_line,first_column:C[C.length-(k||1)].first_column,last_column:C[C.length-1].last_column},Ue&&(R._$.range=[C[C.length-(k||1)].range[0],C[C.length-1].range[1]]),G=this.performAction.apply(R,[d,g,I,H.yy,M[1],L,C].concat(P)),typeof G<"u")return G;k&&($=$.slice(0,-1*k*2),L=L.slice(0,-1*k),C=C.slice(0,-1*k)),$.push(this.productions_[M[1]][0]),L.push(R.$),C.push(R._$),q=D[$[$.length-2]][$[$.length-1]],$.push(q);break;case 3:return!0}}return!0}},A=function(){var F={EOF:1,parseError:function(w,$){if(this.yy.parser)this.yy.parser.parseError(w,$);else throw new Error(w)},setInput:function(b,w){return this.yy=w||this.yy||{},this._input=b,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var b=this._input[0];this.yytext+=b,this.yyleng++,this.offset++,this.match+=b,this.matched+=b;var w=b.match(/(?:\r\n?|\n).*/g);return w?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),b},unput:function(b){var w=b.length,$=b.split(/(?:\r\n?|\n)/g);this._input=b+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-w),this.offset-=w;var L=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),$.length-1&&(this.yylineno-=$.length-1);var C=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:$?($.length===L.length?this.yylloc.first_column:0)+L[L.length-$.length].length-$[0].length:this.yylloc.first_column-w},this.options.ranges&&(this.yylloc.range=[C[0],C[0]+this.yyleng-w]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){if(this.options.backtrack_lexer)this._backtrack=!0;else return this.parseError("Lexical error on line "+(this.yylineno+1)+`. You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).
`+this.showPosition(),{text:"",token:null,line:this.yylineno});return this},less:function(b){this.unput(this.match.slice(b))},pastInput:function(){var b=this.matched.substr(0,this.matched.length-this.match.length);return(b.length>20?"...":"")+b.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var b=this.match;return b.length<20&&(b+=this._input.substr(0,20-b.length)),(b.substr(0,20)+(b.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var b=this.pastInput(),w=new Array(b.length+1).join("-");return b+this.upcomingInput()+`
`+w+"^"},test_match:function(b,w){var $,L,C;if(this.options.backtrack_lexer&&(C={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(C.yylloc.range=this.yylloc.range.slice(0))),L=b[0].match(/(?:\r\n?|\n).*/g),L&&(this.yylineno+=L.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:L?L[L.length-1].length-L[L.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+b[0].length},this.yytext+=b[0],this.match+=b[0],this.matches=b,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(b[0].length),this.matched+=b[0],$=this.performAction.call(this,this.yy,this,w,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),$)return $;if(this._backtrack){for(var D in C)this[D]=C[D];return!1}return!1},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var b,w,$,L;this._more||(this.yytext="",this.match="");for(var C=this._currentRules(),D=0;D<C.length;D++)if($=this._input.match(this.rules[C[D]]),$&&(!w||$[0].length>w[0].length)){if(w=$,L=D,this.options.backtrack_lexer){if(b=this.test_match($,C[D]),b!==!1)return b;if(this._backtrack){w=!1;continue}else return!1}else if(!this.options.flex)break}return w?(b=this.test_match(w,C[L]),b!==!1?b:!1):this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+`. Unrecognized text.
`+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var w=this.next();return w||this.lex()},begin:function(w){this.conditionStack.push(w)},popState:function(){var w=this.conditionStack.length-1;return w>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(w){return w=this.conditionStack.length-1-Math.abs(w||0),w>=0?this.conditionStack[w]:"INITIAL"},pushState:function(w){this.begin(w)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(w,$,L,C){switch(L){case 0:break;case 1:return 6;case 2:return $.yytext=$.yytext.substr(1,$.yyleng-2),4;case 3:return 17;case 4:return 18;case 5:return 23;case 6:return 24;case 7:return 22;case 8:return 21;case 9:return 10;case 10:return 11;case 11:return 8;case 12:return 14;case 13:return"INVALID"}},rules:[/^(?:\s+)/,/^(?:(-?([0-9]|[1-9][0-9]+))(\.[0-9]+)?([eE][-+]?[0-9]+)?\b)/,/^(?:"(?:\\[\\"bfnrt\/]|\\u[a-fA-F0-9]{4}|[^\\\0-\x09\x0a-\x1f"])*")/,/^(?:\{)/,/^(?:\})/,/^(?:\[)/,/^(?:\])/,/^(?:,)/,/^(?::)/,/^(?:true\b)/,/^(?:false\b)/,/^(?:null\b)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6,7,8,9,10,11,12,13],inclusive:!0}}};return F}();E.lexer=A;function N(){this.yy={}}return N.prototype=E,E.Parser=N,new N}();typeof Ap<"u"&&(t.parser=n,t.Parser=n.Parser,t.parse=function(){return n.parse.apply(n,arguments)},t.main=function(i){i[1]||(console.log("Usage: "+i[0]+" FILE"),r.exit(1));var a=ui.readFileSync(ui.normalize(i[1]),"utf8");return t.parser.parse(a)},require.main===e&&t.main(r.argv.slice(1)))})(_i,_i.exports);var TT=_i.exports,Hl={};function ti(e){return e*Math.PI/180}function Ku(e){var t=0;if(e.length>2)for(var r,n,o=0;o<e.length-1;o++)r=e[o],n=e[o+1],t+=ti(n[0]-r[0])*(2+Math.sin(ti(r[1]))+Math.sin(ti(n[1])));return t>=0}function Ju(e){if(e&&e.length>0){if(Ku(e[0]))return!1;var t=e.slice(1,e.length);if(!t.every(Ku))return!1}return!0}function ST(e){if(e.type==="Polygon")return Ju(e.coordinates);if(e.type==="MultiPolygon")return e.coordinates.every(Ju)}var _T=function(t,r){ST(t)||r.push({message:"Polygons and MultiPolygons should follow the right-hand rule",level:"message",line:t.__line__})},Yu=_T;function ET(e,t){var r=[],n=0,o=10,i=6;function a(d){if((!t||t.noDuplicateMembers!==!1)&&d.__duplicateProperties__&&r.push({message:"An object contained duplicate members, making parsing ambigous: "+d.__duplicateProperties__.join(", "),line:d.__line__}),!u(d,"type","string"))if(C[d.type])d&&C[d.type](d);else{var I=D[d.type.toLowerCase()];I!==void 0?r.push({message:"Expected "+I+" but got "+d.type+" (case sensitive)",line:d.__line__}):r.push({message:"The type "+d.type+" is unknown",line:d.__line__})}}function c(d,I){return d.every(function(g){return g!==null&&typeof g===I})}function u(d,I,g){if(typeof d[I]>"u")return r.push({message:'"'+I+'" member required',line:d.__line__});if(g==="array"){if(!Array.isArray(d[I]))return r.push({message:'"'+I+'" member should be an array, but is an '+typeof d[I]+" instead",line:d.__line__})}else{if(g==="object"&&d[I]&&d[I].constructor!==Object)return r.push({message:'"'+I+'" member should be '+g+", but is an "+d[I].constructor.name+" instead",line:d.__line__});if(g&&typeof d[I]!==g)return r.push({message:'"'+I+'" member should be '+g+", but is an "+typeof d[I]+" instead",line:d.__line__})}}function y(d){if(l(d),f(d),d.properties!==void 0&&r.push({message:'FeatureCollection object cannot contain a "properties" member',line:d.__line__}),d.coordinates!==void 0&&r.push({message:'FeatureCollection object cannot contain a "coordinates" member',line:d.__line__}),!u(d,"features","array")){if(!c(d.features,"object"))return r.push({message:"Every feature must be an object",line:d.__line__});d.features.forEach(L)}}function h(d,I){if(!Array.isArray(d))return r.push({message:"position should be an array, is a "+typeof d+" instead",line:d.__line__||I});if(d.length<2)return r.push({message:"position must have 2 or more elements",line:d.__line__||I});if(d.length>3)return r.push({message:"position should not have more than 3 elements",level:"message",line:d.__line__||I});if(!c(d,"number"))return r.push({message:"each element in a position must be a number",line:d.__line__||I});if(t&&t.precisionWarning){if(n===o)return n+=1,r.push({message:"truncated warnings: we've encountered coordinate precision warning "+o+" times, no more warnings will be reported",level:"message",line:d.__line__||I});n<o&&d.forEach(function(g){var v=0,m=String(g).split(".")[1];if(m!==void 0&&(v=m.length),v>i)return n+=1,r.push({message:"precision of coordinates should be reduced",level:"message",line:d.__line__||I})})}}function T(d,I,g,v){if(v===void 0&&d.__line__!==void 0&&(v=d.__line__),g===0)return h(d,v);if(g===1&&I){if(I==="LinearRing"){if(!Array.isArray(d[d.length-1]))return r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v}),!0;if(d.length<4&&r.push({message:"a LinearRing of coordinates needs to have four or more positions",line:v}),d.length&&(d[d.length-1].length!==d[0].length||!d[d.length-1].every(function(P,B){return d[0][B]===P})))return r.push({message:"the first and last positions in a LinearRing of coordinates must be the same",line:v}),!0}else if(I==="Line"&&d.length<2)return r.push({message:"a line needs to have two or more coordinates to be valid",line:v})}if(!Array.isArray(d))r.push({message:"a number was found where a coordinate array should have been found: this needs to be nested more deeply",line:v});else{var m=d.map(function(P){return T(P,I,g-1,P.__line__||v)});return m.some(function(P){return P})}}function l(d){if(d.crs){var I="urn:ogc:def:crs:OGC:1.3:CRS84";typeof d.crs=="object"&&d.crs.properties&&d.crs.properties.name===I?r.push({message:"old-style crs member is not recommended, this object is equivalent to the default and should be removed",line:d.__line__}):r.push({message:"old-style crs member is not recommended",line:d.__line__})}}function f(d){if(d.bbox){if(Array.isArray(d.bbox))return c(d.bbox,"number")||r.push({message:"each element in a bbox member must be a number",line:d.bbox.__line__}),d.bbox.length===4||d.bbox.length===6||r.push({message:"bbox must contain 4 elements (for 2D) or 6 elements (for 3D)",line:d.bbox.__line__}),r.length;r.push({message:"bbox member must be an array of numbers, but is a "+typeof d.bbox,line:d.__line__})}}function _(d){d.properties!==void 0&&r.push({message:'geometry object cannot contain a "properties" member',line:d.__line__}),d.geometry!==void 0&&r.push({message:'geometry object cannot contain a "geometry" member',line:d.__line__}),d.features!==void 0&&r.push({message:'geometry object cannot contain a "features" member',line:d.__line__})}function E(d){l(d),f(d),_(d),u(d,"coordinates","array")||h(d.coordinates)}function A(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"LinearRing",2)||Yu(d,r)}function N(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"LinearRing",3)||Yu(d,r)}function F(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"Line",1)}function b(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"Line",2)}function w(d){l(d),f(d),u(d,"coordinates","array")||T(d.coordinates,"",1)}function $(d){l(d),f(d),u(d,"geometries","array")||(c(d.geometries,"object")||r.push({message:"The geometries array in a GeometryCollection must contain only geometry objects",line:d.__line__}),d.geometries.length===1&&r.push({message:"GeometryCollection with a single geometry should be avoided in favor of single part or a single object of multi-part type",line:d.geometries.__line__}),d.geometries.forEach(function(I){I&&(I.type==="GeometryCollection"&&r.push({message:"GeometryCollection should avoid nested geometry collections",line:d.geometries.__line__}),a(I))}))}function L(d){l(d),f(d),d.id!==void 0&&typeof d.id!="string"&&typeof d.id!="number"&&r.push({message:'Feature "id" member must have a string or number value',line:d.__line__}),d.features!==void 0&&r.push({message:'Feature object cannot contain a "features" member',line:d.__line__}),d.coordinates!==void 0&&r.push({message:'Feature object cannot contain a "coordinates" member',line:d.__line__}),d.type!=="Feature"&&r.push({message:"GeoJSON features must have a type=feature member",line:d.__line__}),u(d,"properties","object"),u(d,"geometry","object")||d.geometry&&a(d.geometry)}var C={Point:E,Feature:L,MultiPoint:w,LineString:F,MultiLineString:b,FeatureCollection:y,GeometryCollection:$,Polygon:A,MultiPolygon:N},D=Object.keys(C).reduce(function(d,I){return d[I.toLowerCase()]=I,d},{});return typeof e!="object"||e===null||e===void 0?(r.push({message:"The root of a GeoJSON object must be an object.",line:0}),r):(a(e),r.forEach(function(d){({}).hasOwnProperty.call(d,"line")&&d.line===void 0&&delete d.line}),r)}Hl.hint=ET;var wT=TT,AT=Hl;function IT(e,t){var r,n=[];if(typeof e=="object")r=e;else if(typeof e=="string")try{r=wT.parse(e)}catch(a){var o=a.message.match(/line (\d+)/),i=parseInt(o[1],10);return[{line:i-1,message:a.message,error:a}]}else return[{message:"Expected string or object as input",line:0}];return n=n.concat(AT.hint(r,t)),n}zl.hint=IT;const $T=mT,CT=Qu,OT=$i,FT=en,PT=bT,MT=zl,ge=V,LT=Qr,xT={Polygon:Fi,LineString:Oi,Point:Ci,MultiPolygon:Lr,MultiLineString:Lr,MultiPoint:Lr};var RT=function(e,t){return t.modes=ge.modes,t.getFeatureIdsAt=function(r){return FT.click({point:r},null,e).map(o=>o.properties.id)},t.getSelectedIds=function(){return e.store.getSelectedIds()},t.getSelected=function(){return{type:ge.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedIds().map(r=>e.store.get(r)).map(r=>r.toGeoJSON())}},t.getSelectedPoints=function(){return{type:ge.geojsonTypes.FEATURE_COLLECTION,features:e.store.getSelectedCoordinates().map(r=>({type:ge.geojsonTypes.FEATURE,properties:{},geometry:{type:ge.geojsonTypes.POINT,coordinates:r.coordinates}}))}},t.set=function(r){if(r.type===void 0||r.type!==ge.geojsonTypes.FEATURE_COLLECTION||!Array.isArray(r.features))throw new Error("Invalid FeatureCollection");const n=e.store.createRenderBatch();let o=e.store.getAllIds().slice();const i=t.add(r),a=new LT(i);return o=o.filter(c=>!a.has(c)),o.length&&t.delete(o),n(),i},t.add=function(r){const n=MT.hint(r,{precisionWarning:!1}).filter(a=>a.level!=="message");if(n.length)throw new Error(n[0].message);const i=JSON.parse(JSON.stringify(CT(r))).features.map(a=>{if(a.id=a.id||OT(),a.geometry===null)throw new Error("Invalid geometry: null");if(e.store.get(a.id)===void 0||e.store.get(a.id).type!==a.geometry.type){const c=xT[a.geometry.type];if(c===void 0)throw new Error(`Invalid geometry type: ${a.geometry.type}.`);const u=new c(e,a);e.store.add(u)}else{const c=e.store.get(a.id);c.properties=a.properties,$T(c.getCoordinates(),a.geometry.coordinates)||c.incomingCoords(a.geometry.coordinates)}return a.id});return e.store.render(),i},t.get=function(r){const n=e.store.get(r);if(n)return n.toGeoJSON()},t.getAll=function(){return{type:ge.geojsonTypes.FEATURE_COLLECTION,features:e.store.getAll().map(r=>r.toGeoJSON())}},t.delete=function(r){return e.store.delete(r,{silent:!0}),t.getMode()===ge.modes.DIRECT_SELECT&&!e.store.getSelectedIds().length?e.events.changeMode(ge.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.deleteAll=function(){return e.store.delete(e.store.getAllIds(),{silent:!0}),t.getMode()===ge.modes.DIRECT_SELECT?e.events.changeMode(ge.modes.SIMPLE_SELECT,void 0,{silent:!0}):e.store.render(),t},t.changeMode=function(r,n={}){return r===ge.modes.SIMPLE_SELECT&&t.getMode()===ge.modes.SIMPLE_SELECT?(PT(n.featureIds||[],e.store.getSelectedIds())||(e.store.setSelected(n.featureIds,{silent:!0}),e.store.render()),t):(r===ge.modes.DIRECT_SELECT&&t.getMode()===ge.modes.DIRECT_SELECT&&n.featureId===e.store.getSelectedIds()[0]||e.events.changeMode(r,n,{silent:!0}),t)},t.getMode=function(){return e.events.getMode()},t.trash=function(){return e.events.trash({silent:!0}),t},t.combineFeatures=function(){return e.events.combineFeatures({silent:!0}),t},t.uncombineFeatures=function(){return e.events.uncombineFeatures({silent:!0}),t},t.setFeatureProperty=function(r,n,o){return e.store.setFeatureProperty(r,n,o),t},t};const NT=Ed,BT=vT,DT=RT,UT=V,kT=function(e,t){e=BT(e);const r={options:e};t=DT(r,t),r.api=t;const n=NT(r);return t.onAdd=n.onAdd,t.onRemove=n.onRemove,t.types=UT.types,t.options=e,t};Ii.exports=function(e){kT(e,this)};Ii.exports.modes=Wl;var mn=Ii.exports;const Yi=wi(_p),jT=mn,er=V,qT=xt,GT=Yi.default,Kl={...jT.modes.draw_polygon},VT=2;Kl.onSetup=function(e){const t=this.newFeature({type:er.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:er.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),qT.disable(this),this.updateUIClasses({mouse:er.cursors.ADD}),this.activateUIButton(er.types.POLYGON),this.setActionableState({trash:!0}),{initialRadiusInKm:e.initialRadiusInKm||VT,polygon:t,currentVertexPosition:0}};Kl.clickAnywhere=function(e,t){if(e.currentVertexPosition===0){e.currentVertexPosition++;const r=[t.lngLat.lng,t.lngLat.lat],n=GT(r,e.initialRadiusInKm);e.polygon.incomingCoords(n.geometry.coordinates),e.polygon.properties.center=r,e.polygon.properties.radiusInKm=e.initialRadiusInKm}return this.changeMode(er.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};var WT={enable(e){setTimeout(()=>{!e.map||!e.map.dragPan||!e._ctx||!e._ctx.store||!e._ctx.store.getInitialConfigValue||e._ctx.store.getInitialConfigValue("dragPan")&&e.map.dragPan.enable()},0)},disable(e){setTimeout(()=>{!e.map||!e.map.doubleClickZoom||e.map.dragPan.disable()},0)}};const Jl=wi(Ep);var Zi={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.earthRadius=63710088e-1,e.factors={centimeters:e.earthRadius*100,centimetres:e.earthRadius*100,degrees:e.earthRadius/111325,feet:e.earthRadius*3.28084,inches:e.earthRadius*39.37,kilometers:e.earthRadius/1e3,kilometres:e.earthRadius/1e3,meters:e.earthRadius,metres:e.earthRadius,miles:e.earthRadius/1609.344,millimeters:e.earthRadius*1e3,millimetres:e.earthRadius*1e3,nauticalmiles:e.earthRadius/1852,radians:1,yards:e.earthRadius*1.0936},e.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/e.earthRadius,yards:1.0936133},e.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046};function t(g,v,m){m===void 0&&(m={});var P={type:"Feature"};return(m.id===0||m.id)&&(P.id=m.id),m.bbox&&(P.bbox=m.bbox),P.properties=v||{},P.geometry=g,P}e.feature=t;function r(g,v,m){switch(g){case"Point":return n(v).geometry;case"LineString":return c(v).geometry;case"Polygon":return i(v).geometry;case"MultiPoint":return T(v).geometry;case"MultiLineString":return h(v).geometry;case"MultiPolygon":return l(v).geometry;default:throw new Error(g+" is invalid")}}e.geometry=r;function n(g,v,m){if(m===void 0&&(m={}),!g)throw new Error("coordinates is required");if(!Array.isArray(g))throw new Error("coordinates must be an Array");if(g.length<2)throw new Error("coordinates must be at least 2 numbers long");if(!C(g[0])||!C(g[1]))throw new Error("coordinates must contain numbers");var P={type:"Point",coordinates:g};return t(P,v,m)}e.point=n;function o(g,v,m){return m===void 0&&(m={}),y(g.map(function(P){return n(P,v)}),m)}e.points=o;function i(g,v,m){m===void 0&&(m={});for(var P=0,B=g;P<B.length;P++){var H=B[P];if(H.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var pe=0;pe<H[H.length-1].length;pe++)if(H[H.length-1][pe]!==H[0][pe])throw new Error("First and last Position are not equivalent.")}var Se={type:"Polygon",coordinates:g};return t(Se,v,m)}e.polygon=i;function a(g,v,m){return m===void 0&&(m={}),y(g.map(function(P){return i(P,v)}),m)}e.polygons=a;function c(g,v,m){if(m===void 0&&(m={}),g.length<2)throw new Error("coordinates must be an array of two or more positions");var P={type:"LineString",coordinates:g};return t(P,v,m)}e.lineString=c;function u(g,v,m){return m===void 0&&(m={}),y(g.map(function(P){return c(P,v)}),m)}e.lineStrings=u;function y(g,v){v===void 0&&(v={});var m={type:"FeatureCollection"};return v.id&&(m.id=v.id),v.bbox&&(m.bbox=v.bbox),m.features=g,m}e.featureCollection=y;function h(g,v,m){m===void 0&&(m={});var P={type:"MultiLineString",coordinates:g};return t(P,v,m)}e.multiLineString=h;function T(g,v,m){m===void 0&&(m={});var P={type:"MultiPoint",coordinates:g};return t(P,v,m)}e.multiPoint=T;function l(g,v,m){m===void 0&&(m={});var P={type:"MultiPolygon",coordinates:g};return t(P,v,m)}e.multiPolygon=l;function f(g,v,m){m===void 0&&(m={});var P={type:"GeometryCollection",geometries:g};return t(P,v,m)}e.geometryCollection=f;function _(g,v){if(v===void 0&&(v=0),v&&!(v>=0))throw new Error("precision must be a positive number");var m=Math.pow(10,v||0);return Math.round(g*m)/m}e.round=_;function E(g,v){v===void 0&&(v="kilometers");var m=e.factors[v];if(!m)throw new Error(v+" units is invalid");return g*m}e.radiansToLength=E;function A(g,v){v===void 0&&(v="kilometers");var m=e.factors[v];if(!m)throw new Error(v+" units is invalid");return g/m}e.lengthToRadians=A;function N(g,v){return b(A(g,v))}e.lengthToDegrees=N;function F(g){var v=g%360;return v<0&&(v+=360),v}e.bearingToAzimuth=F;function b(g){var v=g%(2*Math.PI);return v*180/Math.PI}e.radiansToDegrees=b;function w(g){var v=g%360;return v*Math.PI/180}e.degreesToRadians=w;function $(g,v,m){if(v===void 0&&(v="kilometers"),m===void 0&&(m="kilometers"),!(g>=0))throw new Error("length must be a positive number");return E(A(g,v),m)}e.convertLength=$;function L(g,v,m){if(v===void 0&&(v="meters"),m===void 0&&(m="kilometers"),!(g>=0))throw new Error("area must be a positive number");var P=e.areaFactors[v];if(!P)throw new Error("invalid original units");var B=e.areaFactors[m];if(!B)throw new Error("invalid final units");return g/P*B}e.convertArea=L;function C(g){return!isNaN(g)&&g!==null&&!Array.isArray(g)}e.isNumber=C;function D(g){return!!g&&g.constructor===Object}e.isObject=D;function d(g){if(!g)throw new Error("bbox is required");if(!Array.isArray(g))throw new Error("bbox must be an Array");if(g.length!==4&&g.length!==6)throw new Error("bbox must be an Array of 4 or 6 numbers");g.forEach(function(v){if(!C(v))throw new Error("bbox must only contain numbers")})}e.validateBBox=d;function I(g){if(!g)throw new Error("id is required");if(["string","number"].indexOf(typeof g)===-1)throw new Error("id must be a number or a string")}e.validateId=I})(Zi);const zT=mn,pt=V,HT=xt,Yl=WT,KT=Yi.default,JT=Jl.default,Zu=Zi,Pe={...zT.modes.draw_polygon};Pe.onSetup=function(e){const t=this.newFeature({type:pt.geojsonTypes.FEATURE,properties:{isCircle:!0,center:[]},geometry:{type:pt.geojsonTypes.POLYGON,coordinates:[[]]}});return this.addFeature(t),this.clearSelectedFeatures(),HT.disable(this),Yl.disable(this),this.updateUIClasses({mouse:pt.cursors.ADD}),this.activateUIButton(pt.types.POLYGON),this.setActionableState({trash:!0}),{polygon:t,currentVertexPosition:0}};Pe.onMouseDown=Pe.onTouchStart=function(e,t){e.polygon.properties.center.length===0&&(e.polygon.properties.center=[t.lngLat.lng,t.lngLat.lat])};Pe.onDrag=Pe.onMouseMove=function(e,t){const r=e.polygon.properties.center;if(r.length>0){const n=JT(Zu.point(r),Zu.point([t.lngLat.lng,t.lngLat.lat]),{units:"kilometers"}),o=KT(r,n);e.polygon.incomingCoords(o.geometry.coordinates),e.polygon.properties.radiusInKm=n}};Pe.onMouseUp=Pe.onTouchEnd=function(e,t){return Yl.enable(this),this.changeMode(pt.modes.SIMPLE_SELECT,{featureIds:[e.polygon.id]})};Pe.onClick=Pe.onTap=function(e,t){e.polygon.properties.center=[]};Pe.toDisplayFeatures=function(e,t,r){const n=t.properties.id===e.polygon.id;return t.properties.active=n?pt.activeStates.ACTIVE:pt.activeStates.INACTIVE,r(t)};var YT=Pe;const ZT=on;function XT(e){const{properties:t,geometry:r}=e;if(!t.user_isCircle)return null;const n=[],o=r.coordinates[0].slice(0,-1);for(let i=0;i<o.length;i+=Math.round(o.length/4))n.push(ZT(t.id,o[i],`0.${i}`,!1));return n}var Zl=XT;const QT=mn,eS=an,tS=gn,Zr=V,rS=Ki,nS=Jl.default,Xu=Zi,oS=Yi.default,iS=Zl,bn=QT.modes.direct_select;bn.dragFeature=function(e,t,r){tS(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};bn.dragVertex=function(e,t,r){if(e.feature.properties.isCircle){const n=e.feature.properties.center,o=[t.lngLat.lng,t.lngLat.lat],i=nS(Xu.point(n),Xu.point(o),{units:"kilometers"}),a=oS(n,i);e.feature.incomingCoords(a.geometry.coordinates),e.feature.properties.radiusInKm=i}else{const n=e.selectedCoordPaths.map(a=>e.feature.getCoordinate(a)),o=n.map(a=>({type:Zr.geojsonTypes.FEATURE,properties:{},geometry:{type:Zr.geojsonTypes.POINT,coordinates:a}})),i=rS(o,r);for(let a=0;a<n.length;a++){const c=n[a];e.feature.updateCoordinate(e.selectedCoordPaths[a],c[0]+i.lng,c[1]+i.lat)}}};bn.toDisplayFeatures=function(e,t,r){e.featureId===t.properties.id?(t.properties.active=Zr.activeStates.ACTIVE,r(t),(t.properties.user_isCircle?iS(t):eS(t,{map:this.map,midpoints:!0,selectedPaths:e.selectedCoordPaths})).forEach(r)):(t.properties.active=Zr.activeStates.INACTIVE,r(t)),this.fireActionable(e)};var aS=bn;const sS=mn,uS=an,cS=gn,Fr=V,lS=Zl,Xi=sS.modes.simple_select;Xi.dragMove=function(e,t){e.dragMoving=!0,t.originalEvent.stopPropagation();const r={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};cS(this.getSelected(),r),this.getSelected().filter(n=>n.properties.isCircle).map(n=>n.properties.center).forEach(n=>{n[0]+=r.lng,n[1]+=r.lat}),e.dragMoveLocation=t.lngLat};Xi.toDisplayFeatures=function(e,t,r){if(t.properties.active=this.isSelected(t.properties.id)?Fr.activeStates.ACTIVE:Fr.activeStates.INACTIVE,r(t),this.fireActionable(),t.properties.active!==Fr.activeStates.ACTIVE||t.geometry.type===Fr.geojsonTypes.POINT)return;(t.properties.user_isCircle?lS(t):uS(t)).forEach(r)};var fS=Xi;const pS=YT,Ze=aS,dS=fS,hS={onSetup:function(e){const t=this.newFeature({type:"Feature",properties:{isRectangle:!0},geometry:{type:"Polygon",coordinates:[[[0,0],[0,0],[0,0],[0,0],[0,0]]]}});return this.addFeature(t),this.clearSelectedFeatures(),this.updateUIClasses({mouse:"add"}),this.activateUIButton("polygon"),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.disable(),{polygon:t,startPoint:null}},onStop:function(e){this.updateUIClasses({mouse:"none"}),this.activateUIButton(),this.setActionableState({trash:!0}),this.map&&this.map.dragPan&&this.map.dragPan.enable()},onMouseDown:function(e,t){t.originalEvent&&(t.originalEvent.preventDefault(),t.originalEvent.stopPropagation()),e.startPoint=[t.lngLat.lng,t.lngLat.lat],this.updateFeature(e,t)},onDrag:function(e,t){e.startPoint&&this.updateFeature(e,t)},onMouseUp:function(e,t){e.startPoint&&(this.updateFeature(e,t),this.map.fire("draw.create",{features:[e.polygon.toGeoJSON()]}),this.changeMode("simple_select",{featureIds:[e.polygon.id]}))},updateFeature:function(e,t){const r=e.startPoint,n=[t.lngLat.lng,t.lngLat.lat],o=Math.min(r[0],n[0]),i=Math.max(r[0],n[0]),a=Math.min(r[1],n[1]),c=Math.max(r[1],n[1]),u=[[o,c],[i,c],[i,a],[o,a],[o,c]];e.polygon.incomingCoords([u])},toDisplayFeatures:function(e,t,r){const n=t.properties.id===e.polygon.id;if(t.properties.active=n?"true":"false",!n)return r(t);t.geometry.coordinates.length!==0&&r(t)},onTrash:function(e){this.deleteFeature(e.polygon.id,{silent:!0}),this.changeMode("simple_select")}},yS={...Ze,isRectangle:function(e){return e?!!(e.properties&&(e.properties.isRectangle===!0||e.properties.isRectangle==="true")||e.geometry&&e.geometry.type==="Polygon"&&e.geometry.coordinates.length>0&&e.geometry.coordinates[0].length===5):!1},onSetup:function(e){const t=Ze.onSetup.call(this,e);return t.draggingHandle=null,t},onMouseDown:function(e,t){const r=e.featureId,n=this.getFeature(r);this.isRectangle(n),Ze.onMouseDown.call(this,e,t)},onDrag:function(e,t){const{featureId:r}=e,n=this.getFeature(r);if(!this.isRectangle(n))return Ze.onDrag.call(this,e,t);if(e.selectedCoordPaths&&e.selectedCoordPaths.length>0){const i=e.selectedCoordPaths[0].split("."),a=parseInt(i[0],10),c=parseInt(i[1],10);if(a===0&&c>=0&&c<=4){const u=n.coordinates[0],y=t.lngLat.lng,h=t.lngLat.lat,l=((c===4?0:c)+2)%4,f=u[l];if(!f)return;const _=Math.min(y,f[0]),E=Math.max(y,f[0]),A=Math.min(h,f[1]),N=Math.max(h,f[1]),F=[[_,N],[E,N],[E,A],[_,A],[_,N]];n.incomingCoords([F]),e.draggingHandle=!0;return}}Ze.onDrag.call(this,e,t)},onMouseUp:function(e,t){e.draggingHandle&&(e.draggingHandle=null,this.map.dragPan.enable(),this.fireUpdate()),Ze.onMouseUp.call(this,e,t)},fireUpdate:function(){this.map.fire("draw.update",{action:"move",features:this.getSelected().map(e=>e.toGeoJSON())})},toDisplayFeatures:function(e,t,r){const n=this.getFeature(e.featureId);if(this.isRectangle(n)){const o=i=>{i.properties.meta!=="midpoint"&&r(i)};Ze.toDisplayFeatures.call(this,e,t,o);return}Ze.toDisplayFeatures.call(this,e,t,r)}};function gS({currentMode:e,onModeChange:t,onDelete:r,canDelete:n}){const o=[{id:"simple_select",icon:ap,title:"Select (Pointer)"},{id:"add_waypoint",icon:sp,title:"Add Waypoint"},{id:"draw_rectangle",icon:up,title:"Draw Square"},{id:"draw_polygon",icon:cp,title:"Draw Polygon"},{id:"drag_circle",icon:lp,title:"Draw Circle"}];return ne.jsxs("div",{className:"absolute top-4 left-4 flex flex-col gap-2 bg-white rounded-md shadow-md p-1 z-10",children:[o.map(i=>{const a=i.icon,c=e===i.id||i.id==="simple_select"&&e==="direct_select";return ne.jsx("button",{onClick:()=>{console.log("Switching to mode:",i.id),t(i.id)},className:`p-2 rounded hover:bg-gray-100 flex items-center justify-center ${c?"text-blue-600 bg-blue-50":"text-gray-700"}`,title:i.title,children:ne.jsx(a,{size:20})},i.id)}),ne.jsx("div",{className:"h-px bg-gray-200 my-1"}),ne.jsx("button",{onClick:r,disabled:!n,className:`p-2 rounded flex items-center justify-center ${n?"text-red-600 hover:bg-red-50 cursor-pointer":"text-gray-300 cursor-not-allowed"}`,title:"Delete Selected",children:ne.jsx(fp,{size:20})})]})}Pr.accessToken="pk.eyJ1Ijoid2F5Z2VuIiwiYSI6ImNtaThyMXF2czBmZ3QybXBvbW1hazFpamcifQ.P0D5plS_fpnx3qheQytxfQ";const vS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#3b82f6" stroke="white" stroke-width="2"/>
</svg>
`),mS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="40" height="40" viewBox="0 0 40 40" xmlns="http://www.w3.org/2000/svg">
  <path d="M20 0 L35 20 A 15 15 0 0 1 5 20 Z" fill="#ef4444" stroke="white" stroke-width="2"/>
</svg>
`),bS="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(`
<svg width="24" height="24" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
  <path d="M12 2 L22 22 L12 17 L2 22 Z" fill="#ffffff" stroke="#3b82f6" stroke-width="2" stroke-linejoin="round"/>
</svg>
`),TS=[{id:"gl-draw-line",type:"line",filter:["all",["==","$type","LineString"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-polygon-fill",type:"fill",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],paint:{"fill-color":"#3b82f6","fill-outline-color":"#3b82f6","fill-opacity":.2}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","$type","Polygon"],["!=","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#3b82f6","line-width":2}},{id:"gl-draw-point-point-stroke-active",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":6,"circle-color":"#fff"}},{id:"gl-draw-point",type:"circle",filter:["all",["==","$type","Point"],["!=","mode","static"]],paint:{"circle-radius":4,"circle-color":"#3b82f6"}},{id:"gl-draw-polygon-fill-static",type:"fill",filter:["all",["==","$type","Polygon"],["==","mode","static"]],paint:{"fill-color":"#000","fill-outline-color":"#000","fill-opacity":.1}},{id:"gl-draw-polygon-stroke-static",type:"line",filter:["all",["==","$type","Polygon"],["==","mode","static"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#000","line-width":2}},{id:"gl-draw-polygon-midpoint",type:"circle",filter:["all",["==","$type","Point"],["==","meta","resize-handle"]],paint:{"circle-radius":4,"circle-color":"#fbb03b"}}];function $S({onPolygonDrawn:e,polygon:t}){const r=re.useRef(null),n=re.useRef(null),o=re.useRef(null),{waypoints:i,selectedIds:a,selectWaypoint:c,setSelectedIds:u,resetTrigger:y,settings:h,updateWaypoint:T,addWaypoint:l,setMapRef:f}=we(),_=re.useRef(null),[E,A]=re.useState("simple_select"),[N,F]=re.useState("satellite"),b=re.useRef(E);re.useEffect(()=>{b.current=E},[E]),re.useEffect(()=>{y>0&&o.current&&(o.current.deleteAll(),e(null))},[y,e]);const[w,$]=re.useState(null),[L,C]=re.useState(!1),D=re.useRef(null);re.useEffect(()=>{if(!o.current||!n.current)return;const g=o.current.getSelectedIds();if(g.length===0)return;const v=o.current.get(g[0]);if(!v||v.geometry.type!=="Polygon")return;const m=Cn(v),P=On(m,lt(v.geometry.coordinates[0][0]),{units:"meters"});if(Math.abs(P-h.orbitRadius)>1){const B=ma(m.geometry.coordinates,h.orbitRadius,{steps:64,units:"meters"});B.id=v.id,B.properties={...v.properties,isCircle:!0},o.current.add(B),e(B)}},[h.orbitRadius]);const d=g=>{if(!g||g.geometry.type!=="Polygon")return;const v=Cn(g),m=On(v,lt(g.geometry.coordinates[0][0]),{units:"meters"});Math.abs(m-h.orbitRadius)>1&&we.getState().updateSettings({orbitRadius:Math.round(m)})};re.useEffect(()=>{if(n.current)return;n.current=new Pr.Map({container:r.current,style:"mapbox://styles/mapbox/satellite-streets-v12",center:[-98,39],zoom:4,boxZoom:!1});const g=new gp({accessToken:Pr.accessToken,mapboxgl:Pr,marker:!1,collapsed:!0});n.current.addControl(g,"top-right"),f(n.current),o.current=new va({userProperties:!0,displayControlsDefault:!1,controls:{point:!1,line:!1,polygon:!1,trash:!1,combine_features:!1,uncombine_features:!1},styles:TS,modes:{...va.modes,drag_circle:pS,draw_rectangle:hS,direct_select:yS,simple_select:dS}}),n.current.addControl(o.current),window.mapboxDraw=o.current,n.current.on("draw.create",x=>{const M=x.features[0];o.current.getMode()==="drag_circle"&&(o.current.setFeatureProperty(M.id,"isCircle",!0),M.properties.isCircle=!0,we.getState().updateSettings({pathType:"orbit",spacing:10})),(M.properties.isRectangle||o.current.getMode()==="draw_rectangle")&&(o.current.setFeatureProperty(M.id,"isRectangle",!0),M.properties.isRectangle=!0);const G=Cn(M);if(On(G,lt(M.geometry.coordinates[0][0]),{units:"meters"})>500){const K=ma(G.geometry.coordinates,50,{steps:64,units:"meters"});K.id=M.id,K.properties={...M.properties,isCircle:!0},o.current.add(K),we.getState().updateSettings({orbitRadius:50}),e(K)}else d(M),e(M);A("simple_select")}),n.current.on("draw.update",x=>{const M=x.features[0];d(M),e(M)}),n.current.on("draw.selectionchange",x=>{x.features.length>0?(d(x.features[0]),e(x.features[0]),C(!0)):C(!1)}),n.current.on("draw.delete",()=>e(null)),n.current.on("click",x=>{if(x.originalEvent._isDrag)return;if(b.current==="add_waypoint"){const{lng:G,lat:R}=x.lngLat;l({lng:G,lat:R});return}const M=n.current.queryRenderedFeatures(x.point,{layers:["waypoints-symbol"]});if(M.length){const G=M[0].properties.id;c(G,x.originalEvent.shiftKey)}else n.current.queryRenderedFeatures(x.point,{layers:["gl-draw-polygon-fill-static.cold","gl-draw-polygon-fill.hot"]}).length===0&&u([])});const v=x=>{if(!D.current)return;const M=D.current,G=x.point,R=Math.min(M.x,G.x),K=Math.max(M.x,G.x),k=Math.min(M.y,G.y),q=Math.max(M.y,G.y);$({left:R,top:k,width:K-R,height:q-k})},m=x=>{if(!D.current)return;const M=D.current,G=x.point;if(Math.abs(M.x-G.x)<5&&Math.abs(M.y-G.y)<5){D.current=null,$(null),n.current.dragPan.enable(),n.current.off("mousemove",v),n.current.off("mouseup",m);return}const R=[M,G],k=n.current.queryRenderedFeatures(R,{layers:["waypoints-symbol"]}).map(q=>q.properties.id);k.length>0&&u(k),D.current=null,$(null),n.current.dragPan.enable(),x.originalEvent._isDrag=!0,setTimeout(()=>{x.originalEvent&&delete x.originalEvent._isDrag},100),n.current.off("mousemove",v),n.current.off("mouseup",m)};n.current.on("mousedown",x=>{x.originalEvent.shiftKey&&(x.preventDefault(),n.current.dragPan.disable(),D.current=x.point,n.current.on("mousemove",v),n.current.on("mouseup",m))});const P=()=>{_.current||(n.current.getCanvas().style.cursor="pointer")},B=()=>{_.current||(n.current.getCanvas().style.cursor="")},H=x=>{if(o.current.getMode()!=="simple_select"&&o.current.getMode()!=="direct_select"||x.originalEvent.shiftKey||!x.originalEvent.altKey)return;x.preventDefault();const M=x.features[0];if(!M)return;n.current.dragPan.disable(),n.current.getCanvas().style.cursor="grabbing";const G=M.properties.id,R=we.getState().waypoints,K=we.getState().selectedIds,k=K.includes(G),q=k?K:[G],ye=R.filter(ue=>q.includes(ue.id)).map(ue=>({id:ue.id,lng:ue.lng,lat:ue.lat}));_.current={ids:q,isMulti:k,initialWaypoints:ye,startLngLat:x.lngLat},n.current.on("mousemove",pe),n.current.on("mouseup",Se)},pe=x=>{if(!_.current)return;const{lng:M,lat:G}=x.lngLat,{startLngLat:R,initialWaypoints:K}=_.current,k=M-R.lng,q=G-R.lat,ye=n.current.getSource("waypoints"),ue=n.current.getSource("mission-path"),be=we.getState().waypoints,ot=we.getState().selectedIds,Gt=be.map(($e,Vt)=>{const Wt=K.find(Tn=>Tn.id===$e.id);let cr=[$e.lng,$e.lat];return Wt&&(cr=[Wt.lng+k,Wt.lat+q]),{type:"Feature",properties:{id:$e.id,index:Vt+1,selected:ot.includes($e.id),heading:$e.heading||0},geometry:{type:"Point",coordinates:cr}}});if(ye&&ye.setData({type:"FeatureCollection",features:Gt}),ue){const $e=Gt.map(Vt=>Vt.geometry.coordinates);ue.setData({type:"Feature",geometry:{type:"LineString",coordinates:$e}})}},Se=x=>{if(!_.current)return;const{lng:M,lat:G}=x.lngLat,{startLngLat:R,ids:K}=_.current,k=M-R.lng,q=G-R.lat;we.getState().moveWaypoints(K,k,q),_.current=null,n.current.dragPan.enable(),n.current.getCanvas().style.cursor="",x.originalEvent._isDrag=!0,n.current.off("mousemove",pe),n.current.off("mouseup",Se)};n.current.on("mouseenter","waypoints-symbol",P),n.current.on("mouseleave","waypoints-symbol",B),n.current.on("mousedown","waypoints-symbol",H);const Ue=()=>{console.log("Initializing Map Layers...");const x=(R,K)=>{if(n.current.hasImage(R))return;const k=new Image;k.src=K,k.onload=()=>{n.current.hasImage(R)||n.current.addImage(R,k)}};x("teardrop",vS),x("teardrop-selected",mS),x("arrow",bS),n.current.getSource("mission-path")||n.current.addSource("mission-path",{type:"geojson",data:{type:"Feature",geometry:{type:"LineString",coordinates:[]}}}),n.current.getSource("path-arrows")||n.current.addSource("path-arrows",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("footprints")||n.current.addSource("footprints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getSource("waypoints")||n.current.addSource("waypoints",{type:"geojson",data:{type:"FeatureCollection",features:[]}}),n.current.getLayer("footprints-fill")||n.current.addLayer({id:"footprints-fill",type:"fill",source:"footprints",paint:{"fill-color":["get","color"],"fill-opacity":.15,"fill-outline-color":"rgba(0,0,0,0)"}}),n.current.getLayer("footprints-outline")||n.current.addLayer({id:"footprints-outline",type:"line",source:"footprints",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":["get","color"],"line-width":1,"line-opacity":.6}}),n.current.getLayer("mission-path-line")||n.current.addLayer({id:"mission-path-line",type:"line",source:"mission-path",layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":"#3b82f6","line-width":3,"line-opacity":.8}}),n.current.getLayer("path-arrows-symbol")||n.current.addLayer({id:"path-arrows-symbol",type:"symbol",source:"path-arrows",layout:{"icon-image":"arrow","icon-size":.6,"icon-allow-overlap":!0,"icon-rotate":["get","rotation"],"icon-rotation-alignment":"map","icon-ignore-placement":!0}}),n.current.getLayer("waypoints-symbol")||n.current.addLayer({id:"waypoints-symbol",type:"symbol",source:"waypoints",layout:{"icon-image":["case",["get","selected"],"teardrop-selected","teardrop"],"icon-size":["interpolate",["linear"],["zoom"],10,.5,15,.75,20,1],"icon-anchor":"center","icon-allow-overlap":!0,"icon-rotate":["get","heading"],"icon-rotation-alignment":"map","text-field":["to-string",["get","index"]],"text-font":["Open Sans Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,9,15,11,20,13],"text-offset":[0,0],"text-anchor":"center","text-allow-overlap":!0,"text-rotation-alignment":"viewport"},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":.5}});const M=we.getState().waypoints,G=we.getState().selectedIds;if(M.length>0){console.log("Initial waypoints found, updating source...",M.length);const R=M.map((k,q)=>({type:"Feature",properties:{id:k.id,index:q+1,selected:G.includes(k.id),heading:k.heading||0},geometry:{type:"Point",coordinates:[k.lng,k.lat]}}));n.current.getSource("waypoints").setData({type:"FeatureCollection",features:R});const K=M.map(k=>[k.lng,k.lat]);if(n.current.getSource("mission-path").setData({type:"Feature",geometry:{type:"LineString",coordinates:K}}),M.length>=2){const k=[];for(let q=0;q<M.length-1;q++){const ye=lt([M[q].lng,M[q].lat]),ue=lt([M[q+1].lng,M[q+1].lat]),be=ba(ye,ue),ot=Ta(ye,ue);k.push({type:"Feature",geometry:be.geometry,properties:{rotation:ot}})}n.current.getSource("path-arrows").setData({type:"FeatureCollection",features:k})}}};n.current.loaded()?Ue():n.current.on("load",Ue),n.current.on("style.load",Ue);const qt=x=>{b.current==="add_waypoint"&&x.mode==="simple_select"||A(x.mode)};n.current.on("draw.modechange",qt);const ae=x=>{x.key==="Escape"&&(b.current!=="simple_select"?(o.current&&o.current.changeMode("simple_select"),A("simple_select")):u([]))};return window.addEventListener("keydown",ae),()=>{window.removeEventListener("keydown",ae)}},[]),re.useEffect(()=>{if(!o.current||!n.current)return;const g=E,v=o.current.getMode();if(g==="add_waypoint")v!=="simple_select"&&o.current.changeMode("simple_select"),n.current.getCanvas().style.cursor="crosshair";else{if(v!==g)try{o.current.changeMode(g)}catch(m){console.warn("Failed to switch mode:",m)}n.current.getCanvas().style.cursor=""}},[E]),re.useEffect(()=>{!n.current||!n.current.getLayer("waypoints-symbol")||(n.current.setLayoutProperty("waypoints-symbol","text-offset",[0,0]),n.current.setLayoutProperty("waypoints-symbol","text-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","icon-anchor","center"),n.current.setLayoutProperty("waypoints-symbol","text-rotation-alignment","viewport"))},[]),re.useEffect(()=>{if(!n.current||!n.current)return;const g=n.current.getSource("waypoints"),v=n.current.getSource("mission-path"),m=n.current.getSource("path-arrows");if(g){const P=i.map((B,H)=>({type:"Feature",properties:{id:B.id,index:H+1,selected:a.includes(B.id),heading:B.heading||0},geometry:{type:"Point",coordinates:[B.lng,B.lat]}}));g.setData({type:"FeatureCollection",features:P})}if(v){const P=i.map(B=>[B.lng,B.lat]);v.setData({type:"Feature",geometry:{type:"LineString",coordinates:P}})}if(m&&i.length>=2){const P=[];for(let B=0;B<i.length-1;B++){const H=lt([i[B].lng,i[B].lat]),pe=lt([i[B+1].lng,i[B+1].lat]),Se=ba(H,pe),Ue=Ta(H,pe);P.push({type:"Feature",geometry:Se.geometry,properties:{rotation:Ue}})}m.setData({type:"FeatureCollection",features:P})}else m&&m.setData({type:"FeatureCollection",features:[]})},[i,a]),re.useEffect(()=>{if(!n.current||!n.current.getSource("footprints"))return;if(!h.showFootprints){n.current.getSource("footprints").setData({type:"FeatureCollection",features:[]});return}const g=i.map((v,m)=>{const P=v.heading||0;return{...ip({lng:v.lng,lat:v.lat},h.altitude,P,h.customFOV),properties:{index:m+1,color:h.footprintColor}}}).filter(v=>v!==null);n.current.getSource("footprints").setData({type:"FeatureCollection",features:g})},[i,h.showFootprints,h.altitude,h.customFOV,h.footprintColor]),re.useEffect(()=>{h.orbitRadius>500&&we.getState().updateSettings({orbitRadius:50})},[]);const I=()=>{o.current&&(o.current.trash(),e(null),C(!1))};return re.useEffect(()=>{if(!o.current||!n.current)return;if(!t){o.current.getAll().features.length>0&&o.current.deleteAll();return}if(!o.current.getAll().features.some(m=>m.id===t.id)){console.log("Syncing polygon from prop:",t),o.current.deleteAll(),o.current.add(t);try{const m=wp(t);n.current.fitBounds(m,{padding:100})}catch(m){console.warn("Could not fit bounds:",m)}}},[t]),ne.jsxs("div",{className:`relative w-full h-full ${E==="add_waypoint"?"force-crosshair":""}`,children:[ne.jsx("style",{children:`
        .force-crosshair .mapboxgl-canvas-container {
          cursor: crosshair !important;
        }
        .force-crosshair .mapboxgl-canvas {
          cursor: crosshair !important;
        }
      `}),ne.jsx("div",{ref:r,className:"w-full h-full"}),w&&ne.jsx("div",{style:{position:"absolute",left:w.left,top:w.top,width:w.width,height:w.height,border:"2px solid #3b82f6",backgroundColor:"rgba(59, 130, 246, 0.2)",pointerEvents:"none",zIndex:20}}),ne.jsx(gS,{currentMode:E,onModeChange:A,onDelete:I,canDelete:L}),ne.jsxs("div",{className:"absolute bottom-8 left-4 flex flex-col gap-2 z-10",children:[ne.jsxs("div",{className:"bg-white rounded-lg shadow-md border border-gray-200 overflow-hidden flex flex-col",children:[ne.jsx("button",{onClick:()=>{N!=="satellite"&&(F("satellite"),n.current.setStyle("mapbox://styles/mapbox/satellite-streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${N==="satellite"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Satellite View",children:ne.jsx(pp,{size:20})}),ne.jsx("div",{className:"h-px bg-gray-200"}),ne.jsx("button",{onClick:()=>{N!=="streets"&&(F("streets"),n.current.setStyle("mapbox://styles/mapbox/streets-v12"))},className:`p-2 hover:bg-gray-50 transition-colors ${N==="streets"?"bg-blue-50 text-blue-600":"text-gray-700"}`,title:"Street Map",children:ne.jsx(dp,{size:20})})]}),ne.jsx("button",{onClick:()=>{"geolocation"in navigator?navigator.geolocation.getCurrentPosition(g=>{n.current.flyTo({center:[g.coords.longitude,g.coords.latitude],zoom:16})},g=>{console.error("Error getting location:",g),alert("Could not get your location. Please check permissions.")}):alert("Geolocation is not supported by your browser.")},className:"bg-white p-2 rounded-lg shadow-md border border-gray-200 text-gray-700 hover:bg-gray-50 hover:text-blue-600 transition-colors",title:"My Location",children:ne.jsx(hp,{size:20})})]})]})}export{$S as default};
